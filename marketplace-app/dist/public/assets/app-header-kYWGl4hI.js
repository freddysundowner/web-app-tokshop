import{c as C,a as fe,u as J,r as c,j as e,e as Ne,d as me,b as we,f as ye,B as g,L as y,I as xe}from"./index-FVTY5sKH.js";import{A as E,a as U,b as V}from"./avatar-BgbrThQo.js";import{B as ke}from"./badge-BTf7a5Ku.js";import{S as Ce,a as Se}from"./sheet-0oGlQBkt.js";import{S as _}from"./separator-QabP-acS.js";import{T as Ie,a as $e,b as he,c as ue}from"./tabs-BcVWc8Zy.js";import{u as X}from"./useQuery-DsZx8GVA.js";import{S as De}from"./shopping-bag-CmfLtQot.js";import{M as Me}from"./map-pin-jcALPDnh.js";import{C as k}from"./chevron-right-HRo85rGP.js";import{R as Ae}from"./radio-De9zfx-r.js";import{R as ze}from"./receipt-fVESyPTJ.js";import{P as Le}from"./package-dXPzRBiL.js";import{T as Pe}from"./truck-DDM-Vnwo.js";import{D as _e}from"./dollar-sign-C7k0Pfpl.js";import{M as Te}from"./message-circle-KFHS6dr0.js";import{C as Fe}from"./circle-help-D0D-hL2T.js";import{D as qe,a as He,b as Oe,c as pe}from"./dropdown-menu-BrJ5tGq0.js";import{S as j}from"./search-zDcbIzzp.js";import{P as Re}from"./plus-CFqimBvi.js";import{C as Be}from"./calendar-BlsFPoYB.js";import{M as Ee}from"./message-square-lk32N-n-.js";import"./index-CoWBA0E_.js";import"./index-BaZiuLT8.js";import"./check-DWjWNqF1.js";import"./circle-tm_CQXKA.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=C("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=C("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=C("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=C("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=C("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=C("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=C("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);function Xe({open:v,onOpenChange:T}){var S,N;const{user:h,logout:Q}=fe(),[,F]=J(),[q,D]=c.useState(!0),b=(h==null?void 0:h._id)||(h==null?void 0:h.id),{data:l}=X({queryKey:[`/api/profile/${b}`],enabled:!!b&&v,staleTime:0}),a=l||h,[K,u]=c.useState(a!=null&&a.seller?"selling":"buying");if(c.useEffect(()=>{v&&D(!0)},[v]),!h)return null;const G=()=>a.firstName&&a.lastName?`${a.firstName[0]}${a.lastName[0]}`.toUpperCase():a.firstName?a.firstName[0].toUpperCase():a.email?a.email[0].toUpperCase():"U",H=()=>{var s;return a.userName?a.userName:a.firstName||a.lastName?`${a.firstName||""}${a.lastName||""}`.trim():((s=a.email)==null?void 0:s.split("@")[0])||"User"},n=[{icon:Ae,label:"Shows",href:"/live-shows",testId:"action-shows"},{icon:ze,label:"Orders",href:"/orders",testId:"action-orders"},{icon:Le,label:"Inventory",href:"/inventory",testId:"action-inventory"},{icon:Pe,label:"Shipments",href:"/shipping",testId:"action-shipments"},{icon:_e,label:"Finances",href:"/payments",testId:"action-finances"}],M=[{icon:De,label:"Purchases",href:"/purchases",testId:"action-purchases"},{icon:Me,label:"Addresses",href:"/addresses",testId:"action-addresses"}],p=[{icon:We,label:"Seller Hub",href:"/seller/hub",testId:"menu-seller-hub",sellerOnly:!0},{icon:Te,label:"Friends",href:"/friends",testId:"menu-friends"},{icon:Fe,label:"Help & Legal",href:"/help",testId:"menu-help"},{icon:Qe,label:"Logout",testId:"menu-logout",onClick:async()=>{await Q(),T(!1)},isDestructive:!0}],d=s=>{Ne.flushSync(()=>{D(!1),T(!1)}),F(s)},O=s=>e.jsxs("button",{onClick:()=>d(s.href),className:"flex flex-col items-center justify-center p-4 rounded-lg hover-elevate active-elevate-2 transition-all","data-testid":s.testId,children:[e.jsx(s.icon,{className:"h-6 w-6 text-foreground mb-2"}),e.jsx("span",{className:"text-xs text-center text-foreground font-medium",children:s.label})]},s.testId),A=s=>s.sellerOnly&&!a.seller?null:s.onClick?e.jsxs("button",{onClick:s.onClick,className:me("flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all",s.isDestructive&&"text-destructive"),"data-testid":s.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{className:me("h-5 w-5",s.isDestructive?"text-destructive":"text-foreground")}),e.jsx("span",{className:"text-base",children:s.label})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]},s.testId):e.jsxs("button",{onClick:()=>d(s.href||"#"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":s.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:s.label})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]},s.testId);return q?e.jsx(Ce,{open:v,onOpenChange:T,children:e.jsxs(Se,{side:"right",className:"w-full sm:max-w-md p-0 overflow-y-auto flex flex-col",onOpenAutoFocus:s=>s.preventDefault(),children:[e.jsx("div",{className:"p-4",children:e.jsxs("button",{onClick:()=>d("/profile-view"),className:"flex items-center gap-3 w-full hover-elevate active-elevate-2 p-2 rounded-lg transition-all","data-testid":"button-profile-view",children:[e.jsxs(E,{className:"h-14 w-14","data-testid":"drawer-avatar",children:[e.jsx(U,{src:a.profilePhoto,alt:a.userName||a.email}),e.jsx(V,{className:"bg-teal-500 text-white text-lg font-bold",children:G()})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"font-bold text-foreground text-base truncate","data-testid":"text-username",children:H()}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-0.5",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:((a==null?void 0:a.followingCount)||((S=a==null?void 0:a.following)==null?void 0:S.length)||0).toLocaleString()})," following"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:((a==null?void 0:a.followersCount)||((N=a==null?void 0:a.followers)==null?void 0:N.length)||0).toLocaleString()})," followers"]})]})]})]})}),e.jsx(_,{}),e.jsx("div",{className:"md:hidden flex-1",children:e.jsxs("div",{className:"space-y-1 p-2",children:[e.jsxs("button",{onClick:()=>d("/marketplace"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-home-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Home"})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>d("/browse"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-browse-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Browse"})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>d("/deals"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-deals-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Je,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Deals"})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(_,{className:"my-2"}),a.seller&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-muted-foreground uppercase",children:"Selling"}),n.map(s=>e.jsxs("button",{onClick:()=>d(s.href),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":s.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:s.label})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]},s.testId))]}),e.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-muted-foreground uppercase",children:"Buying"}),M.map(s=>e.jsxs("button",{onClick:()=>d(s.href),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":s.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:s.label})]}),e.jsx(k,{className:"h-5 w-5 text-muted-foreground"})]},s.testId)),e.jsx(_,{className:"my-2"}),e.jsx("div",{className:"space-y-1",children:p.map(s=>A(s))})]})}),e.jsxs(Ie,{value:K,onValueChange:u,className:"hidden md:flex flex-1 flex-col",children:[e.jsxs($e,{className:"w-full justify-start rounded-none border-b bg-transparent p-0 h-auto",children:[a.seller&&e.jsx(he,{value:"selling",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-foreground data-[state=active]:bg-transparent px-6 py-3 font-semibold","data-testid":"tab-selling",children:"Selling"}),e.jsx(he,{value:"buying",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-foreground data-[state=active]:bg-transparent px-6 py-3 font-semibold","data-testid":"tab-buying",children:"Buying"})]}),a.seller&&e.jsxs(ue,{value:"selling",className:"flex-1 mt-0 p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:n.map(s=>O(s))}),e.jsx(_,{className:"my-4"}),e.jsx("div",{className:"space-y-1",children:p.map(s=>A(s))})]}),e.jsxs(ue,{value:"buying",className:"flex-1 mt-0 p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:M.map(s=>O(s))}),e.jsx(_,{className:"my-4"}),e.jsx("div",{className:"space-y-1",children:p.map(s=>A(s))})]})]})]})}):null}function kt({onMobileMenuToggle:v,mobileMenuOpen:T=!1,onMobileMenuClose:h,hideLogo:Q=!1,hideNavigation:F=!1,hideSearch:q=!1,isDashboard:D=!1}){var te,se,ae,le,re,ne;const{settings:b}=we(),{user:l,isAuthenticated:a,refreshUserData:K}=fe(),[,u]=J(),[G,H]=c.useState(!1),[n,M]=c.useState(""),[W,p]=c.useState(!1),[d,O]=c.useState(""),[A,S]=c.useState(!1),N=c.useRef(null),{toast:s}=ye(),[w]=J(),Y=(l==null?void 0:l._id)||(l==null?void 0:l.id),{data:ge}=X({queryKey:[`/api/profile/${Y}`],enabled:!!Y&&!!a,staleTime:0}),o=ge||l,ve=()=>{v==null||v()},je=t=>{H(t)},be=()=>l!=null&&l.firstName&&(l!=null&&l.lastName)?`${l.firstName[0]}${l.lastName[0]}`.toUpperCase():l!=null&&l.firstName?l.firstName[0].toUpperCase():l!=null&&l.email?l.email[0].toUpperCase():"U",i=w.startsWith("/show/");c.useEffect(()=>{const t=setTimeout(()=>{O(n)},300);return()=>clearTimeout(t)},[n]);const{data:f}=X({queryKey:["/api/products/search",d],queryFn:async()=>{var m,R,B,P,x,oe,ie,de,ce;if(!d.trim())return{results:{products:{data:[]},rooms:{data:[]},users:{data:[]}}};const t=await fetch(`/api/products/search?q=${encodeURIComponent(d)}`);if(!t.ok)throw new Error("Search failed");const r=await t.json();return console.log("ðŸ” Autocomplete API response:",r),console.log("ðŸ” Products count:",((B=(R=(m=r==null?void 0:r.results)==null?void 0:m.products)==null?void 0:R.data)==null?void 0:B.length)||0),console.log("ðŸ” Shows/Rooms count:",((oe=(x=(P=r==null?void 0:r.results)==null?void 0:P.rooms)==null?void 0:x.data)==null?void 0:oe.length)||0),console.log("ðŸ” Users count:",((ce=(de=(ie=r==null?void 0:r.results)==null?void 0:ie.users)==null?void 0:de.data)==null?void 0:ce.length)||0),r},enabled:d.length>0}),z=((se=(te=f==null?void 0:f.results)==null?void 0:te.products)==null?void 0:se.data)||[],L=((le=(ae=f==null?void 0:f.results)==null?void 0:ae.shows)==null?void 0:le.data)||[],I=((ne=(re=f==null?void 0:f.results)==null?void 0:re.users)==null?void 0:ne.data)||[];c.useEffect(()=>{const t=r=>{N.current&&!N.current.contains(r.target)&&p(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const Z=t=>{M(t),p(t.length>0)},$=t=>{console.log("ðŸ” Autocomplete click:",t),M(""),p(!1),u(t)},ee=t=>t.firstName&&t.lastName?`${t.firstName} ${t.lastName}`:t.firstName?t.firstName:t.lastName?t.lastName:t.username?t.username:t.name?t.name:t.displayName?t.displayName:t.email?t.email.split("@")[0]:"User";return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:`sticky top-0 z-50 border-b ${i?"bg-black border-zinc-800":"bg-background border-border"}`,children:[e.jsx("div",{className:`flex w-full ${D?"":"justify-center"}`,children:e.jsxs("div",{className:`flex items-center justify-between h-14 px-3 sm:px-6 w-full ${D?"":"lg:w-[90%]"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx(g,{size:"icon",variant:"ghost",className:`lg:hidden h-9 w-9 rounded-full ${i?"text-white hover:text-white":""}`,onClick:ve,"data-testid":"button-mobile-menu",children:e.jsx(Ke,{className:"h-5 w-5"})}),!Q&&e.jsx(y,{href:"/","data-testid":"link-home",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 sm:h-7 sm:w-7 bg-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-xs sm:text-sm",children:b.app_name.charAt(0).toUpperCase()})}),e.jsx("span",{className:`text-base sm:text-lg font-bold hidden sm:inline ${i?"text-white":"text-foreground"}`,children:b.app_name})]})}),!F&&a&&e.jsxs("div",{className:"hidden md:flex items-center gap-2 ml-4",children:[e.jsx(y,{href:"/",children:e.jsx(g,{className:w==="/"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${i?"text-white hover:text-white":""}`,variant:w==="/"?void 0:"ghost","data-testid":"button-home",children:"Home"})}),e.jsx(y,{href:"/browse",children:e.jsx(g,{className:w==="/browse"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${i?"text-white hover:text-white":""}`,variant:w==="/browse"?void 0:"ghost","data-testid":"button-browse",children:"Browse"})}),e.jsx(y,{href:"/deals",children:e.jsx(g,{className:w==="/deals"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${i?"text-white hover:text-white":""}`,variant:w==="/deals"?void 0:"ghost","data-testid":"button-deals",children:"Deals"})})]}),!F&&!q&&a&&e.jsxs("div",{ref:N,className:"relative hidden sm:block w-48 md:w-64 lg:w-96 ml-2",children:[e.jsx(j,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 ${i?"text-zinc-400":"text-muted-foreground"} pointer-events-none z-10`}),e.jsx(xe,{type:"text",value:n,onChange:t=>Z(t.target.value),onFocus:()=>n.length>0&&p(!0),placeholder:`Search ${b.app_name}`,className:`pl-10 text-sm h-9 rounded-md ${i?"bg-zinc-900 border-zinc-700 text-white placeholder:text-zinc-500":"bg-muted/50 border-border"}`,"data-testid":"input-search"}),W&&(z.length>0||L.length>0||I.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto z-50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:n})]})}),I.length>0&&e.jsx("div",{children:I.slice(0,3).map(t=>{const r=ee(t),m=t.followers_count||t.followersCount||0,R=t.is_live||t.isLive||!1,B=t.live_viewers||t.liveViewers||0,P=x=>x>=1e6?(x/1e6).toFixed(1).replace(/\.0$/,"")+"M":x>=1e3?(x/1e3).toFixed(1).replace(/\.0$/,"")+"K":x.toString();return e.jsxs("div",{onMouseDown:x=>{x.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=users`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":`autocomplete-user-${t._id}`,children:[e.jsxs(E,{className:"h-10 w-10",children:[e.jsx(U,{src:t.profilePhoto}),e.jsx(V,{className:"bg-primary text-primary-foreground text-xs",children:r[0].toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:r}),R&&e.jsxs(ke,{variant:"destructive",className:"h-5 px-1.5 text-xs font-medium",children:["Live â€¢ ",P(B)]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[P(m)," followers"]})]})]},t._id)})}),L.length>0&&e.jsx("div",{children:e.jsxs("div",{onMouseDown:t=>{t.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=shows`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":"autocomplete-shows",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Shows"})]})]})}),z.length>0&&e.jsx("div",{children:e.jsxs("div",{onMouseDown:t=>{t.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=products`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":"autocomplete-products",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Products"})]})]})})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:a?e.jsxs(e.Fragment,{children:[(o==null?void 0:o.seller)&&e.jsxs(qe,{open:A,onOpenChange:S,children:[e.jsx(He,{asChild:!0,children:e.jsx(g,{size:"icon",variant:"default",className:`h-9 w-9 rounded-full ${i?"bg-white text-black hover:bg-white/90":""}`,"data-testid":"button-seller-actions",children:e.jsx(Re,{className:"h-5 w-5"})})}),e.jsxs(Oe,{align:"end",className:"w-48",children:[e.jsx(pe,{asChild:!0,onSelect:t=>{t.preventDefault(),S(!1),u("/add-product")},children:e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer","data-testid":"menu-add-listing",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Listing"})]})}),e.jsx(pe,{asChild:!0,onSelect:t=>{t.preventDefault(),S(!1),u("/schedule-show")},children:e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer","data-testid":"menu-schedule-show",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Schedule a Show"})]})})]})]}),!(o!=null&&o.seller)&&e.jsx(g,{variant:"outline",size:"sm",className:`hidden md:flex w-full rounded-full text-sm h-9 px-4 font-medium ${i?"border-white text-white bg-transparent hover:bg-white/10 hover:text-white":"border-border"}`,"data-testid":"button-seller-setup",onClick:async()=>{const t=(l==null?void 0:l._id)||(l==null?void 0:l.id);if(t)try{const r=await fetch(`/api/profile/${t}`,{credentials:"include"});if(r.ok){const m=await r.json();if(console.log("Fetched user data for seller check:",{seller:m.seller,applied_seller:m.applied_seller}),m.seller){console.log("User is a seller - updating local data and navigating to /seller/hub"),await K(),u("/seller/hub");return}console.log("User is not a seller - navigating to /seller/setup"),u("/seller/setup")}else console.error(`Failed to fetch user data: ${r.status} ${r.statusText}`),s({title:"Could not verify status",description:"Proceeding to seller setup page",variant:"default"}),u("/seller/setup")}catch(r){console.error("Error fetching user data:",r),s({title:"Connection error",description:"Could not verify seller status. Please try again.",variant:"destructive"}),u("/seller/setup")}},children:o!=null&&o.applied_seller?"Complete Seller Setup":"Become a Seller"}),e.jsx(y,{href:"/inbox",children:e.jsx(g,{size:"icon",variant:"ghost",className:`h-9 w-9 rounded-full hidden md:flex ${i?"text-white hover:text-white":""}`,"data-testid":"button-messages",children:e.jsx(Ee,{className:"h-5 w-5"})})}),l&&e.jsxs(E,{className:"h-9 w-9 cursor-pointer","data-testid":"avatar-user-profile",onClick:()=>H(!0),children:[e.jsx(U,{src:o==null?void 0:o.profilePhoto,alt:`${(o==null?void 0:o.firstName)||(o==null?void 0:o.email)}`}),e.jsx(V,{className:"bg-teal-500 text-white text-sm font-bold",children:be()})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{href:"/login",children:e.jsx(g,{variant:"ghost",size:"sm",className:`h-9 px-3 sm:px-4 font-medium text-sm ${i?"text-white hover:text-white":""}`,"data-testid":"button-login",children:"Log In"})}),e.jsx(y,{href:"/signup",children:e.jsx(g,{className:"bg-primary text-black font-semibold rounded-full h-9 px-4 sm:px-6 text-sm","data-testid":"button-signup",children:"Sign Up"})})]})})]})}),!q&&a&&e.jsx("div",{className:"flex justify-center w-full",children:e.jsx("div",{className:"sm:hidden px-3 pb-2 w-full lg:w-[90%]",children:e.jsxs("div",{ref:N,className:"relative",children:[e.jsx(j,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 ${i?"text-zinc-400":"text-muted-foreground"} pointer-events-none z-10`}),e.jsx(xe,{type:"text",value:n,onChange:t=>Z(t.target.value),onFocus:()=>n.length>0&&p(!0),placeholder:`Search ${b.app_name}`,className:`pl-10 text-sm h-9 rounded-md ${i?"bg-zinc-900 border-zinc-700 text-white placeholder:text-zinc-500":"bg-muted/50 border-border"}`,"data-testid":"input-search-mobile"}),W&&(z.length>0||L.length>0||I.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto z-50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:n})]})}),I.length>0&&e.jsx("div",{children:I.slice(0,3).map(t=>{const r=ee(t);return e.jsxs("div",{onMouseDown:m=>{m.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=users`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsxs(E,{className:"h-8 w-8",children:[e.jsx(U,{src:t.profilePhoto}),e.jsx(V,{className:"bg-primary text-primary-foreground text-xs",children:r[0].toUpperCase()})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:r})})]},t._id)})}),L.length>0&&e.jsx("div",{children:L.slice(0,3).map(t=>e.jsxs("div",{onMouseDown:r=>{r.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=shows`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Shows"})]})]},t._id))}),z.length>0&&e.jsx("div",{children:z.slice(0,3).map(t=>e.jsxs("div",{onMouseDown:r=>{r.preventDefault(),$(`/search?q=${encodeURIComponent(n)}&filter=products`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Products"})]})]},t._id))})]})]})})})]}),a&&e.jsx(Xe,{open:G,onOpenChange:je})]})}export{kt as AppHeader};
