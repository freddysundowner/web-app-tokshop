import{c as K,a as ve,u as X,r as d,d as Y,j as e,f as Ce,e as he,b as ke,g as Se,B as p,L as f}from"./index-GnvmivW0.js";import{I as ue}from"./input-CDJz7BeV.js";import{A as H,a as Q,b as V}from"./avatar-T6GBhCEI.js";import{B as Ie}from"./badge-CL9MXKGS.js";import{S as $e,a as De}from"./sheet-D5QVNRkq.js";import{S as L}from"./separator-Datc7ShZ.js";import{T as Me,a as Ae,b as pe,c as fe}from"./tabs-BVwfLMcB.js";import{S as Pe}from"./shopping-bag-DVKU65dg.js";import{T as ge}from"./tag-jpmwmyGV.js";import{M as Le}from"./map-pin-Dn0fBe7g.js";import{H as ze}from"./house-Dra-u4aY.js";import{C}from"./chevron-right-CXw-mF7y.js";import{R as _e}from"./radio-B2CyFjtD.js";import{R as Fe}from"./receipt-0-3u59On.js";import{P as Te}from"./package-DWwkENv3.js";import{T as qe}from"./truck-DP2GNOS8.js";import{D as Oe}from"./dollar-sign-BPAh4ytq.js";import{S as Re}from"./store-CA2BTc9t.js";import{M as Ue}from"./message-circle-BazjP4NK.js";import{u as Be,g as Ee}from"./use-api-config-kum11Yvc.js";import{D as He,a as Qe,b as Ve,c as je}from"./dropdown-menu-B2qYf86A.js";import{S as N}from"./search-DE1AZ4db.js";import{P as Ke}from"./plus-CxBznHFO.js";import{C as Ge}from"./calendar-Cp1BJUQ9.js";import{M as We}from"./message-square-Cf3RgaVN.js";import"./index-kVvGtud3.js";import"./index-CmYyiKyk.js";import"./check-DoxmrmEj.js";import"./circle-iUglX5Df.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=K("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=K("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=K("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=K("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);function et({open:g,onOpenChange:z}){var O,R;const{user:x,logout:G}=ve(),[,_]=X(),[F,$]=d.useState(!0),j=(x==null?void 0:x._id)||(x==null?void 0:x.id),{data:T}=Y({queryKey:[`/api/profile/${j}`],enabled:!!j&&g,staleTime:0}),t=T||x,[h,W]=d.useState(t!=null&&t.seller?"selling":"buying");if(d.useEffect(()=>{g&&$(!0)},[g]),!x)return null;const J=()=>t.firstName&&t.lastName?`${t.firstName[0]}${t.lastName[0]}`.toUpperCase():t.firstName?t.firstName[0].toUpperCase():t.email?t.email[0].toUpperCase():"U",w=()=>{var a;return t.userName?t.userName:t.firstName||t.lastName?`${t.firstName||""}${t.lastName||""}`.trim():((a=t.email)==null?void 0:a.split("@")[0])||"User"},q=[{icon:_e,label:"Shows",href:"/live-shows",testId:"action-shows"},{icon:Fe,label:"Orders",href:"/orders",testId:"action-orders"},{icon:Te,label:"Inventory",href:"/inventory",testId:"action-inventory"},{icon:qe,label:"Shipments",href:"/shipping",testId:"action-shipments"},{icon:Oe,label:"Finances",href:"/payments",testId:"action-finances"}],D=[{icon:Pe,label:"Purchases",href:"/purchases",testId:"action-purchases"},{icon:ge,label:"My Offers",href:"/my-offers",testId:"action-my-offers"},{icon:Le,label:"Addresses",href:"/addresses",testId:"action-addresses"}],k=[{icon:Re,label:"Seller Hub",href:"/seller/hub",testId:"menu-seller-hub",sellerOnly:!0},{icon:Ue,label:"Friends",href:"/friends",testId:"menu-friends"},{icon:Xe,label:"Logout",testId:"menu-logout",onClick:async()=>{await G(),z(!1)},isDestructive:!0}],i=a=>{Ce.flushSync(()=>{$(!1),z(!1)}),_(a)},v=a=>e.jsxs("button",{onClick:()=>i(a.href),className:"flex flex-col items-center justify-center p-4 rounded-lg hover-elevate active-elevate-2 transition-all","data-testid":a.testId,children:[e.jsx(a.icon,{className:"h-6 w-6 text-foreground mb-2"}),e.jsx("span",{className:"text-xs text-center text-foreground font-medium",children:a.label})]},a.testId),b=a=>a.sellerOnly&&!t.seller?null:a.onClick?e.jsxs("button",{onClick:a.onClick,className:he("flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all",a.isDestructive&&"text-destructive"),"data-testid":a.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:he("h-5 w-5",a.isDestructive?"text-destructive":"text-foreground")}),e.jsx("span",{className:"text-base",children:a.label})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]},a.testId):e.jsxs("button",{onClick:()=>i(a.href||"#"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":a.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:a.label})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]},a.testId);return F?e.jsx($e,{open:g,onOpenChange:z,children:e.jsxs(De,{side:"right",className:"w-full sm:max-w-md p-0 overflow-y-auto flex flex-col",onOpenAutoFocus:a=>a.preventDefault(),children:[e.jsx("div",{className:"p-4",children:e.jsxs("button",{onClick:()=>i("/profile-view"),className:"flex items-center gap-3 w-full hover-elevate active-elevate-2 p-2 rounded-lg transition-all","data-testid":"button-profile-view",children:[e.jsxs(H,{className:"h-14 w-14","data-testid":"drawer-avatar",children:[e.jsx(Q,{src:t.profilePhoto,alt:t.userName||t.email}),e.jsx(V,{className:"bg-teal-500 text-white text-lg font-bold",children:J()})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"font-bold text-foreground text-base truncate","data-testid":"text-username",children:w()}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-0.5",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:((t==null?void 0:t.followingCount)||((O=t==null?void 0:t.following)==null?void 0:O.length)||0).toLocaleString()})," following"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold text-foreground",children:((t==null?void 0:t.followersCount)||((R=t==null?void 0:t.followers)==null?void 0:R.length)||0).toLocaleString()})," followers"]})]})]})]})}),e.jsx(L,{}),e.jsx("div",{className:"md:hidden flex-1",children:e.jsxs("div",{className:"space-y-1 p-2",children:[e.jsxs("button",{onClick:()=>i("/marketplace"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-home-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Home"})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>i("/browse"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-browse-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Je,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Browse"})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("button",{onClick:()=>i("/deals"),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":"menu-deals-mobile",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:"Deals"})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(L,{className:"my-2"}),t.seller&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-muted-foreground uppercase",children:"Selling"}),q.map(a=>e.jsxs("button",{onClick:()=>i(a.href),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":a.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:a.label})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]},a.testId))]}),e.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-muted-foreground uppercase",children:"Buying"}),D.map(a=>e.jsxs("button",{onClick:()=>i(a.href),className:"flex items-center justify-between w-full py-3 px-4 hover-elevate active-elevate-2 transition-all","data-testid":a.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:"h-5 w-5 text-foreground"}),e.jsx("span",{className:"text-base text-foreground",children:a.label})]}),e.jsx(C,{className:"h-5 w-5 text-muted-foreground"})]},a.testId)),e.jsx(L,{className:"my-2"}),e.jsx("div",{className:"space-y-1",children:k.map(a=>b(a))})]})}),e.jsxs(Me,{value:h,onValueChange:W,className:"hidden md:flex flex-1 flex-col",children:[e.jsxs(Ae,{className:"w-full justify-start rounded-none border-b bg-transparent p-0 h-auto",children:[t.seller&&e.jsx(pe,{value:"selling",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-foreground data-[state=active]:bg-transparent px-6 py-3 font-semibold","data-testid":"tab-selling",children:"Selling"}),e.jsx(pe,{value:"buying",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-foreground data-[state=active]:bg-transparent px-6 py-3 font-semibold","data-testid":"tab-buying",children:"Buying"})]}),t.seller&&e.jsxs(fe,{value:"selling",className:"flex-1 mt-0 p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:q.map(a=>v(a))}),e.jsx(L,{className:"my-4"}),e.jsx("div",{className:"space-y-1",children:k.map(a=>b(a))})]}),e.jsxs(fe,{value:"buying",className:"flex-1 mt-0 p-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:D.map(a=>v(a))}),e.jsx(L,{className:"my-4"}),e.jsx("div",{className:"space-y-1",children:k.map(a=>b(a))})]})]})]})}):null}function Mt({onMobileMenuToggle:g,mobileMenuOpen:z=!1,onMobileMenuClose:x,hideLogo:G=!1,hideNavigation:_=!1,hideSearch:F=!1,isDashboard:$=!1}){var ae,re,le,ne,oe,ie;const{settings:j,theme:T}=ke(),{user:t,isAuthenticated:h,refreshUserData:W}=ve(),{externalApiUrl:J}=Be(),[,w]=X(),[q,D]=d.useState(!1),[n,k]=d.useState(""),[i,v]=d.useState(!1),[b,O]=d.useState(""),[R,a]=d.useState(!1),U=d.useRef(null),{toast:Z}=Se(),[y]=X(),ee=(t==null?void 0:t._id)||(t==null?void 0:t.id),{data:be}=Y({queryKey:[`/api/profile/${ee}`],enabled:!!ee&&!!h,staleTime:0}),l=be||t,Ne=()=>{g==null||g()},we=s=>{D(s)},ye=()=>t!=null&&t.firstName&&(t!=null&&t.lastName)?`${t.firstName[0]}${t.lastName[0]}`.toUpperCase():t!=null&&t.firstName?t.firstName[0].toUpperCase():t!=null&&t.email?t.email[0].toUpperCase():"U",o=y.startsWith("/show/");d.useEffect(()=>{const s=setTimeout(()=>{O(n)},300);return()=>clearTimeout(s)},[n]);const{data:u}=Y({queryKey:["/api/products/search",b],queryFn:async()=>{var c,B,E,P,m,de,ce,me,xe;if(!b.trim())return{results:{products:{data:[]},rooms:{data:[]},users:{data:[]}}};const s=await fetch(`/api/products/search?q=${encodeURIComponent(b)}`);if(!s.ok)throw new Error("Search failed");const r=await s.json();return console.log("ðŸ” Autocomplete API response:",r),console.log("ðŸ” Products count:",((E=(B=(c=r==null?void 0:r.results)==null?void 0:c.products)==null?void 0:B.data)==null?void 0:E.length)||0),console.log("ðŸ” Shows/Rooms count:",((de=(m=(P=r==null?void 0:r.results)==null?void 0:P.rooms)==null?void 0:m.data)==null?void 0:de.length)||0),console.log("ðŸ” Users count:",((xe=(me=(ce=r==null?void 0:r.results)==null?void 0:ce.users)==null?void 0:me.data)==null?void 0:xe.length)||0),r},enabled:b.length>0}),M=((re=(ae=u==null?void 0:u.results)==null?void 0:ae.products)==null?void 0:re.data)||[],A=((ne=(le=u==null?void 0:u.results)==null?void 0:le.shows)==null?void 0:ne.data)||[],S=((ie=(oe=u==null?void 0:u.results)==null?void 0:oe.users)==null?void 0:ie.data)||[];d.useEffect(()=>{const s=r=>{U.current&&!U.current.contains(r.target)&&v(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const te=s=>{k(s),v(s.length>0)},I=s=>{console.log("ðŸ” Autocomplete click:",s),k(""),v(!1),w(s)},se=s=>s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName?s.firstName:s.lastName?s.lastName:s.username?s.username:s.name?s.name:s.displayName?s.displayName:s.email?s.email.split("@")[0]:"User";return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:`sticky top-0 z-50 border-b ${o?"bg-black border-zinc-800":"bg-background border-border"}`,children:[e.jsx("div",{className:`flex w-full ${$?"":"justify-center"}`,children:e.jsxs("div",{className:`flex items-center justify-between h-14 px-3 sm:px-6 w-full ${$?"":"lg:w-[90%]"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsx(p,{size:"icon",variant:"ghost",className:`lg:hidden h-9 w-9 rounded-full ${o?"text-white hover:text-white":""}`,onClick:Ne,"data-testid":"button-mobile-menu",children:e.jsx(Ye,{className:"h-5 w-5"})}),!G&&e.jsx(f,{href:"/","data-testid":"link-home",children:e.jsx("div",{className:"flex items-center gap-2",children:T.app_logo?e.jsx("img",{src:Ee(T.app_logo,J),alt:j.app_name||"Logo",className:"h-7 sm:h-8 w-auto object-contain"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-6 w-6 sm:h-7 sm:w-7 bg-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-xs sm:text-sm",children:j.app_name.charAt(0).toUpperCase()})}),e.jsx("span",{className:`text-base sm:text-lg font-bold hidden sm:inline ${o?"text-white":"text-foreground"}`,children:j.app_name})]})})}),!_&&h&&e.jsxs("div",{className:"hidden md:flex items-center gap-2 ml-4",children:[e.jsx(f,{href:"/",children:e.jsx(p,{className:y==="/"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${o?"text-white hover:text-white":""}`,variant:y==="/"?void 0:"ghost","data-testid":"button-home",children:"Home"})}),e.jsx(f,{href:"/browse",children:e.jsx(p,{className:y==="/browse"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${o?"text-white hover:text-white":""}`,variant:y==="/browse"?void 0:"ghost","data-testid":"button-browse",children:"Browse"})}),e.jsx(f,{href:"/deals",children:e.jsx(p,{className:y==="/deals"?"bg-primary text-primary-foreground font-semibold px-5 rounded-full h-9 text-sm":`font-medium text-sm h-9 px-4 ${o?"text-white hover:text-white":""}`,variant:y==="/deals"?void 0:"ghost","data-testid":"button-deals",children:"Deals"})})]}),!_&&!F&&h&&e.jsxs("div",{ref:U,className:"relative hidden sm:block w-48 md:w-64 lg:w-96 ml-2",children:[e.jsx(N,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 ${o?"text-zinc-400":"text-muted-foreground"} pointer-events-none z-10`}),e.jsx(ue,{type:"text",value:n,onChange:s=>te(s.target.value),onFocus:()=>n.length>0&&v(!0),placeholder:`Search ${j.app_name}`,className:`pl-10 text-sm h-9 rounded-md ${o?"bg-zinc-900 border-zinc-700 text-white placeholder:text-zinc-500":"bg-muted/50 border-border"}`,"data-testid":"input-search"}),i&&(M.length>0||A.length>0||S.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto z-50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:n})]})}),S.length>0&&e.jsx("div",{children:S.slice(0,3).map(s=>{const r=se(s),c=s.followers_count||s.followersCount||0,B=s.is_live||s.isLive||!1,E=s.live_viewers||s.liveViewers||0,P=m=>m>=1e6?(m/1e6).toFixed(1).replace(/\.0$/,"")+"M":m>=1e3?(m/1e3).toFixed(1).replace(/\.0$/,"")+"K":m.toString();return e.jsxs("div",{onMouseDown:m=>{m.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=users`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":`autocomplete-user-${s._id}`,children:[e.jsxs(H,{className:"h-10 w-10",children:[e.jsx(Q,{src:s.profilePhoto}),e.jsx(V,{className:"bg-primary text-primary-foreground text-xs",children:r[0].toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:r}),B&&e.jsxs(Ie,{variant:"destructive",className:"h-5 px-1.5 text-xs font-medium",children:["Live â€¢ ",P(E)]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[P(c)," followers"]})]})]},s._id)})}),A.length>0&&e.jsx("div",{children:e.jsxs("div",{onMouseDown:s=>{s.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=shows`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":"autocomplete-shows",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Shows"})]})]})}),M.length>0&&e.jsx("div",{children:e.jsxs("div",{onMouseDown:s=>{s.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=products`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer","data-testid":"autocomplete-products",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Products"})]})]})})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:h?e.jsxs(e.Fragment,{children:[(l==null?void 0:l.seller)&&e.jsxs(He,{open:R,onOpenChange:a,children:[e.jsx(Qe,{asChild:!0,children:e.jsx(p,{size:"icon",variant:"default",className:`h-9 w-9 rounded-full ${o?"bg-white text-black hover:bg-white/90":""}`,"data-testid":"button-seller-actions",children:e.jsx(Ke,{className:"h-5 w-5"})})}),e.jsxs(Ve,{align:"end",className:"w-48",children:[e.jsx(je,{asChild:!0,children:e.jsxs(f,{href:"/add-product",className:"flex items-center gap-2","data-testid":"menu-add-listing",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Listing"})]})}),e.jsx(je,{asChild:!0,children:e.jsxs(f,{href:"/schedule-show",className:"flex items-center gap-2","data-testid":"menu-schedule-show",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Schedule a Show"})]})})]})]}),!(l!=null&&l.seller)&&e.jsx(p,{variant:"outline",size:"sm",className:`hidden md:flex w-full rounded-full text-sm h-9 px-4 font-medium ${o?"border-white text-white bg-transparent hover:bg-white/10 hover:text-white":"border-border"}`,"data-testid":"button-seller-setup",onClick:async()=>{const s=(t==null?void 0:t._id)||(t==null?void 0:t.id);if(s)try{const r=await fetch(`/api/profile/${s}`,{credentials:"include"});if(r.ok){const c=await r.json();if(console.log("Fetched user data for seller check:",{seller:c.seller,applied_seller:c.applied_seller}),c.seller){console.log("User is a seller - updating local data and navigating to /seller/hub"),await W(),w("/seller/hub");return}console.log("User is not a seller - navigating to /seller/setup"),w("/seller/setup")}else console.error(`Failed to fetch user data: ${r.status} ${r.statusText}`),Z({title:"Could not verify status",description:"Proceeding to seller setup page",variant:"default"}),w("/seller/setup")}catch(r){console.error("Error fetching user data:",r),Z({title:"Connection error",description:"Could not verify seller status. Please try again.",variant:"destructive"}),w("/seller/setup")}},children:l!=null&&l.applied_seller?"Complete Seller Setup":"Become a Seller"}),e.jsx(f,{href:"/inbox",children:e.jsx(p,{size:"icon",variant:"ghost",className:`h-9 w-9 rounded-full hidden md:flex ${o?"text-white hover:text-white":""}`,"data-testid":"button-messages",children:e.jsx(We,{className:"h-5 w-5"})})}),t&&e.jsxs(H,{className:"h-9 w-9 cursor-pointer","data-testid":"avatar-user-profile",onClick:()=>D(!0),children:[e.jsx(Q,{src:l==null?void 0:l.profilePhoto,alt:`${(l==null?void 0:l.firstName)||(l==null?void 0:l.email)}`}),e.jsx(V,{className:"bg-teal-500 text-white text-sm font-bold",children:ye()})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{href:"/login",children:e.jsx(p,{variant:"ghost",size:"sm",className:`h-9 px-3 sm:px-4 font-medium text-sm ${o?"text-white hover:text-white":""}`,"data-testid":"button-login",children:"Log In"})}),e.jsx(f,{href:"/signup",children:e.jsx(p,{className:"bg-primary text-black font-semibold rounded-full h-9 px-4 sm:px-6 text-sm","data-testid":"button-signup",children:"Sign Up"})})]})})]})}),!F&&h&&e.jsx("div",{className:"flex justify-center w-full",children:e.jsx("div",{className:"sm:hidden px-3 pb-2 w-full lg:w-[90%]",children:e.jsxs("div",{ref:U,className:"relative",children:[e.jsx(N,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 ${o?"text-zinc-400":"text-muted-foreground"} pointer-events-none z-10`}),e.jsx(ue,{type:"text",value:n,onChange:s=>te(s.target.value),onFocus:()=>n.length>0&&v(!0),placeholder:`Search ${j.app_name}`,className:`pl-10 text-sm h-9 rounded-md ${o?"bg-zinc-900 border-zinc-700 text-white placeholder:text-zinc-500":"bg-muted/50 border-border"}`,"data-testid":"input-search-mobile"}),i&&(M.length>0||A.length>0||S.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto z-50",children:[e.jsx("div",{className:"px-3 py-2 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:n})]})}),S.length>0&&e.jsx("div",{children:S.slice(0,3).map(s=>{const r=se(s);return e.jsxs("div",{onMouseDown:c=>{c.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=users`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsxs(H,{className:"h-8 w-8",children:[e.jsx(Q,{src:s.profilePhoto}),e.jsx(V,{className:"bg-primary text-primary-foreground text-xs",children:r[0].toUpperCase()})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:r})})]},s._id)})}),A.length>0&&e.jsx("div",{children:A.slice(0,3).map(s=>e.jsxs("div",{onMouseDown:r=>{r.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=shows`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Shows"})]})]},s._id))}),M.length>0&&e.jsx("div",{children:M.slice(0,3).map(s=>e.jsxs("div",{onMouseDown:r=>{r.preventDefault(),I(`/search?q=${encodeURIComponent(n)}&filter=products`)},className:"flex items-center gap-3 px-3 py-2 hover-elevate cursor-pointer",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"in Products"})]})]},s._id))})]})]})})})]}),h&&e.jsx(et,{open:q,onOpenChange:we})]})}export{Mt as AppHeader};
