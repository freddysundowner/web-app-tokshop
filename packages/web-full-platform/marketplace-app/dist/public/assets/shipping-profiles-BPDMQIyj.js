import{c as U,r as u,a as H,g as W,a1 as G,d as S,j as e,B as c,A as B,a3 as R,h as V,i as Y,k as Z,l as J,m as X,n as ee,o as se,y as v}from"./index-GnvmivW0.js";import{u as b}from"./useMutation-DAKVWGzI.js";import{C as g,a as P,b as E,c as ie,d as te}from"./card-Bsqf9o7h.js";import{I as k}from"./input-CDJz7BeV.js";import{L as x}from"./label-CbaFYhHW.js";import{T as ae}from"./textarea-DkmXbh6O.js";import{S as re,a as ne,b as le,c as oe,d as de}from"./select-EUq1_viI.js";import{D as ce,a as pe,b as he,c as me,d as ue,e as ge}from"./dialog-D1L4tMGI.js";import{D as xe,a as fe,b as je,c as F}from"./dropdown-menu-B2qYf86A.js";import{P as T}from"./plus-CxBznHFO.js";import{P as q}from"./package-DWwkENv3.js";import{E as ye}from"./ellipsis-CgHIMWzm.js";import{S as ve}from"./square-pen-BpFUY4eK.js";import{T as be}from"./trash-2-V4a6hNaj.js";import"./index-BdQq_4o_.js";import"./index-CmYyiKyk.js";import"./index-Vue-pIA6.js";import"./chevron-down-tcDKR_mK.js";import"./check-DoxmrmEj.js";import"./chevron-up-Cda9uppk.js";import"./index-kVvGtud3.js";import"./chevron-right-CXw-mF7y.js";import"./circle-iUglX5Df.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=U("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]),Ne=[{key:"lb",label:"Pound (lb)"},{key:"oz",label:"Ounce (oz)"},{key:"kg",label:"Kilogram (kg)"},{key:"g",label:"Gram (g)"}];function Be(){const[A,p]=u.useState(!1),[I,h]=u.useState(!1),[o,m]=u.useState(null),[a,r]=u.useState({name:"",description:"",weight:0,scale:"oz"}),{user:i}=H(),{toast:n}=W(),l=G(),w=(i==null?void 0:i._id)||(i==null?void 0:i.id),{data:O}=S({queryKey:[`/api/profile/${w}`],enabled:!!w,staleTime:0}),f=O||i,{data:N=[],isLoading:M,error:_}=S({queryKey:["shipping-profiles",i==null?void 0:i.id],queryFn:async()=>{const s=await fetch(`/api/shipping/profiles/${i==null?void 0:i.id}`);if(!s.ok)throw new Error("Failed to fetch shipping profiles");return s.json()},enabled:!!(i!=null&&i.id)}),j=b({mutationFn:async s=>{const t=await v("POST",`/api/shipping/profiles/${i==null?void 0:i.id}`,s);if(!t.ok)throw new Error("Failed to create shipping profile");return t.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["shipping-profiles"]}),l.invalidateQueries({queryKey:["external-shipping-profiles"]}),p(!1),d(),n({title:"Success",description:"Shipping profile created successfully"})},onError:s=>{n({title:"Error",description:"Failed to create shipping profile",variant:"destructive"})}}),y=b({mutationFn:async s=>{const{id:t,...z}=s,C=await v("PUT",`/api/shipping/profiles/${t}`,{...z,userId:i==null?void 0:i.id});if(!C.ok)throw new Error("Failed to update shipping profile");return C.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["shipping-profiles"]}),l.invalidateQueries({queryKey:["external-shipping-profiles"]}),h(!1),m(null),d(),n({title:"Success",description:"Shipping profile updated successfully"})},onError:s=>{n({title:"Error",description:"Failed to update shipping profile",variant:"destructive"})}}),K=b({mutationFn:async s=>{const t=await v("DELETE",`/api/shipping/profiles/${s}`,{});if(!t.ok)throw new Error("Failed to delete shipping profile");return t.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["shipping-profiles"]}),l.invalidateQueries({queryKey:["external-shipping-profiles"]}),n({title:"Success",description:"Shipping profile deleted successfully"})},onError:s=>{n({title:"Error",description:"Failed to delete shipping profile",variant:"destructive"})}}),d=()=>{r({name:"",description:"",weight:0,scale:"oz"})},D=()=>{p(!0),d()},Q=s=>{m(s),r({name:s.name,description:s.description||"",weight:s.weight,scale:s.scale}),h(!0)},$=s=>{s.preventDefault(),o?y.mutate({...a,id:o._id}):j.mutate(a)},L=s=>{K.mutate(s)};return f!=null&&f.seller?e.jsxs("div",{className:"w-full p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Shipping Profiles"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your shipping profiles and settings"})]}),e.jsxs(c,{onClick:D,"data-testid":"button-create-profile",className:"w-full sm:w-auto",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Profile"]})]}),M?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[...Array(3)].map((s,t)=>e.jsxs(g,{className:"animate-pulse",children:[e.jsxs(P,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})})]},t))}):_?e.jsxs(g,{className:"p-8 text-center",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Error loading profiles"}),e.jsx("p",{className:"text-muted-foreground",children:"Failed to load shipping profiles. Please try again."})]}):N.length===0?e.jsxs(g,{className:"p-8 text-center",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No shipping profiles"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Get started by creating your first shipping profile."}),e.jsxs(c,{onClick:D,"data-testid":"button-create-first-profile",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Your First Profile"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(s=>e.jsxs(g,{className:"relative",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ie,{className:"text-lg text-foreground",children:s.name}),s.description&&e.jsx(te,{className:"mt-1",children:s.description})]}),e.jsxs(xe,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"sm","data-testid":`dropdown-profile-${s._id}`,children:e.jsx(ye,{className:"h-4 w-4"})})}),e.jsxs(je,{align:"end",children:[e.jsxs(F,{onClick:()=>Q(s),"data-testid":`button-edit-${s._id}`,children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(B,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(F,{onSelect:t=>t.preventDefault(),"data-testid":`button-delete-${s._id}`,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Delete"]})}),e.jsxs(V,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Delete Shipping Profile"}),e.jsxs(J,{children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']})]}),e.jsxs(X,{children:[e.jsx(ee,{children:"Cancel"}),e.jsx(se,{onClick:()=>L(s._id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]})]})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.weight," ",s.scale]})]})})})]},s._id))}),e.jsx(ce,{open:A||I,onOpenChange:s=>{s||(p(!1),h(!1),m(null),d())},children:e.jsxs(pe,{className:"max-w-md",children:[e.jsxs(he,{children:[e.jsx(me,{children:o?"Edit Shipping Profile":"Create Shipping Profile"}),e.jsx(ue,{children:o?"Update the shipping profile details below.":"Create a new shipping profile for your products."})]}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"Profile Name"}),e.jsx(k,{id:"name",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"e.g., Standard Shipping",required:!0,"data-testid":"input-profile-name"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"description",children:"Description"}),e.jsx(ae,{id:"description",value:a.description,onChange:s=>r({...a,description:s.target.value}),placeholder:"Optional description","data-testid":"input-profile-description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"weight",children:"Weight"}),e.jsx(k,{id:"weight",type:"number",value:a.weight,onChange:s=>r({...a,weight:Number(s.target.value)}),placeholder:"0",min:"0",step:"0.01",required:!0,"data-testid":"input-profile-weight"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"scale",children:"Unit"}),e.jsxs(re,{value:a.scale,onValueChange:s=>r({...a,scale:s}),required:!0,children:[e.jsx(ne,{"data-testid":"select-profile-scale",children:e.jsx(le,{placeholder:"Select unit"})}),e.jsx(oe,{children:Ne.map(s=>e.jsx(de,{value:s.key,children:s.label},s.key))})]})]})]}),e.jsxs(ge,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>{p(!1),h(!1),m(null),d()},children:"Cancel"}),e.jsx(c,{type:"submit",disabled:j.isPending||y.isPending,"data-testid":"button-save-profile",children:j.isPending||y.isPending?"Saving...":o?"Update Profile":"Create Profile"})]})]})]})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"Only sellers can access shipping profiles management."})]})}export{Be as default};
