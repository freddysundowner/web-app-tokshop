import{b as g,I as N,D as p,j as e,L as m}from"./index-sx6K5zvX.js";import{u as v}from"./useQuery-BbAFWd3P.js";import{A as b,a as w,b as y}from"./avatar-0uinKUeM.js";import{S as r}from"./search-CokuAmim.js";function q(){var c,o,x;const{settings:S}=g(),f=N(),t=new URLSearchParams(f).get("q")||"";p(t?`Search: ${t}`:"Search");const{data:a,isLoading:n}=v({queryKey:["/api/products/search",t],queryFn:async()=>{if(!t.trim())return{query:"",results:{products:[],rooms:[],users:[]}};const s=await fetch(`/api/products/search?q=${encodeURIComponent(t)}`);if(!s.ok)throw new Error("Search failed");return s.json()},enabled:t.length>0}),i=((c=a==null?void 0:a.results)==null?void 0:c.products)||[],l=((o=a==null?void 0:a.results)==null?void 0:o.rooms)||[],d=((x=a==null?void 0:a.results)==null?void 0:x.users)||[],j=i.length>0||l.length>0||d.length>0;return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[t&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-2",children:[e.jsx(r,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Search results for"})]}),e.jsx("h1",{className:"text-2xl font-bold text-foreground","data-testid":"text-search-query",children:t})]}),n&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Searching..."}),!n&&t&&!j&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-foreground font-medium mb-2",children:"No results found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try different keywords"})]}),d.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"People"}),e.jsx("div",{className:"space-y-2",children:d.map(s=>{var h,u;return e.jsx(m,{href:`/profile/${s._id}`,children:e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-md hover-elevate active-elevate-2 cursor-pointer","data-testid":`user-result-${s._id}`,children:[e.jsxs(b,{className:"h-12 w-12",children:[e.jsx(w,{src:s.profilePhoto,alt:s.firstName||s.username||"User"}),e.jsx(y,{className:"bg-primary text-primary-foreground",children:(((h=s.firstName)==null?void 0:h[0])||((u=s.username)==null?void 0:u[0])||"U").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground","data-testid":`text-username-${s._id}`,children:s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.username||"Unknown User"}),s.username&&s.firstName&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]})]})]})},s._id)})})]}),l.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Shows"}),e.jsx("div",{className:"space-y-2",children:l.map(s=>e.jsx(m,{href:`/show/${s._id}`,children:e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-md hover-elevate active-elevate-2 cursor-pointer","data-testid":`show-result-${s._id}`,children:[e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground",children:e.jsx(r,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground","data-testid":`text-show-title-${s._id}`,children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"in Shows"})]})]})},s._id))})]}),i.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Products"}),e.jsx("div",{className:"space-y-2",children:i.map(s=>e.jsx(m,{href:`/product/${s._id}`,children:e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-md hover-elevate active-elevate-2 cursor-pointer","data-testid":`product-result-${s._id}`,children:[e.jsx("div",{className:"w-16 h-16 rounded-md bg-muted flex-shrink-0 overflow-hidden",children:s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:e.jsx(r,{className:"h-6 w-6"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-foreground truncate","data-testid":`text-product-name-${s._id}`,children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.description}),s.owner&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["by ",s.owner.firstName||s.owner.username||"Unknown Seller"]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsxs("p",{className:"font-semibold text-foreground","data-testid":`text-price-${s._id}`,children:["US$",s.price.toFixed(2)]})})]})},s._id))})]}),!t&&!n&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-foreground font-medium mb-2",children:"Start searching"}),e.jsx("p",{className:"text-muted-foreground",children:"Enter a search term to find products, shows, and people"})]})]})})}export{q as default};
