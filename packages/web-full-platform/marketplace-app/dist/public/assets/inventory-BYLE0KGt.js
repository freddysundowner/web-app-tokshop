import{c as Dt,t as Rt,v as Ot,r as C,j as e,w as Ft,e as Lt,a as xt,g as gt,B as z,T as nt,x as Ut,y as ke,q as _e,u as $t,d as Xe}from"./index-GnvmivW0.js";import{u as qt}from"./useMutation-DAKVWGzI.js";import{C as be,b as Oe,a as Mt,c as zt}from"./card-Bsqf9o7h.js";import{B as je}from"./badge-CL9MXKGS.js";import{I as Bt}from"./input-CDJz7BeV.js";import{S as Ce,a as Se,b as Pe,c as Ee,d as W}from"./select-EUq1_viI.js";import{D as Vt,a as Ht,b as Kt,c as Je,d as Qt}from"./dropdown-menu-B2qYf86A.js";import{C as Ie}from"./checkbox-ZrZ7F-Dx.js";import{D as Ae,a as Te,b as De,c as Re,d as Ue}from"./dialog-D1L4tMGI.js";import{C as Wt}from"./pagination-COmJENkB.js";import{A as Gt,a as Xt}from"./alert-BCAR44i4.js";import{T as Jt,a as Zt,b as lt,c as Fe,d as Yt,e as Le}from"./table-DMJOUqQh.js";import{L as es}from"./label-CbaFYhHW.js";import{T as ts,a as ss,b as qe,c as Me}from"./tabs-BVwfLMcB.js";import{U as yt}from"./upload-DciL_rQf.js";import{D as ot}from"./download-D9C51OkM.js";import{F as as}from"./file-text-CoItu-Vz.js";import{C as He}from"./circle-check-big-CLZG244L.js";import{C as Ze,R as rs}from"./refresh-cw-DXFTvLUy.js";import{P as Ye}from"./package-DWwkENv3.js";import{P as dt}from"./plus-CxBznHFO.js";import{S as is}from"./search-DE1AZ4db.js";import{S as ct}from"./square-pen-BpFUY4eK.js";import{E as ns}from"./ellipsis-CgHIMWzm.js";import{E as ls}from"./eye-MrtS8r4d.js";import{T as os}from"./trash-2-V4a6hNaj.js";import"./index-BdQq_4o_.js";import"./index-CmYyiKyk.js";import"./index-Vue-pIA6.js";import"./chevron-down-tcDKR_mK.js";import"./check-DoxmrmEj.js";import"./chevron-up-Cda9uppk.js";import"./index-kVvGtud3.js";import"./chevron-right-CXw-mF7y.js";import"./circle-iUglX5Df.js";import"./chevron-left-BnuQCvWV.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Dt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var vt={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(x,D){((H,v)=>{x.exports=v()})(Ot,function H(){var v=typeof self<"u"?self:typeof window<"u"?window:v!==void 0?v:{},N,X=!v.document&&!!v.postMessage,F=v.IS_PAPA_WORKER||!1,R={},U=0,f={};function Y(s){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(a){var i=oe(a);i.chunkSize=parseInt(i.chunkSize),a.step||a.chunk||(i.chunkSize=null),this._handle=new ie(i),(this._handle.streamer=this)._config=i}).call(this,s),this.parseChunk=function(a,i){var h=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<h){let w=this._config.newline;w||(p=this._config.quoteChar||'"',w=this._handle.guessLineEndings(a,p)),a=[...a.split(w).slice(h)].join(w)}this.isFirstChunk&&T(this._config.beforeFirstChunk)&&(p=this._config.beforeFirstChunk(a))!==void 0&&(a=p),this.isFirstChunk=!1,this._halted=!1;var h=this._partialLine+a,p=(this._partialLine="",this._handle.parse(h,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(a=p.meta.cursor,h=(this._finished||(this._partialLine=h.substring(a-this._baseIndex),this._baseIndex=a),p&&p.data&&(this._rowCount+=p.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),F)v.postMessage({results:p,workerId:f.WORKER_ID,finished:h});else if(T(this._config.chunk)&&!i){if(this._config.chunk(p,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=p=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(p.data),this._completeResults.errors=this._completeResults.errors.concat(p.errors),this._completeResults.meta=p.meta),this._completed||!h||!T(this._config.complete)||p&&p.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),h||p&&p.meta.paused||this._nextChunk(),p}this._halted=!0},this._sendError=function(a){T(this._config.error)?this._config.error(a):F&&this._config.error&&v.postMessage({workerId:f.WORKER_ID,error:a,finished:!1})}}function re(s){var a;(s=s||{}).chunkSize||(s.chunkSize=f.RemoteChunkSize),Y.call(this,s),this._nextChunk=X?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),X||(a.onload=ne(this._chunkLoaded,this),a.onerror=ne(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!X),this._config.downloadRequestHeaders){var i,h=this._config.downloadRequestHeaders;for(i in h)a.setRequestHeader(i,h[i])}var p;this._config.chunkSize&&(p=this._start+this._config.chunkSize-1,a.setRequestHeader("Range","bytes="+this._start+"-"+p));try{a.send(this._config.downloadRequestBody)}catch(w){this._chunkError(w.message)}X&&a.status===0&&this._chunkError()}},this._chunkLoaded=function(){a.readyState===4&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize||a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(i=>(i=i.getResponseHeader("Content-Range"))!==null?parseInt(i.substring(i.lastIndexOf("/")+1)):-1)(a),this.parseChunk(a.responseText)))},this._chunkError=function(i){i=a.statusText||i,this._sendError(new Error(i))}}function ee(s){(s=s||{}).chunkSize||(s.chunkSize=f.LocalChunkSize),Y.call(this,s);var a,i,h=typeof FileReader<"u";this.stream=function(p){this._input=p,i=p.slice||p.webkitSlice||p.mozSlice,h?((a=new FileReader).onload=ne(this._chunkLoaded,this),a.onerror=ne(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var p=this._input,w=(this._config.chunkSize&&(w=Math.min(this._start+this._config.chunkSize,this._input.size),p=i.call(p,this._start,w)),a.readAsText(p,this._config.encoding));h||this._chunkLoaded({target:{result:w}})},this._chunkLoaded=function(p){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(p.target.result)},this._chunkError=function(){this._sendError(a.error)}}function G(s){var a;Y.call(this,s=s||{}),this.stream=function(i){return a=i,this._nextChunk()},this._nextChunk=function(){var i,h;if(!this._finished)return i=this._config.chunkSize,a=i?(h=a.substring(0,i),a.substring(i)):(h=a,""),this._finished=!a,this.parseChunk(h)}}function J(s){Y.call(this,s=s||{});var a=[],i=!0,h=!1;this.pause=function(){Y.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){Y.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(p){this._input=p,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){h&&a.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):i=!0},this._streamData=ne(function(p){try{a.push(typeof p=="string"?p:p.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(w){this._streamError(w)}},this),this._streamError=ne(function(p){this._streamCleanUp(),this._sendError(p)},this),this._streamEnd=ne(function(){this._streamCleanUp(),h=!0,this._streamData("")},this),this._streamCleanUp=ne(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ie(s){var a,i,h,p,w=Math.pow(2,53),K=-w,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,m=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,k=this,$=0,d=0,I=!1,r=!1,l=[],n={data:[],errors:[],meta:{}};function u(g){return s.skipEmptyLines==="greedy"?g.join("").trim()==="":g.length===1&&g[0].length===0}function j(){if(n&&h&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),h=!1),s.skipEmptyLines&&(n.data=n.data.filter(function(c){return!u(c)})),y()){let c=function(q,M){T(s.transformHeader)&&(q=s.transformHeader(q,M)),l.push(q)};if(n)if(Array.isArray(n.data[0])){for(var g=0;y()&&g<n.data.length;g++)n.data[g].forEach(c);n.data.splice(0,1)}else n.data.forEach(c)}function b(c,q){for(var M=s.header?{}:[],A=0;A<c.length;A++){var L=A,E=c[A],E=((de,_)=>(V=>(s.dynamicTypingFunction&&s.dynamicTyping[V]===void 0&&(s.dynamicTyping[V]=s.dynamicTypingFunction(V)),(s.dynamicTyping[V]||s.dynamicTyping)===!0))(de)?_==="true"||_==="TRUE"||_!=="false"&&_!=="FALSE"&&((V=>{if(te.test(V)&&(V=parseFloat(V),K<V&&V<w))return 1})(_)?parseFloat(_):m.test(_)?new Date(_):_===""?null:_):_)(L=s.header?A>=l.length?"__parsed_extra":l[A]:L,E=s.transform?s.transform(E,L):E);L==="__parsed_extra"?(M[L]=M[L]||[],M[L].push(E)):M[L]=E}return s.header&&(A>l.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+A,d+q):A<l.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+A,d+q)),M}var O;n&&(s.header||s.dynamicTyping||s.transform)&&(O=1,!n.data.length||Array.isArray(n.data[0])?(n.data=n.data.map(b),O=n.data.length):n.data=b(n.data,0),s.header&&n.meta&&(n.meta.fields=l),d+=O)}function y(){return s.header&&l.length===0}function P(g,b,O,c){g={type:g,code:b,message:O},c!==void 0&&(g.row=c),n.errors.push(g)}T(s.step)&&(p=s.step,s.step=function(g){n=g,y()?j():(j(),n.data.length!==0&&($+=g.data.length,s.preview&&$>s.preview?i.abort():(n.data=n.data[0],p(n,k))))}),this.parse=function(g,b,O){var c=s.quoteChar||'"',c=(s.newline||(s.newline=this.guessLineEndings(g,c)),h=!1,s.delimiter?T(s.delimiter)&&(s.delimiter=s.delimiter(g),n.meta.delimiter=s.delimiter):((c=((q,M,A,L,E)=>{var de,_,V,ge;E=E||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var we=0;we<E.length;we++){for(var ue,ye=E[we],ae=0,le=0,Q=0,Z=(V=void 0,new me({comments:L,delimiter:ye,newline:M,preview:10}).parse(q)),he=0;he<Z.data.length;he++)A&&u(Z.data[he])?Q++:(ue=Z.data[he].length,le+=ue,V===void 0?V=ue:0<ue&&(ae+=Math.abs(ue-V),V=ue));0<Z.data.length&&(le/=Z.data.length-Q),(_===void 0||ae<=_)&&(ge===void 0||ge<le)&&1.99<le&&(_=ae,de=ye,ge=le)}return{successful:!!(s.delimiter=de),bestDelimiter:de}})(g,s.newline,s.skipEmptyLines,s.comments,s.delimitersToGuess)).successful?s.delimiter=c.bestDelimiter:(h=!0,s.delimiter=f.DefaultDelimiter),n.meta.delimiter=s.delimiter),oe(s));return s.preview&&s.header&&c.preview++,a=g,i=new me(c),n=i.parse(a,b,O),j(),I?{meta:{paused:!0}}:n||{meta:{paused:!1}}},this.paused=function(){return I},this.pause=function(){I=!0,i.abort(),a=T(s.chunk)?"":a.substring(i.getCharIndex())},this.resume=function(){k.streamer._halted?(I=!1,k.streamer.parseChunk(a,!0)):setTimeout(k.resume,3)},this.aborted=function(){return r},this.abort=function(){r=!0,i.abort(),n.meta.aborted=!0,T(s.complete)&&s.complete(n),a=""},this.guessLineEndings=function(q,c){q=q.substring(0,1048576);var c=new RegExp(ce(c)+"([^]*?)"+ce(c),"gm"),O=(q=q.replace(c,"")).split("\r"),c=q.split(`
`),q=1<c.length&&c[0].length<O[0].length;if(O.length===1||q)return`
`;for(var M=0,A=0;A<O.length;A++)O[A][0]===`
`&&M++;return M>=O.length/2?`\r
`:"\r"}}function ce(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function me(s){var a=(s=s||{}).delimiter,i=s.newline,h=s.comments,p=s.step,w=s.preview,K=s.fastMode,te=null,m=!1,k=s.quoteChar==null?'"':s.quoteChar,$=k;if(s.escapeChar!==void 0&&($=s.escapeChar),(typeof a!="string"||-1<f.BAD_DELIMITERS.indexOf(a))&&(a=","),h===a)throw new Error("Comment character same as delimiter");h===!0?h="#":(typeof h!="string"||-1<f.BAD_DELIMITERS.indexOf(h))&&(h=!1),i!==`
`&&i!=="\r"&&i!==`\r
`&&(i=`
`);var d=0,I=!1;this.parse=function(r,l,n){if(typeof r!="string")throw new Error("Input must be a string");var u=r.length,j=a.length,y=i.length,P=h.length,g=T(p),b=[],O=[],c=[],q=d=0;if(!r)return ae();if(K||K!==!1&&r.indexOf(k)===-1){for(var M=r.split(i),A=0;A<M.length;A++){if(c=M[A],d+=c.length,A!==M.length-1)d+=i.length;else if(n)return ae();if(!h||c.substring(0,P)!==h){if(g){if(b=[],ge(c.split(a)),le(),I)return ae()}else ge(c.split(a));if(w&&w<=A)return b=b.slice(0,w),ae(!0)}}return ae()}for(var L=r.indexOf(a,d),E=r.indexOf(i,d),de=new RegExp(ce($)+ce(k),"g"),_=r.indexOf(k,d);;)if(r[d]===k)for(_=d,d++;;){if((_=r.indexOf(k,_+1))===-1)return n||O.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:d}),ue();if(_===u-1)return ue(r.substring(d,_).replace(de,k));if(k===$&&r[_+1]===$)_++;else if(k===$||_===0||r[_-1]!==$){L!==-1&&L<_+1&&(L=r.indexOf(a,_+1));var V=we((E=E!==-1&&E<_+1?r.indexOf(i,_+1):E)===-1?L:Math.min(L,E));if(r.substr(_+1+V,j)===a){c.push(r.substring(d,_).replace(de,k)),r[d=_+1+V+j]!==k&&(_=r.indexOf(k,d)),L=r.indexOf(a,d),E=r.indexOf(i,d);break}if(V=we(E),r.substring(_+1+V,_+1+V+y)===i){if(c.push(r.substring(d,_).replace(de,k)),ye(_+1+V+y),L=r.indexOf(a,d),_=r.indexOf(k,d),g&&(le(),I))return ae();if(w&&b.length>=w)return ae(!0);break}O.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:d}),_++}}else if(h&&c.length===0&&r.substring(d,d+P)===h){if(E===-1)return ae();d=E+y,E=r.indexOf(i,d),L=r.indexOf(a,d)}else if(L!==-1&&(L<E||E===-1))c.push(r.substring(d,L)),d=L+j,L=r.indexOf(a,d);else{if(E===-1)break;if(c.push(r.substring(d,E)),ye(E+y),g&&(le(),I))return ae();if(w&&b.length>=w)return ae(!0)}return ue();function ge(Q){b.push(Q),q=d}function we(Q){var Z=0;return Z=Q!==-1&&(Q=r.substring(_+1,Q))&&Q.trim()===""?Q.length:Z}function ue(Q){return n||(Q===void 0&&(Q=r.substring(d)),c.push(Q),d=u,ge(c),g&&le()),ae()}function ye(Q){d=Q,ge(c),c=[],E=r.indexOf(i,d)}function ae(Q){if(s.header&&!l&&b.length&&!m){var Z=b[0],he=Object.create(null),$e=new Set(Z);let ze=!1;for(let Ne=0;Ne<Z.length;Ne++){let pe=Z[Ne];if(he[pe=T(s.transformHeader)?s.transformHeader(pe,Ne):pe]){let ve,Be=he[pe];for(;ve=pe+"_"+Be,Be++,$e.has(ve););$e.add(ve),Z[Ne]=ve,he[pe]++,ze=!0,(te=te===null?{}:te)[ve]=pe}else he[pe]=1,Z[Ne]=pe;$e.add(pe)}ze&&console.warn("Duplicate headers found and renamed."),m=!0}return{data:b,errors:O,meta:{delimiter:a,linebreak:i,aborted:I,truncated:!!Q,cursor:q+(l||0),renamedHeaders:te}}}function le(){p(ae()),b=[],O=[]}},this.abort=function(){I=!0},this.getCharIndex=function(){return d}}function S(s){var a=s.data,i=R[a.workerId],h=!1;if(a.error)i.userError(a.error,a.file);else if(a.results&&a.results.data){var p={abort:function(){h=!0,se(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:xe,resume:xe};if(T(i.userStep)){for(var w=0;w<a.results.data.length&&(i.userStep({data:a.results.data[w],errors:a.results.errors,meta:a.results.meta},p),!h);w++);delete a.results}else T(i.userChunk)&&(i.userChunk(a.results,p,a.file),delete a.results)}a.finished&&!h&&se(a.workerId,a.results)}function se(s,a){var i=R[s];T(i.userComplete)&&i.userComplete(a),i.terminate(),delete R[s]}function xe(){throw new Error("Not implemented.")}function oe(s){if(typeof s!="object"||s===null)return s;var a,i=Array.isArray(s)?[]:{};for(a in s)i[a]=oe(s[a]);return i}function ne(s,a){return function(){s.apply(a,arguments)}}function T(s){return typeof s=="function"}return f.parse=function(s,a){var i=(a=a||{}).dynamicTyping||!1;if(T(i)&&(a.dynamicTypingFunction=i,i={}),a.dynamicTyping=i,a.transform=!!T(a.transform)&&a.transform,!a.worker||!f.WORKERS_SUPPORTED)return i=null,f.NODE_STREAM_INPUT,typeof s=="string"?(s=(h=>h.charCodeAt(0)!==65279?h:h.slice(1))(s),i=new(a.download?re:G)(a)):s.readable===!0&&T(s.read)&&T(s.on)?i=new J(a):(v.File&&s instanceof File||s instanceof Object)&&(i=new ee(a)),i.stream(s);(i=(()=>{var h;return!!f.WORKERS_SUPPORTED&&(h=(()=>{var p=v.URL||v.webkitURL||null,w=H.toString();return f.BLOB_URL||(f.BLOB_URL=p.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",w,")();"],{type:"text/javascript"})))})(),(h=new v.Worker(h)).onmessage=S,h.id=U++,R[h.id]=h)})()).userStep=a.step,i.userChunk=a.chunk,i.userComplete=a.complete,i.userError=a.error,a.step=T(a.step),a.chunk=T(a.chunk),a.complete=T(a.complete),a.error=T(a.error),delete a.worker,i.postMessage({input:s,config:a,workerId:i.id})},f.unparse=function(s,a){var i=!1,h=!0,p=",",w=`\r
`,K='"',te=K+K,m=!1,k=null,$=!1,d=((()=>{if(typeof a=="object"){if(typeof a.delimiter!="string"||f.BAD_DELIMITERS.filter(function(l){return a.delimiter.indexOf(l)!==-1}).length||(p=a.delimiter),typeof a.quotes!="boolean"&&typeof a.quotes!="function"&&!Array.isArray(a.quotes)||(i=a.quotes),typeof a.skipEmptyLines!="boolean"&&typeof a.skipEmptyLines!="string"||(m=a.skipEmptyLines),typeof a.newline=="string"&&(w=a.newline),typeof a.quoteChar=="string"&&(K=a.quoteChar),typeof a.header=="boolean"&&(h=a.header),Array.isArray(a.columns)){if(a.columns.length===0)throw new Error("Option columns is empty");k=a.columns}a.escapeChar!==void 0&&(te=a.escapeChar+K),a.escapeFormulae instanceof RegExp?$=a.escapeFormulae:typeof a.escapeFormulae=="boolean"&&a.escapeFormulae&&($=/^[=+\-@\t\r].*$/)}})(),new RegExp(ce(K),"g"));if(typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(s)){if(!s.length||Array.isArray(s[0]))return I(null,s,m);if(typeof s[0]=="object")return I(k||Object.keys(s[0]),s,m)}else if(typeof s=="object")return typeof s.data=="string"&&(s.data=JSON.parse(s.data)),Array.isArray(s.data)&&(s.fields||(s.fields=s.meta&&s.meta.fields||k),s.fields||(s.fields=Array.isArray(s.data[0])?s.fields:typeof s.data[0]=="object"?Object.keys(s.data[0]):[]),Array.isArray(s.data[0])||typeof s.data[0]=="object"||(s.data=[s.data])),I(s.fields||[],s.data||[],m);throw new Error("Unable to serialize unrecognized input");function I(l,n,u){var j="",y=(typeof l=="string"&&(l=JSON.parse(l)),typeof n=="string"&&(n=JSON.parse(n)),Array.isArray(l)&&0<l.length),P=!Array.isArray(n[0]);if(y&&h){for(var g=0;g<l.length;g++)0<g&&(j+=p),j+=r(l[g],g);0<n.length&&(j+=w)}for(var b=0;b<n.length;b++){var O=(y?l:n[b]).length,c=!1,q=y?Object.keys(n[b]).length===0:n[b].length===0;if(u&&!y&&(c=u==="greedy"?n[b].join("").trim()==="":n[b].length===1&&n[b][0].length===0),u==="greedy"&&y){for(var M=[],A=0;A<O;A++){var L=P?l[A]:A;M.push(n[b][L])}c=M.join("").trim()===""}if(!c){for(var E=0;E<O;E++){0<E&&!q&&(j+=p);var de=y&&P?l[E]:E;j+=r(n[b][de],E)}b<n.length-1&&(!u||0<O&&!q)&&(j+=w)}}return j}function r(l,n){var u,j;return l==null?"":l.constructor===Date?JSON.stringify(l).slice(1,25):(j=!1,$&&typeof l=="string"&&$.test(l)&&(l="'"+l,j=!0),u=l.toString().replace(d,te),(j=j||i===!0||typeof i=="function"&&i(l,n)||Array.isArray(i)&&i[n]||((y,P)=>{for(var g=0;g<P.length;g++)if(-1<y.indexOf(P[g]))return!0;return!1})(u,f.BAD_DELIMITERS)||-1<u.indexOf(p)||u.charAt(0)===" "||u.charAt(u.length-1)===" ")?K+u+K:u)}},f.RECORD_SEP="",f.UNIT_SEP="",f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!X&&!!v.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=me,f.ParserHandle=ie,f.NetworkStreamer=re,f.FileStreamer=ee,f.StringStreamer=G,f.ReadableStreamStreamer=J,v.jQuery&&((N=v.jQuery).fn.parse=function(s){var a=s.config||{},i=[];return this.each(function(w){if(!(N(this).prop("tagName").toUpperCase()==="INPUT"&&N(this).attr("type").toLowerCase()==="file"&&v.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)i.push({file:this.files[K],inputElem:this,instanceConfig:N.extend({},a)})}),h(),this;function h(){if(i.length===0)T(s.complete)&&s.complete();else{var w,K,te,m,k=i[0];if(T(s.before)){var $=s.before(k.file,k.inputElem);if(typeof $=="object"){if($.action==="abort")return w="AbortError",K=k.file,te=k.inputElem,m=$.reason,void(T(s.error)&&s.error({name:w},K,te,m));if($.action==="skip")return void p();typeof $.config=="object"&&(k.instanceConfig=N.extend(k.instanceConfig,$.config))}else if($==="skip")return void p()}var d=k.instanceConfig.complete;k.instanceConfig.complete=function(I){T(d)&&d(I,k.file,k.inputElem),p()},f.parse(k.file,k.instanceConfig)}}function p(){i.splice(0,1),h()}}),F&&(v.onmessage=function(s){s=s.data,f.WORKER_ID===void 0&&s&&(f.WORKER_ID=s.workerId),typeof s.input=="string"?v.postMessage({workerId:f.WORKER_ID,results:f.parse(s.input,s.config),finished:!0}):(v.File&&s.input instanceof File||s.input instanceof Object)&&(s=f.parse(s.input,s.config))&&v.postMessage({workerId:f.WORKER_ID,results:s,finished:!0})}),(re.prototype=Object.create(Y.prototype)).constructor=re,(ee.prototype=Object.create(Y.prototype)).constructor=ee,(G.prototype=Object.create(G.prototype)).constructor=G,(J.prototype=Object.create(Y.prototype)).constructor=J,f})})(vt);var cs=vt.exports;const et=Rt(cs);function us(x,D=[]){let H=[];function v(X,F){const R=C.createContext(F);R.displayName=X+"Context";const U=H.length;H=[...H,F];const f=re=>{var me;const{scope:ee,children:G,...J}=re,ie=((me=ee==null?void 0:ee[x])==null?void 0:me[U])||R,ce=C.useMemo(()=>J,Object.values(J));return e.jsx(ie.Provider,{value:ce,children:G})};f.displayName=X+"Provider";function Y(re,ee){var ie;const G=((ie=ee==null?void 0:ee[x])==null?void 0:ie[U])||R,J=C.useContext(G);if(J)return J;if(F!==void 0)return F;throw new Error(`\`${re}\` must be used within \`${X}\``)}return[f,Y]}const N=()=>{const X=H.map(F=>C.createContext(F));return function(R){const U=(R==null?void 0:R[x])||X;return C.useMemo(()=>({[`__scope${x}`]:{...R,[x]:U}}),[R,U])}};return N.scopeName=x,[v,hs(N,...D)]}function hs(...x){const D=x[0];if(x.length===1)return D;const H=()=>{const v=x.map(N=>({useScope:N(),scopeName:N.scopeName}));return function(X){const F=v.reduce((R,{useScope:U,scopeName:f})=>{const re=U(X)[`__scope${f}`];return{...R,...re}},{});return C.useMemo(()=>({[`__scope${D.scopeName}`]:F}),[F])}};return H.scopeName=D.scopeName,H}var ps=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],jt=ps.reduce((x,D)=>{const H=Ft(`Primitive.${D}`),v=C.forwardRef((N,X)=>{const{asChild:F,...R}=N,U=F?H:D;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(U,{...R,ref:X})});return v.displayName=`Primitive.${D}`,{...x,[D]:v}},{}),st="Progress",at=100,[ms]=us(st),[fs,xs]=ms(st),bt=C.forwardRef((x,D)=>{const{__scopeProgress:H,value:v=null,max:N,getValueLabel:X=gs,...F}=x;(N||N===0)&&!ut(N)&&console.error(ys(`${N}`,"Progress"));const R=ut(N)?N:at;v!==null&&!ht(v,R)&&console.error(vs(`${v}`,"Progress"));const U=ht(v,R)?v:null,f=Qe(U)?X(U,R):void 0;return e.jsx(fs,{scope:H,value:U,max:R,children:e.jsx(jt.div,{"aria-valuemax":R,"aria-valuemin":0,"aria-valuenow":Qe(U)?U:void 0,"aria-valuetext":f,role:"progressbar","data-state":kt(U,R),"data-value":U??void 0,"data-max":R,...F,ref:D})})});bt.displayName=st;var wt="ProgressIndicator",Nt=C.forwardRef((x,D)=>{const{__scopeProgress:H,...v}=x,N=xs(wt,H);return e.jsx(jt.div,{"data-state":kt(N.value,N.max),"data-value":N.value??void 0,"data-max":N.max,...v,ref:D})});Nt.displayName=wt;function gs(x,D){return`${Math.round(x/D*100)}%`}function kt(x,D){return x==null?"indeterminate":x===D?"complete":"loading"}function Qe(x){return typeof x=="number"}function ut(x){return Qe(x)&&!isNaN(x)&&x>0}function ht(x,D){return Qe(x)&&!isNaN(x)&&x<=D&&x>=0}function ys(x,D){return`Invalid prop \`max\` of value \`${x}\` supplied to \`${D}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${at}\`.`}function vs(x,D){return`Invalid prop \`value\` of value \`${x}\` supplied to \`${D}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${at} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var _t=bt,js=Nt;const Ct=C.forwardRef(({className:x,value:D,...H},v)=>e.jsx(_t,{ref:v,className:Lt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",x),...H,children:e.jsx(js,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(D||0)}%)`}})}));Ct.displayName=_t.displayName;const bs=new Set(["category","shippingprofile","weight","width","height","length","scale"]),ws=x=>x.toLowerCase().replace(/[^a-z0-9]/g,""),pt=["name","price","quantity"],Ke={name:{label:"Product Name",required:!0,type:"text"},description:{label:"Description",required:!1,type:"text"},price:{label:"Price",required:!0,type:"number"},quantity:{label:"Quantity",required:!0,type:"number"},listingType:{label:"Listing Type",required:!1,type:"select",options:["buy_now","auction"]},colors:{label:"Colors (comma-separated)",required:!1,type:"array"},sizes:{label:"Sizes (comma-separated)",required:!1,type:"array"},featured:{label:"Featured",required:!1,type:"boolean"}},Ns=5*1024*1024,tt=10;function ks({isOpen:x,onClose:D,onSuccess:H}){const[v,N]=C.useState("upload"),[X,F]=C.useState([]),[R,U]=C.useState([]),[f,Y]=C.useState({}),[re,ee]=C.useState([]),[G,J]=C.useState({processed:0,total:0,successful:0,failed:0,isProcessing:!1}),[ie,ce]=C.useState([]),[me,S]=C.useState(!1),se=C.useRef(null),{user:xe}=xt(),{toast:oe}=gt(),ne=()=>{N("upload"),F([]),U([]),Y({}),ee([]),J({processed:0,total:0,successful:0,failed:0,isProcessing:!1}),ce([]),S(!1),se.current&&(se.current.value="")},T=()=>{ne(),D()},s=()=>{const r=[{name:"Example Product 1",description:"A great product with excellent features",price:"29.99",quantity:"100",listingType:"buy_now",colors:"Red, Blue, Black",sizes:"S, M, L, XL",featured:"true"},{name:"Example Product 2",description:"Another amazing product",price:"49.99",quantity:"50",listingType:"buy_now",colors:"White, Gray",sizes:"One Size",featured:"false"}],l=et.unparse(r),n=new Blob([l],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),j=URL.createObjectURL(n);u.setAttribute("href",j),u.setAttribute("download","product_upload_template.csv"),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)},a=r=>!r.type.includes("csv")&&!r.name.endsWith(".csv")?"Please upload a CSV file":r.size>Ns?"File size must be less than 5MB":null,i=r=>{et.parse(r,{header:!0,skipEmptyLines:!0,complete:l=>{if(l.errors.length>0){oe({title:"CSV Parse Error",description:`Errors found in CSV: ${l.errors.map(y=>y.message).join(", ")}`,variant:"destructive"});return}if(l.data.length===0){oe({title:"Empty CSV",description:"The CSV file appears to be empty",variant:"destructive"});return}const u=Object.keys(l.data[0]).filter(y=>!bs.has(ws(y)));U(u),F(l.data);const j={};u.forEach(y=>{const P=y.toLowerCase().trim(),g=Object.keys(Ke).find(b=>b.toLowerCase()===P||Ke[b].label.toLowerCase()===P);g?j[y]=g:j[y]=""}),Y(j),N("mapping")},error:l=>{oe({title:"CSV Parse Error",description:l.message,variant:"destructive"})}})},h=r=>{const l=a(r);if(l){oe({title:"Invalid File",description:l,variant:"destructive"});return}i(r)},p=r=>{var n;const l=(n=r.target.files)==null?void 0:n[0];l&&h(l)},w=C.useCallback(r=>{r.preventDefault(),S(!1);const l=r.dataTransfer.files[0];l&&h(l)},[]),K=C.useCallback(r=>{r.preventDefault(),S(!0)},[]),te=C.useCallback(r=>{r.preventDefault(),S(!1)},[]),m=async()=>{const r=[];X.forEach((l,n)=>{const u={name:"",price:0,quantity:0,rowIndex:n+1,errors:[],isValid:!0};Object.entries(f).forEach(([j,y])=>{var g;const P=(g=l[j])==null?void 0:g.trim();if(y&&P!==void 0){const b=Ke[y];if(b.required&&(!P||P===""))u.errors.push(`${b.label} is required`),u.isValid=!1;else if(P&&P!=="")switch(b.type){case"number":const O=parseFloat(P);isNaN(O)||O<0?(u.errors.push(`${b.label} must be a valid positive number`),u.isValid=!1):u[y]=O;break;case"select":const c=b;c.options&&!c.options.includes(P)?(u.errors.push(`${b.label} must be one of: ${c.options.join(", ")}`),u.isValid=!1):u[y]=P;break;case"array":const q=P.split(",").map(A=>A.trim()).filter(A=>A);u[y]=q;break;case"boolean":const M=P.toLowerCase();["true","1","yes","y"].includes(M)?u[y]=!0:["false","0","no","n",""].includes(M)?u[y]=!1:(u.errors.push(`${b.label} must be true/false, yes/no, 1/0, or y/n`),u.isValid=!1);break;default:u[y]=P}}}),pt.forEach(j=>{Object.values(f).includes(j)||(u.errors.push(`Required field '${j}' is not mapped`),u.isValid=!1)}),r.push(u)}),ee(r),N("preview")},k=async()=>{const r=re.filter(u=>u.isValid);if(r.length===0){oe({title:"No Valid Products",description:"Please fix validation errors before proceeding",variant:"destructive"});return}N("processing"),J({processed:0,total:r.length,successful:0,failed:0,isProcessing:!0});const l=[];let n=0;for(let u=0;u<r.length;u+=tt){const j=r.slice(u,u+tt);try{const y=j.map(c=>({name:c.name,description:c.description||"",price:c.price,quantity:c.quantity,listingType:c.listingType||"buy_now",status:"inactive",colors:c.colors||[],sizes:c.sizes||[],featured:c.featured||!1}));if(console.log(`Uploading batch ${Math.floor(u/tt)+1} with ${y.length} products`),!(xe!=null&&xe.id))throw new Error("User authentication required");const g=await(await ke("POST",`/api/products/bulkadd/${xe.id}`,{products:y})).json(),b=g.successful||j.length,O=g.failed||0;n+=b,O>0&&g.errors&&g.errors.forEach((c,q)=>{const M=u+q;M<j.length&&l.push({row:j[M].rowIndex,error:c.message||"Failed to create product",data:j[M]})}),J(c=>({...c,processed:c.processed+j.length,successful:c.successful+b,failed:c.failed+O}))}catch(y){console.error("Batch upload error:",y),j.forEach(P=>{l.push({row:P.rowIndex,error:y.message||"Batch upload failed",data:P})}),J(P=>({...P,processed:P.processed+j.length,failed:P.failed+j.length}))}}ce(l),J(u=>({...u,isProcessing:!1})),N("complete"),_e.invalidateQueries({queryKey:["external-products"]}),oe({title:"Upload Complete",description:`${n} products uploaded successfully${l.length>0?`, ${l.length} failed`:""}`,variant:n>0?"default":"destructive"})},$=()=>{if(ie.length===0)return;const r=ie.map(y=>({row:y.row,error:y.error,name:y.data.name,price:y.data.price,quantity:y.data.quantity})),l=et.unparse(r),n=new Blob([l],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),j=URL.createObjectURL(n);u.setAttribute("href",j),u.setAttribute("download","upload_errors.csv"),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)},d=re.filter(r=>r.isValid).length,I=re.length-d;return e.jsx(Ae,{open:x,onOpenChange:T,children:e.jsxs(Te,{className:"max-w-6xl max-h-[90vh] overflow-y-auto","data-testid":"dialog-csv-upload",children:[e.jsxs(De,{children:[e.jsxs(Re,{className:"flex items-center gap-2","data-testid":"text-csv-upload-title",children:[e.jsx(yt,{className:"h-5 w-5"}),"Bulk Product Upload"]}),e.jsx(Ue,{children:"Upload products in bulk using a CSV file. Download our template to get started."})]}),e.jsxs(ts,{value:v,className:"w-full",children:[e.jsx("div",{className:"w-full overflow-x-auto pb-2",children:e.jsxs(ss,{className:"inline-flex w-full min-w-max sm:w-full sm:min-w-0 sm:grid sm:grid-cols-3 lg:grid-cols-5",children:[e.jsx(qe,{value:"upload",disabled:v!=="upload","data-testid":"tab-upload",className:"flex-shrink-0 sm:flex-shrink",children:"Upload"}),e.jsx(qe,{value:"mapping",disabled:v==="upload","data-testid":"tab-mapping",className:"flex-shrink-0 sm:flex-shrink",children:"Mapping"}),e.jsx(qe,{value:"preview",disabled:!["preview","processing","complete"].includes(v),"data-testid":"tab-preview",className:"flex-shrink-0 sm:flex-shrink",children:"Preview"}),e.jsx(qe,{value:"processing",disabled:v!=="processing","data-testid":"tab-processing",className:"flex-shrink-0 sm:flex-shrink",children:"Processing"}),e.jsx(qe,{value:"complete",disabled:v!=="complete","data-testid":"tab-complete",className:"flex-shrink-0 sm:flex-shrink",children:"Complete"})]})}),e.jsxs(Me,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Upload CSV File"}),e.jsxs(z,{variant:"outline",onClick:s,"data-testid":"button-download-template",children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),e.jsx(be,{children:e.jsx(Oe,{className:"pt-6",children:e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${me?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,onDrop:w,onDragOver:K,onDragLeave:te,"data-testid":"drop-zone-csv",children:[e.jsx(as,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Drop your CSV file here"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"or click to browse your files"}),e.jsx(z,{onClick:()=>{var r;return(r=se.current)==null?void 0:r.click()},"data-testid":"button-browse-files",children:"Browse Files"}),e.jsx("input",{ref:se,type:"file",accept:".csv",onChange:p,className:"hidden","data-testid":"input-file-csv"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Maximum file size: 5MB. CSV format only."})]})})})]}),e.jsxs(Me,{value:"mapping",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Map CSV Columns to Product Fields"}),e.jsx("p",{className:"text-muted-foreground",children:"Match your CSV columns to the correct product fields."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map(r=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(es,{children:['CSV Column: "',r,'"']}),e.jsxs(Ce,{value:f[r]||"skip",onValueChange:l=>Y(n=>({...n,[r]:l==="skip"?"":l})),"data-testid":`select-mapping-${r}`,children:[e.jsx(Se,{children:e.jsx(Pe,{placeholder:"Select product field"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"skip",children:e.jsx("span",{className:"text-muted-foreground",children:"Skip this column"})}),Object.entries(Ke).map(([l,n])=>e.jsx(W,{value:l,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:n.label}),n.required&&e.jsx(je,{variant:"destructive",className:"text-xs",children:"Required"})]})},l))]})]})]},r))}),e.jsxs(Gt,{children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsxs(Xt,{children:["Make sure to map all required fields: ",pt.join(", ")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(z,{variant:"outline",onClick:()=>N("upload"),"data-testid":"button-back-to-upload",children:"Back"}),e.jsx(z,{onClick:m,"data-testid":"button-continue-to-preview",children:"Continue to Preview"})]})]}),e.jsxs(Me,{value:"preview",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Preview & Validate"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your data before uploading. Fix any validation errors below."})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:[d," Valid"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{children:[I," Invalid"]})]})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded-lg",children:e.jsxs(Jt,{children:[e.jsx(Zt,{children:e.jsxs(lt,{children:[e.jsx(Fe,{children:"Row"}),e.jsx(Fe,{children:"Status"}),e.jsx(Fe,{children:"Name"}),e.jsx(Fe,{children:"Price"}),e.jsx(Fe,{children:"Quantity"}),e.jsx(Fe,{children:"Errors"})]})}),e.jsx(Yt,{children:re.map(r=>e.jsxs(lt,{"data-testid":`row-product-${r.rowIndex}`,children:[e.jsx(Le,{children:r.rowIndex}),e.jsx(Le,{children:r.isValid?e.jsx(He,{className:"h-4 w-4 text-green-600"}):e.jsx(Ze,{className:"h-4 w-4 text-red-600"})}),e.jsx(Le,{children:r.name||"N/A"}),e.jsx(Le,{children:r.price>0?`$${r.price}`:"N/A"}),e.jsx(Le,{children:r.quantity>0?r.quantity:"N/A"}),e.jsx(Le,{children:r.errors.length>0&&e.jsx("div",{className:"space-y-1",children:r.errors.map((l,n)=>e.jsx(je,{variant:"destructive",className:"text-xs block w-fit",children:l},n))})})]},r.rowIndex))})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(z,{variant:"outline",onClick:()=>N("mapping"),"data-testid":"button-back-to-mapping",children:"Back to Mapping"}),e.jsxs(z,{onClick:k,disabled:d===0,"data-testid":"button-start-upload",children:["Upload ",d," Products"]})]})]}),e.jsxs(Me,{value:"processing",className:"space-y-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Ut,{className:"h-12 w-12 animate-spin mx-auto"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Processing Upload..."}),e.jsx("p",{className:"text-muted-foreground",children:"Uploading products in batches. Please don't close this window."})]}),e.jsx(be,{children:e.jsx(Oe,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[G.processed," / ",G.total]})]}),e.jsx(Ct,{value:G.processed/G.total*100,className:"w-full","data-testid":"progress-upload"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Successful: ",G.successful]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{children:["Failed: ",G.failed]})]})]})]})})})]}),e.jsxs(Me,{value:"complete",className:"space-y-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(He,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Upload Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your products have been processed."})]}),e.jsx(be,{children:e.jsx(Oe,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:G.successful}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Successful"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:G.failed}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Failed"})]})]})})}),ie.length>0&&e.jsxs(be,{children:[e.jsx(Mt,{children:e.jsxs(zt,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"h-5 w-5 text-yellow-600"}),"Upload Errors"]})}),e.jsxs(Oe,{children:[e.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[ie.slice(0,5).map((r,l)=>e.jsxs("div",{className:"text-sm text-red-600",children:["Row ",r.row,": ",r.error]},l)),ie.length>5&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["... and ",ie.length-5," more errors"]})]}),e.jsxs(z,{variant:"outline",onClick:$,className:"mt-4","data-testid":"button-download-errors",children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),"Download Error Report"]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(z,{variant:"outline",onClick:ne,"data-testid":"button-upload-more",children:"Upload More Products"}),e.jsx(z,{onClick:()=>{H(),T()},"data-testid":"button-done",children:"Done"})]})]})]})]})})}const mt={active:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",inactive:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",out_of_stock:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",draft:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"},ft={active:1,out_of_stock:2,draft:3,inactive:4};function la(){const[x,D]=C.useState(""),[H,v]=C.useState(""),[N,X]=C.useState("all"),[F,R]=C.useState("all"),[U,f]=C.useState("all"),[Y,re]=C.useState("name"),[ee,G]=C.useState(1),[J,ie]=C.useState(20);C.useEffect(()=>{const t=setTimeout(()=>{v(x)},500);return()=>clearTimeout(t)},[x]);const[ce,me]=C.useState(!1),[S,se]=C.useState(new Set),[xe,oe]=C.useState(!1),[ne,T]=C.useState(!1),[s,a]=C.useState(!1),[i,h]=C.useState(!1),[p,w]=C.useState(!1),[K,te]=C.useState(!1),[m,k]=C.useState({updateCategory:!1,updateShipping:!1,updateStatus:!1,updatePrice:!1,updateInventory:!1,categoryId:"",shippingProfileId:"",status:"",priceAmount:"",inventoryAmount:""}),[,$]=$t(),{user:d}=xt(),{toast:I}=gt(),{data:r,isLoading:l,error:n,isError:u,refetch:j}=Xe({queryKey:["external-products",d==null?void 0:d.id,N,F,U,H,ee,J],queryFn:async()=>{const t=new URLSearchParams;d!=null&&d.id&&t.set("userId",d.id),N&&N!=="all"&&t.set("status",N),F&&F!=="all"&&t.set("categoryId",F),U&&U!=="all"&&t.set("saletype",U),H&&t.set("title",H),t.set("type","inventory"),t.set("page",ee.toString()),t.set("limit",J.toString());const o=await fetch(`/api/products?${t.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`External API error: ${o.status}`);return o.json()},enabled:!!(d!=null&&d.id),staleTime:0,gcTime:0}),{data:y}=Xe({queryKey:["external-categories"],queryFn:async()=>{const t=await fetch("/api/categories");if(!t.ok)throw new Error("Failed to fetch categories");return t.json()}}),P=t=>{const o=[];return t.forEach(B=>{o.push(B),B.subCategories&&B.subCategories.length>0&&B.subCategories.forEach(fe=>{o.push({...fe,name:`${B.name} > ${fe.name}`})})}),o},{data:g,error:b,isLoading:O}=Xe({queryKey:["shipping-profiles",d==null?void 0:d.id],queryFn:async()=>{const t=await fetch(`/api/shipping/profiles/${d==null?void 0:d.id}`);if(!t.ok)throw new Error("Failed to fetch shipping profiles");return t.json()},enabled:!!(d!=null&&d.id)}),c=qt({mutationFn:async t=>await ke("PUT",`/api/products/${t}/delete`,{}),onSuccess:()=>{_e.invalidateQueries({queryKey:["external-products"]}),I({title:"Product deleted successfully"})},onError:()=>{I({title:"Failed to delete product",variant:"destructive"})}}),q=t=>{$(`/edit-product/${t._id}`)},M=(t,o)=>{confirm(`Are you sure you want to delete "${o}"? This action cannot be undone.`)&&c.mutate(t)},A=t=>{$(`/product/${t._id}`)},L=()=>{$("/add-product")},E=()=>{me(!0)},de=()=>{j()},_=(t,o)=>{se(B=>{const fe=new Set(B);return o?fe.add(t):fe.delete(t),fe})},V=t=>{const o=(r==null?void 0:r.products)||[];se(t?new Set(o.map(B=>B._id)):new Set)},ge=()=>{se(new Set)},we=async t=>{if(S.size!==0)try{const o=Array.from(S);if((await ke("PUT","/api/products/bulkedit",{productIds:o,updates:{category:t,status:"active"}})).ok)await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),I({title:"Success",description:`Category assigned to ${o.length} products`});else throw new Error("Failed to assign category")}catch{I({title:"Error",description:"Failed to assign category to products",variant:"destructive"})}},ue=async t=>{if(S.size!==0)try{const o=Array.from(S);if((await ke("PUT","/api/products/bulkedit",{productIds:o,updates:{shippingProfile:t,status:"active"}})).ok)await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),I({title:"Success",description:`Shipping profile assigned to ${o.length} products`});else throw new Error("Failed to assign shipping profile")}catch{I({title:"Error",description:"Failed to assign shipping profile to products",variant:"destructive"})}},ye=async t=>{if(S.size!==0)try{const o=Array.from(S);if((await ke("PUT","/api/products/bulkedit",{productIds:o,updates:{priceUpdate:t}})).ok)await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),I({title:"Success",description:`Prices updated for ${o.length} products`});else throw new Error("Failed to update prices")}catch{I({title:"Error",description:"Failed to update product prices",variant:"destructive"})}},ae=async t=>{if(S.size!==0)try{const o=Array.from(S);if((await ke("PUT","/api/products/bulkedit",{productIds:o,updates:{status:t}})).ok)await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),I({title:"Success",description:`Status updated to ${t} for ${o.length} products`});else throw new Error("Failed to update status")}catch{I({title:"Error",description:"Failed to update product status",variant:"destructive"})}},le=async t=>{if(S.size!==0)try{const o=Array.from(S);if((await ke("PUT","/api/products/bulkedit",{productIds:o,updates:{inventoryUpdate:t}})).ok)await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),I({title:"Success",description:`Inventory updated for ${o.length} products`});else throw new Error("Failed to update inventory")}catch{I({title:"Error",description:"Failed to update product inventory",variant:"destructive"})}},Q=(t,o)=>{k(B=>({...B,[t]:o,...t==="updateCategory"&&!o&&{categoryId:""},...t==="updateShipping"&&!o&&{shippingProfileId:""},...t==="updateStatus"&&!o&&{status:""},...t==="updatePrice"&&!o&&{priceAmount:""},...t==="updateInventory"&&!o&&{inventoryAmount:""}}))},Z=(t,o)=>{k(B=>({...B,[t]:o}))},he=()=>{k({updateCategory:!1,updateShipping:!1,updateStatus:!1,updatePrice:!1,updateInventory:!1,categoryId:"",shippingProfileId:"",status:"",priceAmount:"",inventoryAmount:""})},$e=async()=>{if(S.size!==0)try{const t=Array.from(S),o={};if(m.updateCategory&&m.categoryId&&(o.category=m.categoryId),m.updateShipping&&m.shippingProfileId&&(o.shippingProfile=m.shippingProfileId),m.updateStatus&&m.status&&(o.status=m.status),m.updatePrice&&m.priceAmount!==""&&(o.price=Number(m.priceAmount)),m.updateInventory&&m.inventoryAmount!==""&&(o.quantity=Number(m.inventoryAmount)),Object.keys(o).length===0){I({title:"No Updates Selected",description:"Please select at least one field to update",variant:"destructive"});return}if((await ke("PUT","/api/products/bulkedit",{productIds:t,updates:o})).ok){await _e.invalidateQueries({queryKey:["external-products"]}),se(new Set),te(!1),he();const fe=Object.keys(o).length;I({title:"Success",description:`${fe} field${fe>1?"s":""} updated for ${t.length} products`})}else throw new Error("Failed to update products")}catch{I({title:"Error",description:"Failed to update products",variant:"destructive"})}},ze=()=>{const t=m.updateCategory||m.updateShipping||m.updateStatus||m.updatePrice||m.updateInventory,o=(!m.updateCategory||m.categoryId)&&(!m.updateShipping||m.shippingProfileId)&&(!m.updateStatus||m.status)&&(!m.updatePrice||m.priceAmount!==""&&!isNaN(Number(m.priceAmount))&&Number(m.priceAmount)>=0)&&(!m.updateInventory||m.inventoryAmount!==""&&!isNaN(Number(m.inventoryAmount))&&Number(m.inventoryAmount)>=0);return t&&o},Ne=t=>{G(t)},pe=t=>{ie(t),G(1)},ve=()=>{G(1)},Be=t=>{X(t),ve()},St=t=>{R(t),ve()},Pt=t=>{f(t),ve()},Et=t=>{re(t),ve()},We=(r==null?void 0:r.products)||[],rt=(r==null?void 0:r.totalDoc)||0,It=(r==null?void 0:r.pages)||0,Ge=y!=null&&y.categories?P(y.categories):[],Ve=(We==null?void 0:We.filter(t=>{var B;return x===""||t.name.toLowerCase().includes(x.toLowerCase())||((B=t.description)==null?void 0:B.toLowerCase().includes(x.toLowerCase()))}).sort((t,o)=>{switch(Y){case"newest":return new Date(o.createdAt||"").getTime()-new Date(t.createdAt||"").getTime();case"oldest":return new Date(t.createdAt||"").getTime()-new Date(o.createdAt||"").getTime();case"name":return t.name.localeCompare(o.name);case"price-high":return o.price-t.price;case"price-low":return t.price-o.price;case"quantity-high":return o.quantity-t.quantity;case"quantity-low":return t.quantity-o.quantity;case"status":return(ft[t.status]||99)-(ft[o.status]||99);default:return 0}}))||[],At=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),it=t=>{const o=mt[t]||mt.draft;return e.jsx(je,{variant:"secondary",className:o,children:(t==null?void 0:t.replace("_"," ").toUpperCase())||"UNKNOWN"})},Tt=t=>{const o=t.auction;return o?o.ended===!0?e.jsx(je,{variant:"secondary",className:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400",children:"ENDED"}):e.jsx(je,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",children:"ACTIVE"}):it(t.status||"draft")};return u?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Inventory"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your product inventory"})]})}),e.jsxs(be,{className:"p-8 text-center",children:[e.jsx(Ye,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Unable to load inventory"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:(n==null?void 0:n.message)||"There was an error loading your products. Please try again."}),e.jsx(z,{onClick:()=>j(),"data-testid":"button-retry-products",children:"Try Again"})]})]}):e.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6","data-testid":"page-inventory",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:justify-between sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-foreground","data-testid":"text-page-title",children:"Inventory"}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground","data-testid":"text-page-description",children:["Manage your product inventory (",rt," products)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{variant:"outline",onClick:E,"data-testid":"button-bulk-upload",className:"flex-1 sm:flex-none",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Bulk Upload"}),e.jsx("span",{className:"sm:hidden",children:"Upload"})]}),e.jsxs(z,{onClick:L,"data-testid":"button-add-product",className:"flex-1 sm:flex-none",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Product"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(Bt,{placeholder:"Search products...",value:x,onChange:t=>D(t.target.value),className:"pl-10","data-testid":"input-search-products"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs(Ce,{value:N,onValueChange:Be,children:[e.jsx(Se,{className:"w-full","data-testid":"select-status-filter",children:e.jsx(Pe,{placeholder:"Status"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"}),e.jsx(W,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(W,{value:"draft",children:"Draft"})]})]}),e.jsxs(Ce,{value:F,onValueChange:St,children:[e.jsx(Se,{className:"w-full","data-testid":"select-category-filter",children:e.jsx(Pe,{placeholder:"Category"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"all",children:"All Categories"}),Ge.map(t=>e.jsx(W,{value:t._id,children:t.name},t._id))]})]}),e.jsxs(Ce,{value:Y,onValueChange:Et,children:[e.jsx(Se,{className:"w-full","data-testid":"select-sort",children:e.jsx(Pe,{placeholder:"Sort by"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"name",children:"Name"}),e.jsx(W,{value:"price-high",children:"Price: High to Low"}),e.jsx(W,{value:"price-low",children:"Price: Low to High"}),e.jsx(W,{value:"quantity-high",children:"Stock: High to Low"}),e.jsx(W,{value:"quantity-low",children:"Stock: Low to High"}),e.jsx(W,{value:"status",children:"Status"})]})]}),e.jsxs(Ce,{value:U,onValueChange:Pt,children:[e.jsx(Se,{className:"w-full","data-testid":"select-listing-type-filter",children:e.jsx(Pe,{placeholder:"Listing Type"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"all",children:"All Types"}),e.jsx(W,{value:"auction",children:"Auction"}),e.jsx(W,{value:"buy_now",children:"Buy Now"})]})]})]})]}),S.size>0&&e.jsx(be,{className:"border-primary/20 bg-primary/5",children:e.jsx(Oe,{className:"py-3 md:py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:[S.size," product",S.size>1?"s":""," selected"]}),e.jsx(z,{variant:"outline",size:"sm",onClick:ge,"data-testid":"button-clear-selection",className:"self-start",children:"Clear Selection"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(z,{variant:"default",size:"sm",onClick:()=>te(!0),"data-testid":"button-bulk-edit",className:"flex-1 sm:flex-none",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Bulk Edit"]})})]})})}),l?e.jsx(be,{children:e.jsx(Oe,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-2 md:p-4 font-medium w-10 md:w-12 text-xs md:text-sm"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Details"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Channel"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Type"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Price"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Stock"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Status"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:Array.from({length:5}).map((t,o)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-4 w-4 bg-muted animate-pulse rounded"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-muted animate-pulse rounded flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-32 md:w-48"}),e.jsx("div",{className:"h-3 bg-muted animate-pulse rounded w-24 md:w-32"}),e.jsx("div",{className:"h-5 bg-muted animate-pulse rounded w-20 md:w-24"})]})]})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-5 bg-muted animate-pulse rounded w-16 md:w-20"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-5 bg-muted animate-pulse rounded w-16 md:w-20"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-14 md:w-16"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-10 md:w-12"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-5 bg-muted animate-pulse rounded w-16 md:w-20"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded w-8"})})]},o))})]})})})}):Ve.length===0?e.jsxs(be,{className:"p-8 text-center",children:[e.jsx(Ye,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No products found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:x||N!=="all"||F!=="all"?"Try adjusting your search or filters to find products.":"Get started by adding your first product to your inventory."}),!x&&N==="all"&&F==="all"&&e.jsxs(z,{onClick:L,"data-testid":"button-add-first-product",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Add Your First Product"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{children:e.jsx(Oe,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-2 md:p-4 font-medium w-10 md:w-12",children:e.jsx(Ie,{checked:S.size===Ve.length&&Ve.length>0,onCheckedChange:V,"data-testid":"checkbox-select-all"})}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm w-[250px] md:w-[300px] max-w-[300px]",children:"Details"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Channel"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Type"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Price"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Stock"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Status"}),e.jsx("th",{className:"text-left p-2 md:p-4 font-medium text-xs md:text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:Ve.map((t,o)=>{var B;return e.jsxs("tr",{className:`border-b hover:bg-muted/20 ${o%2===0?"bg-background":"bg-muted/10"} ${S.has(t._id)?"bg-primary/10":""} ${t.status==="draft"?"opacity-75 border-l-4 border-l-orange-300":""}`,"data-testid":`row-product-${t._id}`,children:[e.jsx("td",{className:"p-2 md:p-4",children:e.jsx(Ie,{checked:S.has(t._id),onCheckedChange:fe=>_(t._id,fe),"data-testid":`checkbox-product-${t._id}`})}),e.jsx("td",{className:"p-2 md:p-4 w-[250px] md:w-[300px] max-w-[300px]",children:e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-muted rounded overflow-hidden flex-shrink-0",children:t.images&&t.images.length>0?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover","data-testid":`img-product-${t._id}`}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ye,{className:"h-5 w-5 md:h-6 md:w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden space-y-1",children:[e.jsx("div",{className:"font-medium text-sm md:text-base text-foreground truncate","data-testid":`text-product-name-${t._id}`,children:t.name}),t.description&&e.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-full","data-testid":`text-product-description-${t._id}`,children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(je,{variant:"outline",className:"text-xs","data-testid":`badge-product-category-${t._id}`,children:((B=t.category)==null?void 0:B.name)||"Uncategorized"}),t.sku&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["SKU: ",t.sku]})]})]})]})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx(je,{variant:t.featured===!0?"default":t.tokshow?"secondary":"outline",className:"text-xs whitespace-nowrap","data-testid":`badge-product-location-${t._id}`,children:t.featured===!0?"Marketplace":t.tokshow?"Show":"N/A"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsx(je,{variant:t.listing_type==="auction"?"default":t.listing_type==="giveaway"?"outline":"secondary",className:"text-xs whitespace-nowrap","data-testid":`badge-product-type-${t._id}`,children:t.listing_type==="auction"?"Auction":t.listing_type==="giveaway"?"Giveaway":"Buy Now"})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsxs("div",{className:"flex flex-col",children:[t.listing_type==="auction"&&e.jsx("span",{className:"text-xs text-muted-foreground mb-0.5",children:"Starting Price"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-foreground whitespace-nowrap","data-testid":`text-product-price-${t._id}`,children:At(t.price)})]})}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsxs("div",{className:"flex items-center space-x-1 md:space-x-2",children:[e.jsx("span",{className:`font-medium text-xs md:text-sm ${t.quantity===0?"text-destructive":t.quantity<=10?"text-yellow-600 dark:text-yellow-400":"text-foreground"}`,"data-testid":`text-product-quantity-${t._id}`,children:t.quantity}),t.quantity===0&&e.jsx(je,{variant:"destructive",className:"text-xs px-1.5 py-0.5","data-testid":`badge-out-of-stock-${t._id}`,children:"Out"}),t.quantity>0&&t.quantity<=10&&e.jsx(je,{variant:"outline",className:"text-xs px-1.5 py-0.5 border-yellow-300 text-yellow-700 dark:text-yellow-400","data-testid":`badge-low-stock-${t._id}`,children:"Low"})]})}),e.jsx("td",{className:"p-2 md:p-4",children:t.listing_type==="auction"?Tt(t):it(t.status||"draft")}),e.jsx("td",{className:"p-2 md:p-4",children:e.jsxs(Vt,{children:[e.jsx(Ht,{asChild:!0,children:e.jsx(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","data-testid":`button-product-actions-${t._id}`,children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(Kt,{align:"end",children:[e.jsxs(Je,{onClick:()=>A(t),children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(Je,{onClick:()=>q(t),children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Edit Product"]}),e.jsx(Qt,{}),e.jsx(Je,{onClick:()=>M(t._id,t.name),className:"text-destructive",disabled:c.isPending,children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"mr-2 h-4 w-4"}),"Delete"]})})]})]})})]},t._id)})})]})})})}),e.jsx(Wt,{currentPage:ee,totalPages:It,totalItems:rt,itemsPerPage:J,itemsPerPageOptions:[10,20,50,100],onPageChange:Ne,onItemsPerPageChange:pe,showingText:"products",className:"bg-white dark:bg-gray-950 rounded-lg border p-4"})]}),e.jsx(ks,{isOpen:ce,onClose:()=>me(!1),onSuccess:de}),xe&&e.jsx(Ae,{open:xe,onOpenChange:oe,children:e.jsxs(Te,{className:"max-w-md",children:[e.jsxs(De,{children:[e.jsx(Re,{children:"Assign Category"}),e.jsxs(Ue,{children:["Choose a category to assign to ",S.size," selected product",S.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:Ge.map(t=>e.jsx(z,{variant:"outline",className:"w-full justify-start",onClick:()=>{we(t._id),oe(!1)},"data-testid":`button-select-category-${t._id}`,children:t.name},t._id))})]})}),ne&&e.jsx(Ae,{open:ne,onOpenChange:T,children:e.jsxs(Te,{className:"max-w-md",children:[e.jsxs(De,{children:[e.jsx(Re,{children:"Assign Shipping Profile"}),e.jsxs(Ue,{children:["Choose a shipping profile to assign to ",S.size," selected product",S.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:g==null?void 0:g.map(t=>e.jsx(z,{variant:"outline",className:"w-full justify-start",onClick:()=>{ue(t._id),T(!1)},"data-testid":`button-select-shipping-${t._id}`,children:t.name},t._id))})]})}),s&&e.jsx(Ae,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"max-w-md",children:[e.jsxs(De,{children:[e.jsx(Re,{children:"Update Prices"}),e.jsxs(Ue,{children:["Update prices for ",S.size," selected product",S.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Increase price by what percentage?","10");t&&!isNaN(Number(t))&&(ye({type:"increase",amount:Number(t),isPercentage:!0}),a(!1))},"data-testid":"button-price-increase-percent",children:"Increase by %"}),e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease price by what percentage?","10");t&&!isNaN(Number(t))&&(ye({type:"decrease",amount:Number(t),isPercentage:!0}),a(!1))},"data-testid":"button-price-decrease-percent",children:"Decrease by %"}),e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Increase price by what amount?","5.00");t&&!isNaN(Number(t))&&(ye({type:"increase",amount:Number(t),isPercentage:!1}),a(!1))},"data-testid":"button-price-increase-amount",children:"Increase by $"}),e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease price by what amount?","5.00");t&&!isNaN(Number(t))&&(ye({type:"decrease",amount:Number(t),isPercentage:!1}),a(!1))},"data-testid":"button-price-decrease-amount",children:"Decrease by $"})]})})]})}),i&&e.jsx(Ae,{open:i,onOpenChange:h,children:e.jsxs(Te,{className:"max-w-md",children:[e.jsxs(De,{children:[e.jsx(Re,{children:"Update Status"}),e.jsxs(Ue,{children:["Set status for ",S.size," selected product",S.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:["active","inactive","draft"].map(t=>e.jsxs(z,{variant:"outline",className:"w-full justify-start capitalize",onClick:()=>{ae(t),h(!1)},"data-testid":`button-set-status-${t}`,children:["Set to ",t]},t))})]})}),p&&e.jsx(Ae,{open:p,onOpenChange:w,children:e.jsxs(Te,{className:"max-w-md",children:[e.jsxs(De,{children:[e.jsx(Re,{children:"Update Inventory"}),e.jsxs(Ue,{children:["Update inventory for ",S.size," selected product",S.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Set inventory to what price?","100");t&&!isNaN(Number(t))&&Number(t)>=0&&(le({type:"set",amount:Number(t)}),w(!1))},"data-testid":"button-inventory-set",children:"Set Quantity"}),e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Increase inventory by what price?","10");t&&!isNaN(Number(t))&&(le({type:"increase",amount:Number(t)}),w(!1))},"data-testid":"button-inventory-increase",children:"Increase Quantity"}),e.jsx(z,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease inventory by what price?","10");t&&!isNaN(Number(t))&&(le({type:"decrease",amount:Number(t)}),w(!1))},"data-testid":"button-inventory-decrease",children:"Decrease Quantity"})]})})]})}),K&&e.jsx(Ae,{open:K,onOpenChange:te,children:e.jsxs(Te,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(De,{children:[e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"h-5 w-5"}),"Bulk Edit Products"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Update ",S.size," selected products"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:"update-category",checked:m.updateCategory,onCheckedChange:t=>Q("updateCategory",t),"data-testid":"checkbox-update-category"}),e.jsx("label",{htmlFor:"update-category",className:"text-sm font-medium",children:"Update Category"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(Ce,{value:m.categoryId,onValueChange:t=>Z("categoryId",t),disabled:!m.updateCategory,children:[e.jsx(Se,{"data-testid":"select-bulk-category",children:e.jsx(Pe,{placeholder:"Select category"})}),e.jsx(Ee,{children:Ge.map(t=>e.jsx(W,{value:t._id,children:t.name},t._id))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:"update-shipping",checked:m.updateShipping,onCheckedChange:t=>Q("updateShipping",t),"data-testid":"checkbox-update-shipping"}),e.jsx("label",{htmlFor:"update-shipping",className:"text-sm font-medium",children:"Update Shipping Profile"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(Ce,{value:m.shippingProfileId,onValueChange:t=>Z("shippingProfileId",t),disabled:!m.updateShipping,children:[e.jsx(Se,{"data-testid":"select-bulk-shipping",children:e.jsx(Pe,{placeholder:"Select shipping profile"})}),e.jsx(Ee,{children:g==null?void 0:g.map(t=>e.jsx(W,{value:t._id,children:t.name},t._id))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:"update-status",checked:m.updateStatus,onCheckedChange:t=>Q("updateStatus",t),"data-testid":"checkbox-update-status"}),e.jsx("label",{htmlFor:"update-status",className:"text-sm font-medium",children:"Update Status"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(Ce,{value:m.status,onValueChange:t=>Z("status",t),disabled:!m.updateStatus,children:[e.jsx(Se,{"data-testid":"select-bulk-status",children:e.jsx(Pe,{placeholder:"Select status"})}),e.jsxs(Ee,{children:[e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"out_of_stock",children:"Out of Stock"})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:"update-price",checked:m.updatePrice,onCheckedChange:t=>Q("updatePrice",t),"data-testid":"checkbox-update-price"}),e.jsx("label",{htmlFor:"update-price",className:"text-sm font-medium",children:"Update Price"})]}),e.jsx("div",{className:"ml-6",children:e.jsx("input",{type:"number",placeholder:"Price",value:m.priceAmount,onChange:t=>Z("priceAmount",t.target.value),className:"flex h-10 w-32 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:!m.updatePrice,"data-testid":"input-price-amount"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{id:"update-inventory",checked:m.updateInventory,onCheckedChange:t=>Q("updateInventory",t),"data-testid":"checkbox-update-inventory"}),e.jsx("label",{htmlFor:"update-inventory",className:"text-sm font-medium",children:"Update Inventory"})]}),e.jsx("div",{className:"ml-6",children:e.jsx("input",{type:"number",placeholder:"Quantity",value:m.inventoryAmount,onChange:t=>Z("inventoryAmount",t.target.value),className:"flex h-10 w-32 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:!m.updateInventory,"data-testid":"input-inventory-amount"})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[S.size," products will be updated"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",onClick:()=>{te(!1),he()},"data-testid":"button-bulk-edit-cancel",children:"Cancel"}),e.jsx(z,{disabled:!ze(),onClick:$e,"data-testid":"button-bulk-edit-submit",children:"Update Products"})]})]})]})})]})}export{la as default};
