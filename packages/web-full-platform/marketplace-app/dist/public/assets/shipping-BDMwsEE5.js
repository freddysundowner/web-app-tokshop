import{c as Re,j as e,r as u,e as Ye,G as Na,H as xr,I as Rt,J as Ua,R as Ha,K as Ka,M as gr,N as Rs,P as Ls,O as ne,Q as Ws,S as zs,U as vr,V as yr,W as jr,Y as br,Z as Nr,_ as Ya,$ as Va,a0 as Qa,B as O,g as Ga,a1 as Ja,d as Ue,y as wr,a as Cr,X as wa,A as Ca,h as _a,i as ka,k as Sa,l as Da,m as Pa,n as Oa,o as Ma,a2 as _r}from"./index-GnvmivW0.js";import{u as ae}from"./useMutation-DAKVWGzI.js";import{C as Q,a as He,c as Ke,b as G,e as kr}from"./card-Bsqf9o7h.js";import{B as Qe}from"./badge-CL9MXKGS.js";import{C as pt}from"./checkbox-ZrZ7F-Dx.js";import{I as mt}from"./input-CDJz7BeV.js";import{S as Ds,a as Ps,b as Os,c as Ms,d as ve}from"./select-EUq1_viI.js";import{t as K,c as ft,g as Fa,m as Sr,a as Dr,e as Pr}from"./en-US-Cc-9gH5A.js";import{e as Bs,d as xt,a as Ia}from"./endOfMonth-DAoz7cdb.js";import{s as gt,a as It,d as Fe,f as Z,b as Or,c as qs,g as Mr,e as Fr,i as Za}from"./format-Crz72tIO.js";import{a as J,i as re}from"./isSameDay-bd8GA9bu.js";import{C as Xa}from"./chevron-right-CXw-mF7y.js";import{C as Ir}from"./chevron-left-BnuQCvWV.js";import{S as Us,e as Tr,a as Hs,b as Ks,c as Ys,d as Er}from"./sheet-D5QVNRkq.js";import{L as $e}from"./label-CbaFYhHW.js";import{S as Ve}from"./separator-Datc7ShZ.js";import{C as Ar,a as $r,b as Rr,A as dt}from"./collapsible-B-insiOQ.js";import{D as Ze,a as Xe,b as et,c as tt,d as vt,e as Tt,f as Lr}from"./dialog-D1L4tMGI.js";import{A as Wr,a as zr}from"./alert-BCAR44i4.js";import{I as Fs}from"./info-C2t8FPuk.js";import{U as Ta}from"./users-S9Kp6t2T.js";import{P as en}from"./package-DWwkENv3.js";import{C as tn}from"./chevron-down-tcDKR_mK.js";import{R as Br,C as ps}from"./refresh-cw-DXFTvLUy.js";import{T as Vs}from"./truck-DP2GNOS8.js";import{P as Is}from"./printer-Cmv9hO84.js";import{P as ht}from"./package-2-BB60Ci35.js";import{D as Qs}from"./download-D9C51OkM.js";import{M as qr}from"./map-pin-Dn0fBe7g.js";import{F as Ur}from"./file-text-CoItu-Vz.js";import{D as fs,a as xs,b as gs,c as me,d as Ea}from"./dropdown-menu-B2qYf86A.js";import{T as Hr}from"./textarea-DkmXbh6O.js";import{S as Kr}from"./switch-C_scnTkE.js";import{C as Yr}from"./pagination-COmJENkB.js";import{C as Aa}from"./calendar-Cp1BJUQ9.js";import{E as Mt}from"./eye-MrtS8r4d.js";import{E as vs}from"./ellipsis-CgHIMWzm.js";import{C as ys}from"./circle-check-big-CLZG244L.js";import"./index-Vue-pIA6.js";import"./check-DoxmrmEj.js";import"./index-BdQq_4o_.js";import"./index-CmYyiKyk.js";import"./chevron-up-Cda9uppk.js";import"./index-BUngnxKp.js";import"./index-kVvGtud3.js";import"./circle-iUglX5Df.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Re("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=Re("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=Re("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Re("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=Re("PanelRightOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=Re("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=Re("Ship",[["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"iegodh"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76",key:"fp8vka"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M12 10v4",key:"1kjpxc"}],["path",{d:"M12 2v3",key:"qbqxhf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=Re("Unlink2",[["path",{d:"M15 7h2a5 5 0 0 1 0 10h-2m-6 0H7A5 5 0 0 1 7 7h2",key:"1re2ne"}]]);function ye(t,a){const s=K(t);if(isNaN(a))return ft(t,NaN);if(!a)return s;const r=s.getDate(),i=ft(t,s.getTime());i.setMonth(s.getMonth()+a+1,0);const l=i.getDate();return r>=l?i:(s.setFullYear(i.getFullYear(),i.getMonth(),r),s)}function Ts(t,a){const s=a*7;return J(t,s)}function Xr(t,a){return ye(t,a*12)}function ei(t){let a;return t.forEach(function(s){const r=K(s);(a===void 0||a<r||isNaN(Number(r)))&&(a=r)}),a||new Date(NaN)}function ti(t){let a;return t.forEach(s=>{const r=K(s);(!a||a>r||isNaN(+r))&&(a=r)}),a||new Date(NaN)}function si(t,a,s){const r=gt(t,s),i=gt(a,s),l=+r-Fa(r),o=+i-Fa(i);return Math.round((l-o)/Sr)}function ie(t){const a=K(t);return a.setDate(1),a.setHours(0,0,0,0),a}function Gs(t,a){var c,d,h,p;const s=Dr(),r=(a==null?void 0:a.weekStartsOn)??((d=(c=a==null?void 0:a.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??s.weekStartsOn??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,i=K(t),l=i.getDay(),o=(l<r?-7:0)+6-(l-r);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}function an(t){return Gs(t,{weekStartsOn:1})}function ai(t){const a=K(t),s=a.getFullYear(),r=a.getMonth(),i=ft(t,0);return i.setFullYear(s,r+1,0),i.setHours(0,0,0,0),i.getDate()}function ni(t){return Math.trunc(+K(t)/1e3)}function ri(t){const a=K(t),s=a.getMonth();return a.setFullYear(a.getFullYear(),s+1,0),a.setHours(0,0,0,0),a}function ii(t,a){return si(ri(t),ie(t),a)+1}function Es(t,a){const s=K(t),r=K(a);return s.getTime()>r.getTime()}function nn(t,a){const s=K(t),r=K(a);return+s<+r}function Js(t,a){const s=K(t),r=K(a);return s.getFullYear()===r.getFullYear()&&s.getMonth()===r.getMonth()}function oi(t,a){const s=K(t),r=K(a);return s.getFullYear()===r.getFullYear()}function js(t,a){return J(t,-a)}function bs(t,a){const s=K(t),r=s.getFullYear(),i=s.getDate(),l=ft(t,0);l.setFullYear(r,a,15),l.setHours(0,0,0,0);const o=ai(l);return s.setMonth(a,Math.min(i,o)),s}function $a(t,a){const s=K(t);return isNaN(+s)?ft(t,NaN):(s.setFullYear(a),s)}var D=function(){return D=Object.assign||function(a){for(var s,r=1,i=arguments.length;r<i;r++){s=arguments[r];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=s[l])}return a},D.apply(this,arguments)};function li(t,a){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&a.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)a.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(s[r[i]]=t[r[i]]);return s}function rn(t,a,s){for(var r=0,i=a.length,l;r<i;r++)(l||!(r in a))&&(l||(l=Array.prototype.slice.call(a,0,r)),l[r]=a[r]);return t.concat(l||Array.prototype.slice.call(a))}function yt(t){return t.mode==="multiple"}function jt(t){return t.mode==="range"}function Lt(t){return t.mode==="single"}var di={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function ci(t,a){return Z(t,"LLLL y",a)}function ui(t,a){return Z(t,"d",a)}function mi(t,a){return Z(t,"LLLL",a)}function hi(t){return"".concat(t)}function pi(t,a){return Z(t,"cccccc",a)}function fi(t,a){return Z(t,"yyyy",a)}var xi=Object.freeze({__proto__:null,formatCaption:ci,formatDay:ui,formatMonthCaption:mi,formatWeekNumber:hi,formatWeekdayName:pi,formatYearCaption:fi}),gi=function(t,a,s){return Z(t,"do MMMM (EEEE)",s)},vi=function(){return"Month: "},yi=function(){return"Go to next month"},ji=function(){return"Go to previous month"},bi=function(t,a){return Z(t,"cccc",a)},Ni=function(t){return"Week n. ".concat(t)},wi=function(){return"Year: "},Ci=Object.freeze({__proto__:null,labelDay:gi,labelMonthDropdown:vi,labelNext:yi,labelPrevious:ji,labelWeekNumber:Ni,labelWeekday:bi,labelYearDropdown:wi});function _i(){var t="buttons",a=di,s=Pr,r={},i={},l=1,o={},c=new Date;return{captionLayout:t,classNames:a,formatters:xi,labels:Ci,locale:s,modifiersClassNames:r,modifiers:i,numberOfMonths:l,styles:o,today:c,mode:"default"}}function ki(t){var a=t.fromYear,s=t.toYear,r=t.fromMonth,i=t.toMonth,l=t.fromDate,o=t.toDate;return r?l=ie(r):a&&(l=new Date(a,0,1)),i?o=Bs(i):s&&(o=new Date(s,11,31)),{fromDate:l?It(l):void 0,toDate:o?It(o):void 0}}var on=u.createContext(void 0);function Si(t){var a,s=t.initialProps,r=_i(),i=ki(s),l=i.fromDate,o=i.toDate,c=(a=s.captionLayout)!==null&&a!==void 0?a:r.captionLayout;c!=="buttons"&&(!l||!o)&&(c="buttons");var d;(Lt(s)||yt(s)||jt(s))&&(d=s.onSelect);var h=D(D(D({},r),s),{captionLayout:c,classNames:D(D({},r.classNames),s.classNames),components:D({},s.components),formatters:D(D({},r.formatters),s.formatters),fromDate:l,labels:D(D({},r.labels),s.labels),mode:s.mode||r.mode,modifiers:D(D({},r.modifiers),s.modifiers),modifiersClassNames:D(D({},r.modifiersClassNames),s.modifiersClassNames),onSelect:d,styles:D(D({},r.styles),s.styles),toDate:o});return e.jsx(on.Provider,{value:h,children:t.children})}function $(){var t=u.useContext(on);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function ln(t){var a=$(),s=a.locale,r=a.classNames,i=a.styles,l=a.formatters.formatCaption;return e.jsx("div",{className:r.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:l(t.displayMonth,{locale:s})})}function Di(t){return e.jsx("svg",D({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function dn(t){var a,s,r=t.onChange,i=t.value,l=t.children,o=t.caption,c=t.className,d=t.style,h=$(),p=(s=(a=h.components)===null||a===void 0?void 0:a.IconDropdown)!==null&&s!==void 0?s:Di;return e.jsxs("div",{className:c,style:d,children:[e.jsx("span",{className:h.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:i,onChange:r,children:l}),e.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[o,e.jsx(p,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function Pi(t){var a,s=$(),r=s.fromDate,i=s.toDate,l=s.styles,o=s.locale,c=s.formatters.formatMonthCaption,d=s.classNames,h=s.components,p=s.labels.labelMonthDropdown;if(!r)return e.jsx(e.Fragment,{});if(!i)return e.jsx(e.Fragment,{});var y=[];if(oi(r,i))for(var j=ie(r),m=r.getMonth();m<=i.getMonth();m++)y.push(bs(j,m));else for(var j=ie(new Date),m=0;m<=11;m++)y.push(bs(j,m));var g=function(w){var S=Number(w.target.value),M=bs(ie(t.displayMonth),S);t.onChange(M)},N=(a=h==null?void 0:h.Dropdown)!==null&&a!==void 0?a:dn;return e.jsx(N,{name:"months","aria-label":p(),className:d.dropdown_month,style:l.dropdown_month,onChange:g,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:o}),children:y.map(function(w){return e.jsx("option",{value:w.getMonth(),children:c(w,{locale:o})},w.getMonth())})})}function Oi(t){var a,s=t.displayMonth,r=$(),i=r.fromDate,l=r.toDate,o=r.locale,c=r.styles,d=r.classNames,h=r.components,p=r.formatters.formatYearCaption,y=r.labels.labelYearDropdown,j=[];if(!i)return e.jsx(e.Fragment,{});if(!l)return e.jsx(e.Fragment,{});for(var m=i.getFullYear(),g=l.getFullYear(),N=m;N<=g;N++)j.push($a(Or(new Date),N));var w=function(M){var z=$a(ie(s),Number(M.target.value));t.onChange(z)},S=(a=h==null?void 0:h.Dropdown)!==null&&a!==void 0?a:dn;return e.jsx(S,{name:"years","aria-label":y(),className:d.dropdown_year,style:c.dropdown_year,onChange:w,value:s.getFullYear(),caption:p(s,{locale:o}),children:j.map(function(M){return e.jsx("option",{value:M.getFullYear(),children:p(M,{locale:o})},M.getFullYear())})})}function Mi(t,a){var s=u.useState(t),r=s[0],i=s[1],l=a===void 0?r:a;return[l,i]}function Fi(t){var a=t.month,s=t.defaultMonth,r=t.today,i=a||s||r||new Date,l=t.toDate,o=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(l&&xt(l,i)<0){var h=-1*(d-1);i=ye(l,h)}return o&&xt(i,o)<0&&(i=o),ie(i)}function Ii(){var t=$(),a=Fi(t),s=Mi(a,t.month),r=s[0],i=s[1],l=function(o){var c;if(!t.disableNavigation){var d=ie(o);i(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[r,l]}function Ti(t,a){for(var s=a.reverseMonths,r=a.numberOfMonths,i=ie(t),l=ie(ye(i,r)),o=xt(l,i),c=[],d=0;d<o;d++){var h=ye(i,d);c.push(h)}return s&&(c=c.reverse()),c}function Ei(t,a){if(!a.disableNavigation){var s=a.toDate,r=a.pagedNavigation,i=a.numberOfMonths,l=i===void 0?1:i,o=r?l:1,c=ie(t);if(!s)return ye(c,o);var d=xt(s,t);if(!(d<l))return ye(c,o)}}function Ai(t,a){if(!a.disableNavigation){var s=a.fromDate,r=a.pagedNavigation,i=a.numberOfMonths,l=i===void 0?1:i,o=r?l:1,c=ie(t);if(!s)return ye(c,-o);var d=xt(c,s);if(!(d<=0))return ye(c,-o)}}var cn=u.createContext(void 0);function $i(t){var a=$(),s=Ii(),r=s[0],i=s[1],l=Ti(r,a),o=Ei(r,a),c=Ai(r,a),d=function(y){return l.some(function(j){return Js(y,j)})},h=function(y,j){d(y)||(j&&nn(y,j)?i(ye(y,1+a.numberOfMonths*-1)):i(y))},p={currentMonth:r,displayMonths:l,goToMonth:i,goToDate:h,previousMonth:c,nextMonth:o,isDateDisplayed:d};return e.jsx(cn.Provider,{value:p,children:t.children})}function bt(){var t=u.useContext(cn);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function Ra(t){var a,s=$(),r=s.classNames,i=s.styles,l=s.components,o=bt().goToMonth,c=function(p){o(ye(p,t.displayIndex?-t.displayIndex:0))},d=(a=l==null?void 0:l.CaptionLabel)!==null&&a!==void 0?a:ln,h=e.jsx(d,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:r.caption_dropdowns,style:i.caption_dropdowns,children:[e.jsx("div",{className:r.vhidden,children:h}),e.jsx(Pi,{onChange:c,displayMonth:t.displayMonth}),e.jsx(Oi,{onChange:c,displayMonth:t.displayMonth})]})}function Ri(t){return e.jsx("svg",D({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Li(t){return e.jsx("svg",D({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Et=u.forwardRef(function(t,a){var s=$(),r=s.classNames,i=s.styles,l=[r.button_reset,r.button];t.className&&l.push(t.className);var o=l.join(" "),c=D(D({},i.button_reset),i.button);return t.style&&Object.assign(c,t.style),e.jsx("button",D({},t,{ref:a,type:"button",className:o,style:c}))});function Wi(t){var a,s,r=$(),i=r.dir,l=r.locale,o=r.classNames,c=r.styles,d=r.labels,h=d.labelPrevious,p=d.labelNext,y=r.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var j=h(t.previousMonth,{locale:l}),m=[o.nav_button,o.nav_button_previous].join(" "),g=p(t.nextMonth,{locale:l}),N=[o.nav_button,o.nav_button_next].join(" "),w=(a=y==null?void 0:y.IconRight)!==null&&a!==void 0?a:Li,S=(s=y==null?void 0:y.IconLeft)!==null&&s!==void 0?s:Ri;return e.jsxs("div",{className:o.nav,style:c.nav,children:[!t.hidePrevious&&e.jsx(Et,{name:"previous-month","aria-label":j,className:m,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:i==="rtl"?e.jsx(w,{className:o.nav_icon,style:c.nav_icon}):e.jsx(S,{className:o.nav_icon,style:c.nav_icon})}),!t.hideNext&&e.jsx(Et,{name:"next-month","aria-label":g,className:N,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:i==="rtl"?e.jsx(S,{className:o.nav_icon,style:c.nav_icon}):e.jsx(w,{className:o.nav_icon,style:c.nav_icon})})]})}function La(t){var a=$().numberOfMonths,s=bt(),r=s.previousMonth,i=s.nextMonth,l=s.goToMonth,o=s.displayMonths,c=o.findIndex(function(g){return Js(t.displayMonth,g)}),d=c===0,h=c===o.length-1,p=a>1&&(d||!h),y=a>1&&(h||!d),j=function(){r&&l(r)},m=function(){i&&l(i)};return e.jsx(Wi,{displayMonth:t.displayMonth,hideNext:p,hidePrevious:y,nextMonth:i,previousMonth:r,onPreviousClick:j,onNextClick:m})}function zi(t){var a,s=$(),r=s.classNames,i=s.disableNavigation,l=s.styles,o=s.captionLayout,c=s.components,d=(a=c==null?void 0:c.CaptionLabel)!==null&&a!==void 0?a:ln,h;return i?h=e.jsx(d,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?h=e.jsx(Ra,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?h=e.jsxs(e.Fragment,{children:[e.jsx(Ra,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(La,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):h=e.jsxs(e.Fragment,{children:[e.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(La,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:r.caption,style:l.caption,children:h})}function Bi(t){var a=$(),s=a.footer,r=a.styles,i=a.classNames.tfoot;return s?e.jsx("tfoot",{className:i,style:r.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:s})})}):e.jsx(e.Fragment,{})}function qi(t,a,s){for(var r=s?qs(new Date):gt(new Date,{locale:t,weekStartsOn:a}),i=[],l=0;l<7;l++){var o=J(r,l);i.push(o)}return i}function Ui(){var t=$(),a=t.classNames,s=t.styles,r=t.showWeekNumber,i=t.locale,l=t.weekStartsOn,o=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,h=qi(i,l,o);return e.jsxs("tr",{style:s.head_row,className:a.head_row,children:[r&&e.jsx("td",{style:s.head_cell,className:a.head_cell}),h.map(function(p,y){return e.jsx("th",{scope:"col",className:a.head_cell,style:s.head_cell,"aria-label":d(p,{locale:i}),children:c(p,{locale:i})},y)})]})}function Hi(){var t,a=$(),s=a.classNames,r=a.styles,i=a.components,l=(t=i==null?void 0:i.HeadRow)!==null&&t!==void 0?t:Ui;return e.jsx("thead",{style:r.head,className:s.head,children:e.jsx(l,{})})}function Ki(t){var a=$(),s=a.locale,r=a.formatters.formatDay;return e.jsx(e.Fragment,{children:r(t.date,{locale:s})})}var Zs=u.createContext(void 0);function Yi(t){if(!yt(t.initialProps)){var a={selected:void 0,modifiers:{disabled:[]}};return e.jsx(Zs.Provider,{value:a,children:t.children})}return e.jsx(Vi,{initialProps:t.initialProps,children:t.children})}function Vi(t){var a=t.initialProps,s=t.children,r=a.selected,i=a.min,l=a.max,o=function(h,p,y){var j,m;(j=a.onDayClick)===null||j===void 0||j.call(a,h,p,y);var g=!!(p.selected&&i&&(r==null?void 0:r.length)===i);if(!g){var N=!!(!p.selected&&l&&(r==null?void 0:r.length)===l);if(!N){var w=r?rn([],r):[];if(p.selected){var S=w.findIndex(function(M){return re(h,M)});w.splice(S,1)}else w.push(h);(m=a.onSelect)===null||m===void 0||m.call(a,w,h,p,y)}}},c={disabled:[]};r&&c.disabled.push(function(h){var p=l&&r.length>l-1,y=r.some(function(j){return re(j,h)});return!!(p&&!y)});var d={selected:r,onDayClick:o,modifiers:c};return e.jsx(Zs.Provider,{value:d,children:s})}function Xs(){var t=u.useContext(Zs);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function Qi(t,a){var s=a||{},r=s.from,i=s.to;return r&&i?re(i,t)&&re(r,t)?void 0:re(i,t)?{from:i,to:void 0}:re(r,t)?void 0:Es(r,t)?{from:t,to:i}:{from:r,to:t}:i?Es(t,i)?{from:i,to:t}:{from:t,to:i}:r?nn(t,r)?{from:t,to:r}:{from:r,to:t}:{from:t,to:void 0}}var ea=u.createContext(void 0);function Gi(t){if(!jt(t.initialProps)){var a={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(ea.Provider,{value:a,children:t.children})}return e.jsx(Ji,{initialProps:t.initialProps,children:t.children})}function Ji(t){var a=t.initialProps,s=t.children,r=a.selected,i=r||{},l=i.from,o=i.to,c=a.min,d=a.max,h=function(m,g,N){var w,S;(w=a.onDayClick)===null||w===void 0||w.call(a,m,g,N);var M=Qi(m,r);(S=a.onSelect)===null||S===void 0||S.call(a,M,m,g,N)},p={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(p.range_start=[l],o?(p.range_end=[o],re(l,o)||(p.range_middle=[{after:l,before:o}])):p.range_end=[l]):o&&(p.range_start=[o],p.range_end=[o]),c&&(l&&!o&&p.disabled.push({after:js(l,c-1),before:J(l,c-1)}),l&&o&&p.disabled.push({after:l,before:J(l,c-1)}),!l&&o&&p.disabled.push({after:js(o,c-1),before:J(o,c-1)})),d){if(l&&!o&&(p.disabled.push({before:J(l,-d+1)}),p.disabled.push({after:J(l,d-1)})),l&&o){var y=Fe(o,l)+1,j=d-y;p.disabled.push({before:js(l,j)}),p.disabled.push({after:J(o,j)})}!l&&o&&(p.disabled.push({before:J(o,-d+1)}),p.disabled.push({after:J(o,d-1)}))}return e.jsx(ea.Provider,{value:{selected:r,onDayClick:h,modifiers:p},children:s})}function ta(){var t=u.useContext(ea);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function Ft(t){return Array.isArray(t)?rn([],t):t!==void 0?[t]:[]}function Zi(t){var a={};return Object.entries(t).forEach(function(s){var r=s[0],i=s[1];a[r]=Ft(i)}),a}var je;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(je||(je={}));var Xi=je.Selected,Me=je.Disabled,eo=je.Hidden,to=je.Today,Ns=je.RangeEnd,ws=je.RangeMiddle,Cs=je.RangeStart,so=je.Outside;function ao(t,a,s){var r,i=(r={},r[Xi]=Ft(t.selected),r[Me]=Ft(t.disabled),r[eo]=Ft(t.hidden),r[to]=[t.today],r[Ns]=[],r[ws]=[],r[Cs]=[],r[so]=[],r);return t.fromDate&&i[Me].push({before:t.fromDate}),t.toDate&&i[Me].push({after:t.toDate}),yt(t)?i[Me]=i[Me].concat(a.modifiers[Me]):jt(t)&&(i[Me]=i[Me].concat(s.modifiers[Me]),i[Cs]=s.modifiers[Cs],i[ws]=s.modifiers[ws],i[Ns]=s.modifiers[Ns]),i}var un=u.createContext(void 0);function no(t){var a=$(),s=Xs(),r=ta(),i=ao(a,s,r),l=Zi(a.modifiers),o=D(D({},i),l);return e.jsx(un.Provider,{value:o,children:t.children})}function mn(){var t=u.useContext(un);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function ro(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function io(t){return!!(t&&typeof t=="object"&&"from"in t)}function oo(t){return!!(t&&typeof t=="object"&&"after"in t)}function lo(t){return!!(t&&typeof t=="object"&&"before"in t)}function co(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function uo(t,a){var s,r=a.from,i=a.to;if(r&&i){var l=Fe(i,r)<0;l&&(s=[i,r],r=s[0],i=s[1]);var o=Fe(t,r)>=0&&Fe(i,t)>=0;return o}return i?re(i,t):r?re(r,t):!1}function mo(t){return Za(t)}function ho(t){return Array.isArray(t)&&t.every(Za)}function po(t,a){return a.some(function(s){if(typeof s=="boolean")return s;if(mo(s))return re(t,s);if(ho(s))return s.includes(t);if(io(s))return uo(t,s);if(co(s))return s.dayOfWeek.includes(t.getDay());if(ro(s)){var r=Fe(s.before,t),i=Fe(s.after,t),l=r>0,o=i<0,c=Es(s.before,s.after);return c?o&&l:l||o}return oo(s)?Fe(t,s.after)>0:lo(s)?Fe(s.before,t)>0:typeof s=="function"?s(t):!1})}function sa(t,a,s){var r=Object.keys(a).reduce(function(l,o){var c=a[o];return po(t,c)&&l.push(o),l},[]),i={};return r.forEach(function(l){return i[l]=!0}),s&&!Js(t,s)&&(i.outside=!0),i}function fo(t,a){for(var s=ie(t[0]),r=Bs(t[t.length-1]),i,l,o=s;o<=r;){var c=sa(o,a),d=!c.disabled&&!c.hidden;if(!d){o=J(o,1);continue}if(c.selected)return o;c.today&&!l&&(l=o),i||(i=o),o=J(o,1)}return l||i}var xo=365;function hn(t,a){var s=a.moveBy,r=a.direction,i=a.context,l=a.modifiers,o=a.retry,c=o===void 0?{count:0,lastFocused:t}:o,d=i.weekStartsOn,h=i.fromDate,p=i.toDate,y=i.locale,j={day:J,week:Ts,month:ye,year:Xr,startOfWeek:function(w){return i.ISOWeek?qs(w):gt(w,{locale:y,weekStartsOn:d})},endOfWeek:function(w){return i.ISOWeek?an(w):Gs(w,{locale:y,weekStartsOn:d})}},m=j[s](t,r==="after"?1:-1);r==="before"&&h?m=ei([h,m]):r==="after"&&p&&(m=ti([p,m]));var g=!0;if(l){var N=sa(m,l);g=!N.disabled&&!N.hidden}return g?m:c.count>xo?c.lastFocused:hn(m,{moveBy:s,direction:r,context:i,modifiers:l,retry:D(D({},c),{count:c.count+1})})}var pn=u.createContext(void 0);function go(t){var a=bt(),s=mn(),r=u.useState(),i=r[0],l=r[1],o=u.useState(),c=o[0],d=o[1],h=fo(a.displayMonths,s),p=i??(c&&a.isDateDisplayed(c))?c:h,y=function(){d(i),l(void 0)},j=function(w){l(w)},m=$(),g=function(w,S){if(i){var M=hn(i,{moveBy:w,direction:S,context:m,modifiers:s});re(i,M)||(a.goToDate(M,i),j(M))}},N={focusedDay:i,focusTarget:p,blur:y,focus:j,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return e.jsx(pn.Provider,{value:N,children:t.children})}function aa(){var t=u.useContext(pn);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function vo(t,a){var s=mn(),r=sa(t,s,a);return r}var na=u.createContext(void 0);function yo(t){if(!Lt(t.initialProps)){var a={selected:void 0};return e.jsx(na.Provider,{value:a,children:t.children})}return e.jsx(jo,{initialProps:t.initialProps,children:t.children})}function jo(t){var a=t.initialProps,s=t.children,r=function(l,o,c){var d,h,p;if((d=a.onDayClick)===null||d===void 0||d.call(a,l,o,c),o.selected&&!a.required){(h=a.onSelect)===null||h===void 0||h.call(a,void 0,l,o,c);return}(p=a.onSelect)===null||p===void 0||p.call(a,l,l,o,c)},i={selected:a.selected,onDayClick:r};return e.jsx(na.Provider,{value:i,children:s})}function fn(){var t=u.useContext(na);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function bo(t,a){var s=$(),r=fn(),i=Xs(),l=ta(),o=aa(),c=o.focusDayAfter,d=o.focusDayBefore,h=o.focusWeekAfter,p=o.focusWeekBefore,y=o.blur,j=o.focus,m=o.focusMonthBefore,g=o.focusMonthAfter,N=o.focusYearBefore,w=o.focusYearAfter,S=o.focusStartOfWeek,M=o.focusEndOfWeek,z=function(_){var b,Ie,Y,_e;Lt(s)?(b=r.onDayClick)===null||b===void 0||b.call(r,t,a,_):yt(s)?(Ie=i.onDayClick)===null||Ie===void 0||Ie.call(i,t,a,_):jt(s)?(Y=l.onDayClick)===null||Y===void 0||Y.call(l,t,a,_):(_e=s.onDayClick)===null||_e===void 0||_e.call(s,t,a,_)},he=function(_){var b;j(t),(b=s.onDayFocus)===null||b===void 0||b.call(s,t,a,_)},oe=function(_){var b;y(),(b=s.onDayBlur)===null||b===void 0||b.call(s,t,a,_)},fe=function(_){var b;(b=s.onDayMouseEnter)===null||b===void 0||b.call(s,t,a,_)},xe=function(_){var b;(b=s.onDayMouseLeave)===null||b===void 0||b.call(s,t,a,_)},Ce=function(_){var b;(b=s.onDayPointerEnter)===null||b===void 0||b.call(s,t,a,_)},be=function(_){var b;(b=s.onDayPointerLeave)===null||b===void 0||b.call(s,t,a,_)},Ne=function(_){var b;(b=s.onDayTouchCancel)===null||b===void 0||b.call(s,t,a,_)},ge=function(_){var b;(b=s.onDayTouchEnd)===null||b===void 0||b.call(s,t,a,_)},We=function(_){var b;(b=s.onDayTouchMove)===null||b===void 0||b.call(s,t,a,_)},ze=function(_){var b;(b=s.onDayTouchStart)===null||b===void 0||b.call(s,t,a,_)},at=function(_){var b;(b=s.onDayKeyUp)===null||b===void 0||b.call(s,t,a,_)},we=function(_){var b;switch(_.key){case"ArrowLeft":_.preventDefault(),_.stopPropagation(),s.dir==="rtl"?c():d();break;case"ArrowRight":_.preventDefault(),_.stopPropagation(),s.dir==="rtl"?d():c();break;case"ArrowDown":_.preventDefault(),_.stopPropagation(),h();break;case"ArrowUp":_.preventDefault(),_.stopPropagation(),p();break;case"PageUp":_.preventDefault(),_.stopPropagation(),_.shiftKey?N():m();break;case"PageDown":_.preventDefault(),_.stopPropagation(),_.shiftKey?w():g();break;case"Home":_.preventDefault(),_.stopPropagation(),S();break;case"End":_.preventDefault(),_.stopPropagation(),M();break}(b=s.onDayKeyDown)===null||b===void 0||b.call(s,t,a,_)},I={onClick:z,onFocus:he,onBlur:oe,onKeyDown:we,onKeyUp:at,onMouseEnter:fe,onMouseLeave:xe,onPointerEnter:Ce,onPointerLeave:be,onTouchCancel:Ne,onTouchEnd:ge,onTouchMove:We,onTouchStart:ze};return I}function No(){var t=$(),a=fn(),s=Xs(),r=ta(),i=Lt(t)?a.selected:yt(t)?s.selected:jt(t)?r.selected:void 0;return i}function wo(t){return Object.values(je).includes(t)}function Co(t,a){var s=[t.classNames.day];return Object.keys(a).forEach(function(r){var i=t.modifiersClassNames[r];if(i)s.push(i);else if(wo(r)){var l=t.classNames["day_".concat(r)];l&&s.push(l)}}),s}function _o(t,a){var s=D({},t.styles.day);return Object.keys(a).forEach(function(r){var i;s=D(D({},s),(i=t.modifiersStyles)===null||i===void 0?void 0:i[r])}),s}function ko(t,a,s){var r,i,l,o=$(),c=aa(),d=vo(t,a),h=bo(t,d),p=No(),y=!!(o.onDayClick||o.mode!=="default");u.useEffect(function(){var fe;d.outside||c.focusedDay&&y&&re(c.focusedDay,t)&&((fe=s.current)===null||fe===void 0||fe.focus())},[c.focusedDay,t,s,y,d.outside]);var j=Co(o,d).join(" "),m=_o(o,d),g=!!(d.outside&&!o.showOutsideDays||d.hidden),N=(l=(i=o.components)===null||i===void 0?void 0:i.DayContent)!==null&&l!==void 0?l:Ki,w=e.jsx(N,{date:t,displayMonth:a,activeModifiers:d}),S={style:m,className:j,children:w,role:"gridcell"},M=c.focusTarget&&re(c.focusTarget,t)&&!d.outside,z=c.focusedDay&&re(c.focusedDay,t),he=D(D(D({},S),(r={disabled:d.disabled,role:"gridcell"},r["aria-selected"]=d.selected,r.tabIndex=z||M?0:-1,r)),h),oe={isButton:y,isHidden:g,activeModifiers:d,selectedDays:p,buttonProps:he,divProps:S};return oe}function So(t){var a=u.useRef(null),s=ko(t.date,t.displayMonth,a);return s.isHidden?e.jsx("div",{role:"gridcell"}):s.isButton?e.jsx(Et,D({name:"day",ref:a},s.buttonProps)):e.jsx("div",D({},s.divProps))}function Do(t){var a=t.number,s=t.dates,r=$(),i=r.onWeekNumberClick,l=r.styles,o=r.classNames,c=r.locale,d=r.labels.labelWeekNumber,h=r.formatters.formatWeekNumber,p=h(Number(a),{locale:c});if(!i)return e.jsx("span",{className:o.weeknumber,style:l.weeknumber,children:p});var y=d(Number(a),{locale:c}),j=function(m){i(a,s,m)};return e.jsx(Et,{name:"week-number","aria-label":y,className:o.weeknumber,style:l.weeknumber,onClick:j,children:p})}function Po(t){var a,s,r=$(),i=r.styles,l=r.classNames,o=r.showWeekNumber,c=r.components,d=(a=c==null?void 0:c.Day)!==null&&a!==void 0?a:So,h=(s=c==null?void 0:c.WeekNumber)!==null&&s!==void 0?s:Do,p;return o&&(p=e.jsx("td",{className:l.cell,style:i.cell,children:e.jsx(h,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:l.row,style:i.row,children:[p,t.dates.map(function(y){return e.jsx("td",{className:l.cell,style:i.cell,role:"presentation",children:e.jsx(d,{displayMonth:t.displayMonth,date:y})},ni(y))})]})}function Wa(t,a,s){for(var r=s!=null&&s.ISOWeek?an(a):Gs(a,s),i=s!=null&&s.ISOWeek?qs(t):gt(t,s),l=Fe(r,i),o=[],c=0;c<=l;c++)o.push(J(i,c));var d=o.reduce(function(h,p){var y=s!=null&&s.ISOWeek?Mr(p):Fr(p,s),j=h.find(function(m){return m.weekNumber===y});return j?(j.dates.push(p),h):(h.push({weekNumber:y,dates:[p]}),h)},[]);return d}function Oo(t,a){var s=Wa(ie(t),Bs(t),a);if(a!=null&&a.useFixedWeeks){var r=ii(t,a);if(r<6){var i=s[s.length-1],l=i.dates[i.dates.length-1],o=Ts(l,6-r),c=Wa(Ts(l,1),o,a);s.push.apply(s,c)}}return s}function Mo(t){var a,s,r,i=$(),l=i.locale,o=i.classNames,c=i.styles,d=i.hideHead,h=i.fixedWeeks,p=i.components,y=i.weekStartsOn,j=i.firstWeekContainsDate,m=i.ISOWeek,g=Oo(t.displayMonth,{useFixedWeeks:!!h,ISOWeek:m,locale:l,weekStartsOn:y,firstWeekContainsDate:j}),N=(a=p==null?void 0:p.Head)!==null&&a!==void 0?a:Hi,w=(s=p==null?void 0:p.Row)!==null&&s!==void 0?s:Po,S=(r=p==null?void 0:p.Footer)!==null&&r!==void 0?r:Bi;return e.jsxs("table",{id:t.id,className:o.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&e.jsx(N,{}),e.jsx("tbody",{className:o.tbody,style:c.tbody,children:g.map(function(M){return e.jsx(w,{displayMonth:t.displayMonth,dates:M.dates,weekNumber:M.weekNumber},M.weekNumber)})}),e.jsx(S,{displayMonth:t.displayMonth})]})}function Fo(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Io=Fo()?u.useLayoutEffect:u.useEffect,_s=!1,To=0;function za(){return"react-day-picker-".concat(++To)}function Eo(t){var a,s=t??(_s?za():null),r=u.useState(s),i=r[0],l=r[1];return Io(function(){i===null&&l(za())},[]),u.useEffect(function(){_s===!1&&(_s=!0)},[]),(a=t??i)!==null&&a!==void 0?a:void 0}function Ao(t){var a,s,r=$(),i=r.dir,l=r.classNames,o=r.styles,c=r.components,d=bt().displayMonths,h=Eo(r.id?"".concat(r.id,"-").concat(t.displayIndex):void 0),p=r.id?"".concat(r.id,"-grid-").concat(t.displayIndex):void 0,y=[l.month],j=o.month,m=t.displayIndex===0,g=t.displayIndex===d.length-1,N=!m&&!g;i==="rtl"&&(a=[m,g],g=a[0],m=a[1]),m&&(y.push(l.caption_start),j=D(D({},j),o.caption_start)),g&&(y.push(l.caption_end),j=D(D({},j),o.caption_end)),N&&(y.push(l.caption_between),j=D(D({},j),o.caption_between));var w=(s=c==null?void 0:c.Caption)!==null&&s!==void 0?s:zi;return e.jsxs("div",{className:y.join(" "),style:j,children:[e.jsx(w,{id:h,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(Mo,{id:p,"aria-labelledby":h,displayMonth:t.displayMonth})]},t.displayIndex)}function $o(t){var a=$(),s=a.classNames,r=a.styles;return e.jsx("div",{className:s.months,style:r.months,children:t.children})}function Ro(t){var a,s,r=t.initialProps,i=$(),l=aa(),o=bt(),c=u.useState(!1),d=c[0],h=c[1];u.useEffect(function(){i.initialFocus&&l.focusTarget&&(d||(l.focus(l.focusTarget),h(!0)))},[i.initialFocus,d,l.focus,l.focusTarget,l]);var p=[i.classNames.root,i.className];i.numberOfMonths>1&&p.push(i.classNames.multiple_months),i.showWeekNumber&&p.push(i.classNames.with_weeknumber);var y=D(D({},i.styles.root),i.style),j=Object.keys(r).filter(function(g){return g.startsWith("data-")}).reduce(function(g,N){var w;return D(D({},g),(w={},w[N]=r[N],w))},{}),m=(s=(a=r.components)===null||a===void 0?void 0:a.Months)!==null&&s!==void 0?s:$o;return e.jsx("div",D({className:p.join(" "),style:y,dir:i.dir,id:i.id,nonce:r.nonce,title:r.title,lang:r.lang},j,{children:e.jsx(m,{children:o.displayMonths.map(function(g,N){return e.jsx(Ao,{displayIndex:N,displayMonth:g},N)})})}))}function Lo(t){var a=t.children,s=li(t,["children"]);return e.jsx(Si,{initialProps:s,children:e.jsx($i,{children:e.jsx(yo,{initialProps:s,children:e.jsx(Yi,{initialProps:s,children:e.jsx(Gi,{initialProps:s,children:e.jsx(no,{children:e.jsx(go,{children:a})})})})})})})}function Wo(t){return e.jsx(Lo,D({},t,{children:e.jsx(Ro,{initialProps:t})}))}function As({className:t,classNames:a,showOutsideDays:s=!0,...r}){return e.jsx(Wo,{showOutsideDays:s,className:Ye("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ye(Na({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ye(Na({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:i,...l})=>e.jsx(Ir,{className:Ye("h-4 w-4",i),...l}),IconRight:({className:i,...l})=>e.jsx(Xa,{className:Ye("h-4 w-4",i),...l})},...r})}As.displayName="Calendar";function zo(t){const a=Bo(t),s=u.forwardRef((r,i)=>{const{children:l,...o}=r,c=u.Children.toArray(l),d=c.find(Uo);if(d){const h=d.props.children,p=c.map(y=>y===d?u.Children.count(h)>1?u.Children.only(null):u.isValidElement(h)?h.props.children:null:y);return e.jsx(a,{...o,ref:i,children:u.isValidElement(h)?u.cloneElement(h,void 0,p):null})}return e.jsx(a,{...o,ref:i,children:l})});return s.displayName=`${t}.Slot`,s}function Bo(t){const a=u.forwardRef((s,r)=>{const{children:i,...l}=s;if(u.isValidElement(i)){const o=Ko(i),c=Ho(l,i.props);return i.type!==u.Fragment&&(c.ref=r?xr(r,o):o),u.cloneElement(i,c)}return u.Children.count(i)>1?u.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var qo=Symbol("radix.slottable");function Uo(t){return u.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===qo}function Ho(t,a){const s={...a};for(const r in a){const i=t[r],l=a[r];/^on[A-Z]/.test(r)?i&&l?s[r]=(...c)=>{const d=l(...c);return i(...c),d}:i&&(s[r]=i):r==="style"?s[r]={...i,...l}:r==="className"&&(s[r]=[i,l].filter(Boolean).join(" "))}return{...t,...s}}function Ko(t){var r,i;let a=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=a&&"isReactWarning"in a&&a.isReactWarning;return s?t.ref:(a=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=a&&"isReactWarning"in a&&a.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var Wt="Popover",[xn]=Ka(Wt,[Rt]),Nt=Rt(),[Yo,Le]=xn(Wt),gn=t=>{const{__scopePopover:a,children:s,open:r,defaultOpen:i,onOpenChange:l,modal:o=!1}=t,c=Nt(a),d=u.useRef(null),[h,p]=u.useState(!1),[y,j]=Ua({prop:r,defaultProp:i??!1,onChange:l,caller:Wt});return e.jsx(Ha,{...c,children:e.jsx(Yo,{scope:a,contentId:gr(),triggerRef:d,open:y,onOpenChange:j,onOpenToggle:u.useCallback(()=>j(m=>!m),[j]),hasCustomAnchor:h,onCustomAnchorAdd:u.useCallback(()=>p(!0),[]),onCustomAnchorRemove:u.useCallback(()=>p(!1),[]),modal:o,children:s})})};gn.displayName=Wt;var vn="PopoverAnchor",Vo=u.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,i=Le(vn,s),l=Nt(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=i;return u.useEffect(()=>(o(),()=>c()),[o,c]),e.jsx(Ws,{...l,...r,ref:a})});Vo.displayName=vn;var yn="PopoverTrigger",jn=u.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,i=Le(yn,s),l=Nt(s),o=Rs(a,i.triggerRef),c=e.jsx(Ls.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":_n(i.open),...r,ref:o,onClick:ne(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?c:e.jsx(Ws,{asChild:!0,...l,children:c})});jn.displayName=yn;var ra="PopoverPortal",[Qo,Go]=xn(ra,{forceMount:void 0}),bn=t=>{const{__scopePopover:a,forceMount:s,children:r,container:i}=t,l=Le(ra,a);return e.jsx(Qo,{scope:a,forceMount:s,children:e.jsx(zs,{present:s||l.open,children:e.jsx(vr,{asChild:!0,container:i,children:r})})})};bn.displayName=ra;var st="PopoverContent",Nn=u.forwardRef((t,a)=>{const s=Go(st,t.__scopePopover),{forceMount:r=s.forceMount,...i}=t,l=Le(st,t.__scopePopover);return e.jsx(zs,{present:r||l.open,children:l.modal?e.jsx(Zo,{...i,ref:a}):e.jsx(Xo,{...i,ref:a})})});Nn.displayName=st;var Jo=zo("PopoverContent.RemoveScroll"),Zo=u.forwardRef((t,a)=>{const s=Le(st,t.__scopePopover),r=u.useRef(null),i=Rs(a,r),l=u.useRef(!1);return u.useEffect(()=>{const o=r.current;if(o)return yr(o)},[]),e.jsx(jr,{as:Jo,allowPinchZoom:!0,children:e.jsx(wn,{...t,ref:i,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ne(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),l.current||(c=s.triggerRef.current)==null||c.focus()}),onPointerDownOutside:ne(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,h=c.button===2||d;l.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:ne(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Xo=u.forwardRef((t,a)=>{const s=Le(st,t.__scopePopover),r=u.useRef(!1),i=u.useRef(!1);return e.jsx(wn,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,l),l.defaultPrevented||(r.current||(c=s.triggerRef.current)==null||c.focus(),l.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:l=>{var d,h;(d=t.onInteractOutside)==null||d.call(t,l),l.defaultPrevented||(r.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=l.target;((h=s.triggerRef.current)==null?void 0:h.contains(o))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),wn=u.forwardRef((t,a)=>{const{__scopePopover:s,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,...y}=t,j=Le(st,s),m=Nt(s);return br(),e.jsx(Nr,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:l,children:e.jsx(Ya,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:p,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onDismiss:()=>j.onOpenChange(!1),children:e.jsx(Va,{"data-state":_n(j.open),role:"dialog",id:j.contentId,...m,...y,ref:a,style:{...y.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Cn="PopoverClose",el=u.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,i=Le(Cn,s);return e.jsx(Ls.button,{type:"button",...r,ref:a,onClick:ne(t.onClick,()=>i.onOpenChange(!1))})});el.displayName=Cn;var tl="PopoverArrow",sl=u.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,i=Nt(s);return e.jsx(Qa,{...i,...r,ref:a})});sl.displayName=tl;function _n(t){return t?"open":"closed"}var al=gn,nl=jn,rl=bn,kn=Nn;const Ba=al,qa=nl,$s=u.forwardRef(({className:t,align:a="center",sideOffset:s=4,...r},i)=>e.jsx(rl,{children:e.jsx(kn,{ref:i,align:a,sideOffset:s,className:Ye("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...r})}));$s.displayName=kn.displayName;const il=[{value:"PDF_4x6",label:"4 x 6 in. (Standard Thermal)",description:"Most common thermal printer format"},{value:"PDF",label:"8.5 x 11 in. (Letter Size)",description:"Standard paper format"},{value:"PNG",label:"PNG Image (4 x 6 in.)",description:"Compatible with Dymo printers"},{value:"ZPLII",label:"ZPL II (Zebra Format)",description:"For Zebra thermal printers"}];function Sn({open:t,onOpenChange:a,orderCount:s,onConfirm:r,isPending:i}){const[l,o]=u.useState("PDF_4x6"),c=()=>{r(l)};return e.jsx(Ze,{open:t,onOpenChange:a,children:e.jsxs(Xe,{className:"max-w-md",children:[e.jsxs(et,{children:[e.jsxs(tt,{children:["Generate ",s," Label",s!==1?"s":"","?"]}),e.jsx(vt,{children:"If you need to make additional changes to the shipment after creating these labels, you may be charged."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($e,{htmlFor:"label-size",className:"text-sm font-medium",children:["Label Size ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ds,{value:l,onValueChange:o,disabled:i,children:[e.jsx(Ps,{id:"label-size","data-testid":"select-label-size",children:e.jsx(Os,{placeholder:"Select label size"})}),e.jsx(Ms,{children:il.map(d=>e.jsx(ve,{value:d.value,"data-testid":`option-${d.value}`,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:d.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d.description})]})},d.value))})]})]}),e.jsxs(Wr,{children:[e.jsx(Fs,{className:"h-4 w-4"}),e.jsx(zr,{className:"text-sm",children:"To change label sizes after generation, please update each label individually."})]})]}),e.jsxs(Tt,{className:"gap-2 sm:gap-0",children:[e.jsx(O,{variant:"outline",onClick:()=>a(!1),disabled:i,"data-testid":"button-cancel-label",children:"Cancel"}),e.jsx(O,{onClick:c,disabled:i,"data-testid":"button-confirm-label",children:i?"Generating...":`Generate Label${s!==1?"s":""}`})]})]})})}function ol({order:t,bundle:a,children:s,currentTab:r,open:i,onOpenChange:l}){var wt,Je,Ct;const o=!!a,c=(a==null?void 0:a.orders)||[],d=t||(c.length>0?c[0]:null);if(!d&&!s)return null;const[h,p]=u.useState(!1),y=i!==void 0?i:h,j=l||p,[m,g]=u.useState([]),[N,w]=u.useState(!1),[S,M]=u.useState(!1),[z,he]=u.useState(null),[oe,fe]=u.useState(null);u.useEffect(()=>{console.log("labelDialogOpen changed to:",S)},[S]);const[xe,Ce]=u.useState({}),[be,Ne]=u.useState(null),ge=()=>!o||!c.length?{subtotal:0,tax:0,shipping:0,total:0,itemCount:0}:c.reduce((x,k)=>{const R=k.items&&k.items.length>0?k.items.reduce((B,q)=>B+(q.price||0)*(q.quantity||1),0):(k.total||0)+(k.servicefee||0),E=k.items?k.items.reduce((B,q)=>B+(q.quantity||1),0):1,L=k.total_shipping_cost??k.seller_shipping_fee_pay??k.shipping_fee??0;return{subtotal:x.subtotal+R,tax:x.tax+(k.tax||0),shipping:x.shipping+L,total:x.total+R+(k.tax||0)+L,itemCount:x.itemCount+E}},{subtotal:0,tax:0,shipping:0,total:0,itemCount:0}),We=()=>{if(d.items&&d.items.length>0){const x=d.items.reduce((k,R)=>k+(R.price||0)*(R.quantity||1),0);if(x>0)return x}return(d.total||0)+(d.servicefee||0)},ze=()=>d.giveaway?d.giveaway.length&&d.giveaway.width&&d.giveaway.height?{length:d.giveaway.length,width:d.giveaway.width,height:d.giveaway.height}:{length:"8",width:"6",height:"2"}:d.length&&d.width&&d.height?{length:d.length.toString(),width:d.width.toString(),height:d.height.toString()}:{length:"10",width:"8",height:"3"},at=()=>{var x;if(d.giveaway){const k=(x=d.giveaway.shipping_profile)==null?void 0:x.weight;if(k)return k.toString()}return d.weight?d.weight.toString():"0"},we=()=>{var x,k;return((k=(x=d.giveaway)==null?void 0:x.shipping_profile)==null?void 0:k.scale)||"oz"},[I,_]=u.useState(ze()),[b,Ie]=u.useState(at()),Y=!!(I.length&&I.width&&I.height&&b),_e=Y&&y,{toast:Te}=Ga(),Ee=Ja(),le=Ue({queryKey:["/api/shipping/profiles/estimate/rates",{weight:b,length:I.length,width:I.width,height:I.height,product:((wt=d.giveaway)==null?void 0:wt._id)||"",owner:d.seller._id,customer:d.customer._id,isBundle:o}],queryFn:async()=>{var B,q,qe,de;const x={weight:b,unit:we(),product:((B=d.giveaway)==null?void 0:B._id)||((de=(qe=(q=d.items)==null?void 0:q[0])==null?void 0:qe.productId)==null?void 0:de._id)||d._id,update:!0,owner:d.seller._id,customer:d.customer._id,length:parseFloat(I.length),width:parseFloat(I.width),height:parseFloat(I.height)},k=localStorage.getItem("accessToken"),R=localStorage.getItem("user"),E={"Content-Type":"application/json"};k&&(E["x-access-token"]=k,E.Authorization=`Bearer ${k}`),R&&(E["x-user-data"]=btoa(unescape(encodeURIComponent(R))));const L=await fetch("/api/shipping/profiles/estimate/rates",{method:"POST",headers:E,credentials:"include",body:JSON.stringify(x)});if(!L.ok)throw new Error(`Failed to fetch shipping estimates: ${L.status}`);return await L.json()},enabled:_e,retry:1}),V=le.data||[];u.useEffect(()=>{if(V.length>0){const x={...xe};let k=!1;V.forEach(L=>{const B=`${L.carrier}-${L.service}-${L.deliveryTime}`;B in xe||(x[B]=parseFloat(L.price),k=!0)}),k&&(Ce(x),console.log("Stored initial estimate prices:",x));const R=`${V[0].carrier}-${V[0].service}-${V[0].deliveryTime}`,E=xe[R];if(E){const B=parseFloat(V[0].price)-E,q=B/E*100;B>0&&q>10?(Ne({amount:B,percentage:q}),console.log("Price increase detected:",{priceDiff:B,percentIncrease:q})):Ne(null)}}},[V,xe]),u.useEffect(()=>{y||(Ce({}),Ne(null))},[y]);const Ge=()=>{var x;Ee.invalidateQueries({queryKey:["/api/shipping/profiles/estimate/rates",{weight:b,length:I.length,width:I.width,height:I.height,product:((x=d.giveaway)==null?void 0:x._id)||"",owner:d.seller._id,customer:d.customer._id,isBundle:o}]}),Te({title:"Refreshing shipping estimates..."})},Be=ae({mutationFn:async x=>{var E;const k={rate_id:x.objectId,order:o&&((E=c[0])==null?void 0:E.bundleId)||d._id,isBundle:o,shipping_fee:parseFloat(x.price),servicelevel:`${x.carrier} ${x.service}`,carrier:x.carrier,deliveryTime:x.deliveryTime,label_file_type:x.labelFileType,weight:parseFloat(b),weight_unit:we(),length:parseFloat(I.length),width:parseFloat(I.width),height:parseFloat(I.height),estimate_data:{price:x.priceDifference||"0.00",carrier:x.carrier,service:x.service,weight:parseFloat(b),weight_unit:we(),length:parseFloat(I.length),width:parseFloat(I.width),height:parseFloat(I.height)}};return await(await wr("POST","/api/shipping/profiles/buy/label",k)).json()},onSuccess:(x,k)=>{x.success&&x.data?(x.data.label_url&&window.open(x.data.label_url,"_blank"),r==="all"?Ee.invalidateQueries({queryKey:["external-orders"]}):Ee.invalidateQueries({queryKey:["/api/bundles"]}),Ee.invalidateQueries({queryKey:["/api/shipping/metrics"]}),Te({title:"Shipping label purchased successfully!",description:`${x.data.carrier} ${x.data.service} - $${x.data.cost}
Tracking: ${x.data.tracking_number}`}),console.log("Label purchase successful:",x.data),j(!1)):Te({title:"Label purchase failed",description:x.message||"Unable to purchase shipping label",variant:"destructive"})},onError:x=>{console.error("Label purchase error:",x),Te({title:"Failed to purchase shipping label",description:x.message||"An unexpected error occurred",variant:"destructive"})}}),qt=x=>{if(!x.objectId||x.objectId.trim()===""){Te({title:"Cannot purchase label",description:"Invalid shipping rate. Please refresh estimates and try again.",variant:"destructive"});return}console.log("handlePrintLabel called:",{estimate:x,labelDialogOpen:S}),he(x),fe(x),M(!0),console.log("After setState calls - labelDialogOpen set to true")},nt=x=>{if(!oe){console.error("No locked estimate available for purchase"),Te({title:"Error",description:"Could not find shipping rate. Please try again.",variant:"destructive"});return}const k=oe,R=`${k.carrier}-${k.service}-${k.deliveryTime}`,E=parseFloat(k.price),L=xe[R]||E,B=(E-L).toFixed(2);console.log("Purchasing label with locked estimate:",{serviceKey:R,initialPrice:L,currentPrice:k.price,priceDifference:B,carrier:k.carrier,service:k.service,objectId:k.objectId,weight:b,dimensions:I,labelFileType:x}),Be.mutate({...k,labelFileType:x,priceDifference:B}),M(!1),j(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(Us,{open:y,onOpenChange:j,children:[s&&e.jsx(Tr,{asChild:!0,children:s}),e.jsxs(Hs,{className:"w-[600px] sm:max-w-[600px] overflow-y-auto",children:[e.jsxs(Ks,{children:[e.jsx(Ys,{className:"flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(Ta,{size:20}),"Ship Bundle - ",c.length," Orders"]}):e.jsxs(e.Fragment,{children:[e.jsx(en,{size:20}),"Ship Order ",d.invoice||d._id.slice(-8)]})}),e.jsx(Er,{children:o?`Manage bundle dimensions, get shipping estimates, and print labels for ${c.length} orders`:"Manage dimensions, get shipping estimates, and print labels"})]}),e.jsxs("div",{className:"mt-6 space-y-6 pb-6",children:[o?e.jsxs(e.Fragment,{children:[e.jsxs(Q,{children:[e.jsx(He,{className:"pb-3",children:e.jsx(Ke,{className:"text-sm",children:"Customer"})}),e.jsx(G,{children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"}),e.jsxs("span",{className:"font-medium",children:[d.customer.firstName," ",d.customer.lastName||""]})]})})]}),e.jsx(Ar,{open:N,onOpenChange:w,children:e.jsxs(Q,{children:[e.jsx($r,{asChild:!0,children:e.jsx(He,{className:"pb-3 cursor-pointer hover:bg-muted/50 transition-colors",children:e.jsxs(Ke,{className:"text-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ta,{size:16}),"Bundle Summary"]}),e.jsx(tn,{className:`h-4 w-4 transition-transform ${N?"rotate-180":""}`})]})})}),e.jsx(Rr,{children:e.jsxs(G,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Orders in Bundle:"}),e.jsxs("span",{className:"font-medium",children:[c.length," orders"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Items:"}),e.jsxs("span",{children:[ge().itemCount," items"]})]}),e.jsx(Ve,{className:"my-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bundle Subtotal:"}),e.jsxs("span",{className:"font-medium",children:["$",ge().subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bundle Tax:"}),e.jsx("span",{children:ge().tax>0?`$${ge().tax.toFixed(2)}`:""})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bundle Shipping:"}),e.jsx("span",{children:(()=>{var E;const x=Number(ge().shipping),k=Number((z==null?void 0:z.price)??((E=V[0])==null?void 0:E.price)??0),R=x>0?x:k;return R>0?`$${R.toFixed(2)}`:""})()})]}),e.jsxs("div",{className:"flex justify-between text-sm font-semibold border-t pt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bundle Total:"}),e.jsxs("span",{children:["$",ge().total.toFixed(2)]})]})]})})]})})]}):e.jsxs(Q,{children:[e.jsx(He,{className:"pb-3",children:e.jsx(Ke,{className:"text-sm",children:"Order Details"})}),e.jsxs(G,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Customer:"}),e.jsxs("span",{className:"font-medium",children:[d.customer.firstName," ",d.customer.lastName||""]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Items:"}),e.jsxs("span",{children:[((Je=d.giveaway)==null?void 0:Je.name)||(d.items&&d.items.length>0?(((Ct=d.items[0].productId)==null?void 0:Ct.name)||"Unknown Item")+(d.items[0].order_reference?` ${d.items[0].order_reference}`:""):"Unknown Item"),"(",d.giveaway?d.giveaway.quantity:d.items?d.items.reduce((x,k)=>x+(k.quantity||1),0):1," items)"]})]}),We()>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal:"}),e.jsxs("span",{className:"font-medium",children:["$",We().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tax:"}),e.jsx("span",{children:(d.tax??0)>0?`$${(d.tax??0).toFixed(2)}`:""})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Buyer Paid Shipping:"}),e.jsx("span",{children:(d.shipping_fee??0)>0?`$${(d.shipping_fee??0).toFixed(2)}`:""})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Your Shipping Cost:"}),e.jsx("span",{className:"text-red-600",children:(()=>{var E;const x=Number(d.seller_shipping_fee_pay??0),k=Number((z==null?void 0:z.price)??((E=V[0])==null?void 0:E.price)??0),R=x>0?x:k;return R>0?`-$${R.toFixed(2)}`:""})()})]}),(()=>{var B;const x=We(),k=d.tax||0,R=d.shipping_fee||0,E=d.seller_shipping_fee_pay||(z==null?void 0:z.price)||((B=V[0])==null?void 0:B.price)||0,L=x+k+R-Number(E);return L>0?e.jsxs("div",{className:"flex justify-between text-sm font-semibold border-t pt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Net Total:"}),e.jsxs("span",{children:["$",L.toFixed(2)]})]}):null})(),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order Date:"}),e.jsx("span",{children:d.createdAt?Z(new Date(d.createdAt),"MMM dd, yyyy"):"N/A"})]})]})]}),e.jsxs(Q,{children:[e.jsx(He,{className:"pb-3",children:e.jsxs(Ke,{className:"text-sm flex items-center gap-2",children:[e.jsx(Vr,{size:16}),o?"Bundle":"Package"," Dimensions & Weight"]})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-muted/30 rounded-md space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Order Information:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Weight: "}),e.jsxs("span",{className:"font-medium",children:[d.weight||"0"," ",we()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Dimensions: "}),e.jsx("span",{className:"font-medium",children:d.giveaway?`${d.giveaway.length||""}  ${d.giveaway.width||""}  ${d.giveaway.height||""} in`:`${d.length||""}  ${d.width||""}  ${d.height||""} in`})]})]})]}),e.jsx(Ve,{}),e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Editable Values for Estimates:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx($e,{htmlFor:"length",className:"text-xs",children:"Length (in)"}),e.jsx(mt,{id:"length",value:I.length,onChange:x=>_({...I,length:x.target.value}),placeholder:"11","data-testid":"input-length"})]}),e.jsxs("div",{children:[e.jsx($e,{htmlFor:"width",className:"text-xs",children:"Width (in)"}),e.jsx(mt,{id:"width",value:I.width,onChange:x=>_({...I,width:x.target.value}),placeholder:"6","data-testid":"input-width"})]}),e.jsxs("div",{children:[e.jsx($e,{htmlFor:"height",className:"text-xs",children:"Height (in)"}),e.jsx(mt,{id:"height",value:I.height,onChange:x=>_({...I,height:x.target.value}),placeholder:"0.25","data-testid":"input-height"})]})]}),e.jsxs("div",{children:[e.jsx($e,{htmlFor:"weight",className:"text-xs",children:"Weight (oz)"}),e.jsx(mt,{id:"weight",value:b,onChange:x=>Ie(x.target.value),placeholder:"1.5",className:"mt-1","data-testid":"input-weight"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(O,{onClick:Ge,variant:"outline",size:"sm",disabled:le.isLoading,"data-testid":"button-refresh-estimates",children:[e.jsx(Br,{size:14,className:`mr-1 ${le.isLoading?"animate-spin":""}`}),le.isLoading?"Loading...":"Refresh Estimates"]})})]})]}),e.jsxs(Q,{children:[e.jsx(He,{className:"pb-3",children:e.jsxs(Ke,{className:"text-sm flex items-center gap-2",children:[e.jsx(Vs,{size:16}),"Shipping Options"]})}),e.jsxs(G,{children:[le.error&&e.jsxs("div",{className:"mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:[e.jsxs("p",{className:"text-sm text-destructive",children:["Failed to fetch shipping estimates: ",le.error.message]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Please check package dimensions and weight, then try again."})]}),be&&be.amount>0&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md","data-testid":"alert-price-increase",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-300",children:" Shipping Cost Increased"}),e.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-400 mt-1",children:["The shipping cost has increased by ",e.jsxs("span",{className:"font-semibold",children:["$",be.amount.toFixed(2)]})," (",be.percentage.toFixed(1),"%). You will be charged the current price when purchasing the label."]})]}),!Y&&V.length===0&&!le.error&&e.jsx("div",{className:"mb-4 p-3 bg-muted/50 border border-muted rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter package dimensions and weight above to automatically calculate shipping costs."})}),Y&&!le.isLoading&&V.length===0&&!le.error&&e.jsx("div",{className:"mb-4 p-3 bg-muted/50 border border-muted rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading shipping estimates based on your package dimensions..."})}),e.jsx("div",{className:"space-y-3",children:V.map((x,k)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qe,{variant:"outline",className:"text-xs",children:x.carrier}),e.jsx("span",{className:"font-medium text-sm",children:x.service})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:x.deliveryTime})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-bold text-lg",children:["$",x.price]})}),e.jsxs(O,{onClick:()=>qt(x),disabled:Be.isPending,size:"sm","data-testid":`button-print-${x.carrier.toLowerCase()}-${x.service.replace(/\s+/g,"-").toLowerCase()}`,children:[e.jsx(Is,{size:14,className:"mr-1"}),Be.isPending?"Purchasing...":"Buy Label"]})]})]},k))})]})]}),(d.tracking_number||o&&c.some(x=>x.tracking_number))&&e.jsxs(Q,{children:[e.jsx(He,{className:"pb-3",children:e.jsx(Ke,{className:"text-sm",children:"Current Shipping Status"})}),e.jsx(G,{children:o?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-medium",children:"Bundle Status"}),c.filter(x=>x.tracking_number).map((x,k)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Order #",x.invoice||x._id.slice(-8)]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tracking: ",x.tracking_number]}),(x.seller_shipping_fee_pay??x.shipping_fee??0)>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Shipping Cost: $",(x.seller_shipping_fee_pay??x.shipping_fee??0).toFixed(2)]})]}),e.jsx(Qe,{variant:"outline",children:x.status})]},x._id))]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Tracking Number: ",d.tracking_number]}),(d.seller_shipping_fee_pay??d.shipping_fee??0)>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Shipping Cost: $",(d.seller_shipping_fee_pay??d.shipping_fee??0).toFixed(2)]})]}),e.jsx(Qe,{children:d.status})]})})]})]})]})]}),e.jsx(Sn,{open:S,onOpenChange:M,orderCount:1,onConfirm:nt,isPending:Be.isPending})]})}const ll={unfulfilled:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",shipping:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",delivered:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",cancelled:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",pickup:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400"};function dl({open:t,onOpenChange:a,bundleOrders:s,onUnbundle:r,isPending:i}){const[l,o]=u.useState([]),c=s.flatMap(m=>{var g,N,w;return m.giveaway?[{itemId:m._id,orderId:m._id,orderInvoice:((g=m.invoice)==null?void 0:g.toString())||m._id.slice(-8),productName:m.giveaway.name,productImage:(N=m.giveaway.images)==null?void 0:N[0],description:m.giveaway.description||"-",quantity:m.giveaway.quantity||1,weight:(w=m.giveaway.shipping_profile)!=null&&w.weight?`${m.giveaway.shipping_profile.weight} ${m.giveaway.shipping_profile.scale||""}`:"-",price:0,shipping:m.shipping_fee||0,orderType:"Giveaway",date:m.date?new Date(m.date).toLocaleDateString():"-",status:m.status||"unfulfilled"}]:m.items&&m.items.length>0?m.items.map((S,M)=>{var z,he,oe,fe,xe,Ce;return{itemId:S._id||`${m._id}-${M}`,orderId:m._id,orderInvoice:((z=m.invoice)==null?void 0:z.toString())||m._id.slice(-8),productName:(((he=S.productId)==null?void 0:he.name)||"Item")+(S.order_reference?` ${S.order_reference}`:""),productImage:(fe=(oe=S.productId)==null?void 0:oe.images)==null?void 0:fe[0],description:((Ce=(xe=S.productId)==null?void 0:xe.category)==null?void 0:Ce.name)||"-",quantity:S.quantity||1,weight:S.weight?`${S.weight} ${S.scale||""}`:"-",price:S.price||0,shipping:S.shipping_fee||0,orderType:m.ordertype||"Buy Now",date:m.date?new Date(m.date).toLocaleDateString():"-",status:m.status||"unfulfilled"}}):[]});u.useEffect(()=>{t&&o([])},[t]);const d=m=>{o(g=>g.includes(m)?g.filter(N=>N!==m):[...g,m])},h=()=>{l.length===c.length?o([]):o(c.map(m=>m.itemId))},p=()=>{if(l.length===0)return;const m=c.filter(g=>l.includes(g.itemId)).reduce((g,N)=>(g[N.orderId]||(g[N.orderId]=[]),g[N.orderId].push(N.itemId),g),{});r(m),o([]),a(!1)},y=()=>{o([]),a(!1)},j=m=>{m||o([]),a(m)};return e.jsx(Ze,{open:t,onOpenChange:j,children:e.jsxs(Xe,{className:"max-w-5xl max-h-[85vh] overflow-y-auto",children:[e.jsxs(et,{className:"pb-2",children:[e.jsx(tt,{className:"text-lg",children:"Select Items to Unbundle"}),e.jsx(vt,{className:"text-sm",children:"Choose items to unbundle. Selected items will be removed from this bundle."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs($e,{className:"text-xs text-muted-foreground",children:[l.length," of ",c.length," selected"]}),e.jsx(O,{variant:"outline",size:"sm",onClick:h,"data-testid":"button-select-all-items",className:"h-7 text-xs",children:l.length===c.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"overflow-x-auto border rounded-md",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground w-6",children:e.jsx(pt,{checked:l.length===c.length&&c.length>0,onCheckedChange:h,"data-testid":"checkbox-select-all-header"})}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Listing"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Category"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Qty"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Weight"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Price"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Ship"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Type"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Date"}),e.jsx("th",{className:"text-left py-1.5 px-1.5 font-medium text-muted-foreground",children:"Status"})]})}),e.jsx("tbody",{children:c.map(m=>{const g=l.includes(m.itemId);return e.jsxs("tr",{className:`border-b cursor-pointer hover:bg-muted/30 ${g?"bg-primary/5":""}`,onClick:()=>d(m.itemId),"data-testid":`row-item-${m.itemId}`,children:[e.jsx("td",{className:"py-1 px-1.5",onClick:N=>N.stopPropagation(),children:e.jsx(pt,{checked:g,onCheckedChange:()=>d(m.itemId),"data-testid":`checkbox-item-${m.itemId}`})}),e.jsx("td",{className:"py-1 px-1.5",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[m.productImage?e.jsx("img",{src:m.productImage,alt:m.productName,className:"w-7 h-7 object-cover rounded"}):e.jsx("div",{className:"w-7 h-7 bg-muted rounded flex items-center justify-center",children:e.jsx(ht,{size:12,className:"text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:m.productName}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["#",m.orderInvoice]})]})]})}),e.jsx("td",{className:"py-1 px-1.5 text-muted-foreground truncate max-w-[100px]",children:m.description}),e.jsx("td",{className:"py-1 px-1.5 text-center",children:m.quantity}),e.jsx("td",{className:"py-1 px-1.5",children:m.weight}),e.jsxs("td",{className:"py-1 px-1.5",children:["$",m.price.toFixed(2)]}),e.jsxs("td",{className:"py-1 px-1.5",children:["$",m.shipping.toFixed(2)]}),e.jsx("td",{className:"py-1 px-1.5 truncate max-w-[70px]",children:m.orderType}),e.jsx("td",{className:"py-1 px-1.5 text-[10px] text-muted-foreground",children:m.date}),e.jsx("td",{className:"py-1 px-1.5",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded-md text-[10px] ${ll[m.status]||"bg-gray-100 text-gray-800"}`,children:m.status})})]},m.itemId)})})]})})]}),e.jsxs(Tt,{children:[e.jsx(O,{variant:"outline",onClick:y,disabled:i,"data-testid":"button-cancel-unbundle",children:"Cancel"}),e.jsx(O,{onClick:p,disabled:l.length===0||i,"data-testid":"button-confirm-unbundle",children:i?"Unbundling...":`Unbundle ${l.length} Item${l.length!==1?"s":""}`})]})]})})}function cl({open:t,onOpenChange:a,order:s}){var w,S,M,z,he,oe;if(!s)return null;const r=s.tracking_number||((w=s.tracking_url)==null?void 0:w.split("=")[1]),i=s.label||s.shipping_label_url,l=s.carrier||"USPS",o=s.servicelevel||s.service||"Standard",c=s.shipping_fee||s.total_shipping_cost||0,d=s.seller_shipping_fee_pay||0,h=((M=(S=s.giveaway)==null?void 0:S.shipping_profile)==null?void 0:M.weight)||s.weight,p=h?h.toString():"0",y=((he=(z=s.giveaway)==null?void 0:z.shipping_profile)==null?void 0:he.scale)||"oz",j=s.giveaway?s.giveaway.length:s.length,m=s.giveaway?s.giveaway.width:s.width,g=s.giveaway?s.giveaway.height:s.height,N=(oe=s.customer)==null?void 0:oe.address;return e.jsx(Us,{open:t,onOpenChange:a,children:e.jsxs(Hs,{className:"w-full sm:max-w-lg overflow-y-auto",children:[e.jsx(Ks,{children:e.jsxs(Ys,{className:"flex items-center gap-2",children:[e.jsx(Vs,{className:"h-5 w-5"}),"Shipment Details"]})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[r&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{className:"font-medium",children:"Tracking Information"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-md p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Tracking Number"}),e.jsx("p",{className:"font-mono text-sm font-medium",children:r})]}),s.tracking_url&&e.jsxs(O,{variant:"outline",size:"sm",className:"w-full",onClick:()=>window.open(s.tracking_url,"_blank"),"data-testid":"button-track-package",children:[e.jsx(sn,{className:"h-4 w-4 mr-2"}),"Track Package"]})]})]}),i&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Shipping Label"}),e.jsxs(O,{variant:"outline",size:"sm",className:"w-full",onClick:()=>window.open(i,"_blank"),"data-testid":"button-download-label",children:[e.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Download Label"]})]}),e.jsx(Ve,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Service Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Carrier"}),e.jsx(Qe,{variant:"secondary",children:l})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Service"}),e.jsx("p",{className:"text-sm",children:o})]})]})]}),e.jsx(Ve,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Shipping Costs"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Buyer Paid"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",c.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Your Cost"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",d.toFixed(2)]})]})]})]}),(p||j&&m&&g)&&e.jsxs(e.Fragment,{children:[e.jsx(Ve,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Package Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Weight"}),e.jsxs("p",{className:"text-sm",children:[p," ",y]})]}),j&&m&&g&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Dimensions"}),e.jsxs("p",{className:"text-sm",children:[j,"  ",m,"  ",g,'"']})]})]})]})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx(Ve,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qr,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{className:"font-medium",children:"Shipping Address"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-md p-4 space-y-1 text-sm",children:[(N.firstName||N.lastName)&&e.jsxs("p",{className:"font-medium",children:[N.firstName," ",N.lastName]}),N.addrress1&&e.jsx("p",{children:N.addrress1}),N.addrress2&&e.jsx("p",{children:N.addrress2}),e.jsxs("p",{children:[N.city,", ",N.state," ",N.zipcode]}),N.country&&e.jsx("p",{children:N.country})]})]})]}),e.jsx(Ve,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Order Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Order ID"}),e.jsxs("p",{className:"font-mono",children:["#",s.invoice||s._id.slice(-8)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Status"}),e.jsx(Qe,{variant:"outline",children:s.status})]})]})]})]})]})})}function ul({open:t,onOpenChange:a,scanForms:s,isLoading:r=!1}){const i=o=>{window.open(o,"_blank")},l=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleString()}catch{return o}};return e.jsx(Ze,{open:t,onOpenChange:a,children:e.jsxs(Xe,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(et,{children:[e.jsx(tt,{children:"USPS SCAN Forms"}),e.jsx(vt,{children:"View and download your USPS SCAN forms for batch shipments"})]}),r?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading scan forms..."})}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ur,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No scan forms found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Generate shipping labels and create a SCAN form to see them here"})]}):e.jsx("div",{className:"space-y-4 py-4",children:s.map((o,c)=>e.jsxs(Q,{children:[e.jsx(He,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(Ke,{className:"text-base",children:["USPS SCAN Form ",s.length>1?`${c+1}`:""]}),o.created_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Created: ",l(o.created_at)]})]}),o.status&&e.jsx(Qe,{variant:o.status==="success"?"default":"secondary",children:o.status})]})}),e.jsx(G,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.carrier&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Carrier:"}),e.jsx("span",{className:"ml-2 font-medium",children:o.carrier})]}),o.shipment_count!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipments:"}),e.jsx("span",{className:"ml-2 font-medium",children:o.shipment_count})]})]})}),e.jsx(kr,{className:"gap-2 flex-wrap",children:o.scan_form_url?e.jsxs(e.Fragment,{children:[e.jsxs(O,{size:"sm",onClick:()=>i(o.scan_form_url),"data-testid":`button-view-form-${c}`,children:[e.jsx(sn,{className:"h-4 w-4 mr-2"}),"View Form"]}),e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>{const d=document.createElement("a");d.href=o.scan_form_url,d.download=`scan-form-${o.manifest_id}.pdf`,d.click()},"data-testid":`button-download-form-${c}`,children:[e.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Download"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan form URL not available"})})]},o.manifest_id||c))})]})})}var ks,zt="HoverCard",[Dn]=Ka(zt,[Rt]),Bt=Rt(),[ml,ia]=Dn(zt),Pn=t=>{const{__scopeHoverCard:a,children:s,open:r,defaultOpen:i,onOpenChange:l,openDelay:o=700,closeDelay:c=300}=t,d=Bt(a),h=u.useRef(0),p=u.useRef(0),y=u.useRef(!1),j=u.useRef(!1),[m,g]=Ua({prop:r,defaultProp:i??!1,onChange:l,caller:zt}),N=u.useCallback(()=>{clearTimeout(p.current),h.current=window.setTimeout(()=>g(!0),o)},[o,g]),w=u.useCallback(()=>{clearTimeout(h.current),!y.current&&!j.current&&(p.current=window.setTimeout(()=>g(!1),c))},[c,g]),S=u.useCallback(()=>g(!1),[g]);return u.useEffect(()=>()=>{clearTimeout(h.current),clearTimeout(p.current)},[]),e.jsx(ml,{scope:a,open:m,onOpenChange:g,onOpen:N,onClose:w,onDismiss:S,hasSelectionRef:y,isPointerDownOnContentRef:j,children:e.jsx(Ha,{...d,children:s})})};Pn.displayName=zt;var On="HoverCardTrigger",Mn=u.forwardRef((t,a)=>{const{__scopeHoverCard:s,...r}=t,i=ia(On,s),l=Bt(s);return e.jsx(Ws,{asChild:!0,...l,children:e.jsx(Ls.a,{"data-state":i.open?"open":"closed",...r,ref:a,onPointerEnter:ne(t.onPointerEnter,$t(i.onOpen)),onPointerLeave:ne(t.onPointerLeave,$t(i.onClose)),onFocus:ne(t.onFocus,i.onOpen),onBlur:ne(t.onBlur,i.onClose),onTouchStart:ne(t.onTouchStart,o=>o.preventDefault())})})});Mn.displayName=On;var hl="HoverCardPortal",[vd,pl]=Dn(hl,{forceMount:void 0}),At="HoverCardContent",Fn=u.forwardRef((t,a)=>{const s=pl(At,t.__scopeHoverCard),{forceMount:r=s.forceMount,...i}=t,l=ia(At,t.__scopeHoverCard);return e.jsx(zs,{present:r||l.open,children:e.jsx(fl,{"data-state":l.open?"open":"closed",...i,onPointerEnter:ne(t.onPointerEnter,$t(l.onOpen)),onPointerLeave:ne(t.onPointerLeave,$t(l.onClose)),ref:a})})});Fn.displayName=At;var fl=u.forwardRef((t,a)=>{const{__scopeHoverCard:s,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:o,...c}=t,d=ia(At,s),h=Bt(s),p=u.useRef(null),y=Rs(a,p),[j,m]=u.useState(!1);return u.useEffect(()=>{if(j){const g=document.body;return ks=g.style.userSelect||g.style.webkitUserSelect,g.style.userSelect="none",g.style.webkitUserSelect="none",()=>{g.style.userSelect=ks,g.style.webkitUserSelect=ks}}},[j]),u.useEffect(()=>{if(p.current){const g=()=>{m(!1),d.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var w;((w=document.getSelection())==null?void 0:w.toString())!==""&&(d.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",g),()=>{document.removeEventListener("pointerup",g),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!1}}},[d.isPointerDownOnContentRef,d.hasSelectionRef]),u.useEffect(()=>{p.current&&vl(p.current).forEach(N=>N.setAttribute("tabindex","-1"))}),e.jsx(Ya,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:o,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:ne(l,g=>{g.preventDefault()}),onDismiss:d.onDismiss,children:e.jsx(Va,{...h,...c,onPointerDown:ne(c.onPointerDown,g=>{g.currentTarget.contains(g.target)&&m(!0),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!0}),ref:y,style:{...c.style,userSelect:j?"text":void 0,WebkitUserSelect:j?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),xl="HoverCardArrow",gl=u.forwardRef((t,a)=>{const{__scopeHoverCard:s,...r}=t,i=Bt(s);return e.jsx(Qa,{...i,...r,ref:a})});gl.displayName=xl;function $t(t){return a=>a.pointerType==="touch"?void 0:t()}function vl(t){const a=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;s.nextNode();)a.push(s.currentNode);return a}var yl=Pn,jl=Mn,In=Fn;const bl=yl,Nl=jl,Tn=u.forwardRef(({className:t,align:a="center",sideOffset:s=4,...r},i)=>e.jsx(In,{ref:i,align:a,sideOffset:s,className:Ye("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]",t),...r}));Tn.displayName=In.displayName;const Ss={unfulfilled:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",processing:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",progressing:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",ready_to_ship:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",shipped:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",shipping:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",delivered:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",cancelled:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",pending_cancellation:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",pickup:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400"};function yd(){var ya;const[t,a]=u.useState([]),[s,r]=u.useState([]),[i,l]=u.useState("all"),[o,c]=u.useState("all"),[d,h]=u.useState(""),[p,y]=u.useState(!1),[j,m]=u.useState(null),[g,N]=u.useState(!1),[w,S]=u.useState(1),[M,z]=u.useState(20),[he,oe]=u.useState(!1),[fe,xe]=u.useState(null),[Ce,be]=u.useState(!1),[Ne,ge]=u.useState(null),[We,ze]=u.useState(!1),[at,we]=u.useState(!1),[I,_]=u.useState(null),[b,Ie]=u.useState(null),[Y,_e]=u.useState(null),[Te,Ee]=u.useState(!1),[le,V]=u.useState(null),[Ge,Be]=u.useState(null),[qt,nt]=u.useState(!1),[wt,Je]=u.useState(!1),[Ct,x]=u.useState([]),[k,R]=u.useState(!1),[E,L]=u.useState(!1),[B,q]=u.useState(!1),[qe,de]=u.useState(null),[ke,Ae]=u.useState(null),[oa,Ut]=u.useState(""),[la,Ht]=u.useState(!1),[En,Kt]=u.useState(!1),[da,Yt]=u.useState(null),[An,Vt]=u.useState(!1),[ce,ca]=u.useState(void 0),[ue,ua]=u.useState(void 0),{user:v}=Cr(),{toast:P}=Ga(),T=Ja(),Qt=ae({mutationFn:async({orderId:n,relist:f})=>{const C=await fetch("/api/orders/cancel/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:n,initiator:"seller",type:"order",relist:f,description:"Order cancelled by seller"})});if(!C.ok)throw new Error("Failed to cancel order");return C.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),P({title:"Order cancelled successfully"}),m(null),N(!1)},onError:()=>{P({title:"Failed to cancel order",variant:"destructive"})}}),$n=()=>{j&&Qt.mutate({orderId:j,relist:g})},Rn=ae({mutationFn:async n=>{const f=await fetch(`/api/orders/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"shipped"})});if(!f.ok)throw new Error("Failed to mark order as shipped");return f.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),P({title:"Order marked as shipped"})},onError:()=>{P({title:"Failed to mark order as shipped",variant:"destructive"})}}),Ln=n=>{Rn.mutate(n)},_t=ae({mutationFn:async({orderId:n,itemId:f,relist:C})=>{const F={order:n,description:f?"Item cancellation approved by seller":"Order cancellation approved by seller",relist:C};f&&(F.item=f);const W=await fetch("/api/orders/cancel/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok)throw new Error("Failed to approve cancellation");return W.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),P({title:"Cancellation request approved"}),L(!1),de(null),Ae(null),Ht(!1)},onError:()=>{P({title:"Failed to approve cancellation",variant:"destructive"})}}),kt=ae({mutationFn:async({orderId:n,itemId:f,reason:C})=>{const F={order:n,description:C||(f?"Item cancellation declined by seller":"Order cancellation declined by seller")};f&&(F.item=f);const W=await fetch("/api/orders/cancel/decline",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok)throw new Error("Failed to decline cancellation");return W.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),P({title:"Cancellation request declined"}),q(!1),de(null),Ae(null),Ut("")},onError:()=>{P({title:"Failed to decline cancellation",variant:"destructive"})}}),Wn=()=>{qe&&_t.mutate({orderId:qe,itemId:ke||void 0,relist:la})},zn=()=>{qe&&kt.mutate({orderId:qe,itemId:ke||void 0,reason:oa})},ma=ae({mutationFn:async({orderId:n,itemIds:f})=>{const C=await fetch("/api/orders/unbundle/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:n,itemIds:f})});if(!C.ok)throw new Error("Failed to unbundle items");return C.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/bundles"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),P({title:"Items unbundled successfully",description:"Selected items have been created as separate orders"}),ge(null),be(!1)},onError:()=>{P({title:"Failed to unbundle items",variant:"destructive"})}}),Bn=n=>{Ne&&n.length>0&&ma.mutate({orderId:Ne,itemIds:n})},Gt=ae({mutationFn:async({tokshow:n,carrierAccount:f,ownerId:C})=>{const F=await fetch("/api/shipping/generate/manifest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokshow:n,carrierAccount:f,ownerId:C})}),W=await F.json();if(!F.ok)throw new Error(W.message||W.error);return W},onSuccess:n=>{var f;T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/rooms","ended",v==null?void 0:v.id]}),T.invalidateQueries({queryKey:["show-orders-all",v==null?void 0:v.id,o]}),V(null),n.manifest_id?(Be(n.manifest_id),P({title:"Scan form generation started",description:n.message||"SCAN Form generation has been initiated"})):((f=n.manifest)==null?void 0:f.object_state)!=="VALID"?P({title:"Scan form generation in progress",description:n.message||"SCAN Form is being generated, retry later"}):P({title:"Success",description:n.message||"SCAN Form generated successfully"}),Ee(!1)},onError:n=>{V(n.message),P({title:"Error",description:n.message,variant:"destructive"})}}),Jt=ae({mutationFn:async({manifestId:n,tokshow:f,orderIds:C,type:F,status:W})=>{const X=new URLSearchParams;X.set("tokshow",f),F&&X.set("type",F),W&&X.set("status",W),C&&C.length>0&&X.set("orderIds",JSON.stringify(C));const ee=await fetch(`/api/shipping/generate/manifest/${n}?${X.toString()}`,{method:"GET"}),Oe=await ee.json();if(!ee.ok)throw new Error(Oe.message||Oe.error||"Failed to fetch scan form");return Oe},onSuccess:n=>{n.scan_form_url?window.open(n.scan_form_url,"_blank"):P({title:"Scan form not ready",description:n.message||"The scan form is still being generated. Please try again in a moment."})},onError:n=>{P({title:"Error",description:n.message,variant:"destructive"})}}),qn=n=>{S(n)},Un=n=>{z(n),S(1)},rt=()=>{S(1)},Hn=n=>{l(n),rt()},Kn=n=>{c(n),rt()},Yn=n=>{ca(n),rt()},Vn=n=>{ua(n),rt()},Qn=()=>{l("all"),c("all"),ca(void 0),ua(void 0),rt()},{data:Zt}=Ue({queryKey:["/api/rooms","ended",v==null?void 0:v.id],queryFn:async()=>{const n=new URLSearchParams;n.set("status","ended"),v!=null&&v.id&&n.set("userid",v.id);const f=await fetch(`/api/rooms?${n.toString()}`);if(!f.ok)throw new Error("Failed to fetch ended shows");return f.json()},enabled:!!(v!=null&&v.id)}),Xt=(Zt==null?void 0:Zt.rooms)||[],pe=Xt.find(n=>n._id===o),Gn=o==="marketplace",Jn=()=>{if(!o||o==="all"){P({title:"Cannot generate scan form",description:"Please select a specific show or marketplace to generate a scan form",variant:"destructive"});return}nt(!1),V(null),Ee(!0)},Zn=()=>{var n;if(o&&o!=="all"){const f=o==="marketplace"?null:o,C=pe==null?void 0:pe.carrierAccount,F=((n=pe==null?void 0:pe.owner)==null?void 0:n._id)||(pe==null?void 0:pe.owner)||(v==null?void 0:v.id)||"";Gt.mutate({tokshow:f,carrierAccount:C,ownerId:F})}},Xn=async()=>{if(!o||o==="all"){P({title:"Cannot view scan form",description:"Please select a specific show or marketplace",variant:"destructive"});return}try{R(!0),Je(!0);const n=o==="marketplace",f={};n?f.type="marketplace":f.tokshow=o,i!=="all"&&(f.status=i);const C=await fetch("/api/shipping/generate/manifest/view",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),F=await C.json();if(!C.ok)throw new Error(F.message||F.error||"Failed to fetch scan forms");const W=F.forms||[];x(W)}catch(n){P({title:"Failed to fetch scan forms",description:n instanceof Error?n.message:"Unknown error occurred",variant:"destructive"}),x([]),Je(!1)}finally{R(!1)}},er=()=>{const n=ar||Ge;n?Jt.mutate({manifestId:n,tokshow:o}):P({title:"No manifest found",description:"Unable to check status",variant:"destructive"})};u.useEffect(()=>{Be(null)},[o]);const{data:Se,isLoading:St,isError:Dt,error:es,refetch:tr}=Ue({queryKey:["show-orders-all",v==null?void 0:v.id,o],queryFn:async()=>{const n=new URLSearchParams;v!=null&&v.id&&n.set("userId",v.id),o&&o!=="all"&&(o==="marketplace"?n.set("marketplace","true"):n.set("tokshow",o));const f=await fetch(`/api/orders?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error(`External API error: ${f.status}`);return f.json()},enabled:!!(v!=null&&v.id)&&!!o&&o!=="all",staleTime:0}),ts=(Se==null?void 0:Se.orders)||[],sr=(Se==null?void 0:Se.total)||0,it=ts.filter(n=>!n.shipment_id),ss=Se&&!St&&!Dt?it.length===0:!1,Pt=ts.find(n=>n.manifest_id&&n.manifest_id.trim()!==""),as=!!Pt,ar=(Pt==null?void 0:Pt.manifest_id)||null,ns=!!ts.find(n=>n.scan_form_url&&n.scan_form_url.trim()!==""),ha=Gn||ns||as||Ge,{data:U,isLoading:nr,error:rs,isError:is,refetch:pa}=Ue({queryKey:["/api/shipping/metrics",v==null?void 0:v.id,ce==null?void 0:ce.toISOString(),ue==null?void 0:ue.toISOString(),o],queryFn:async()=>{const n=new URLSearchParams;v!=null&&v.id&&n.set("userId",v.id),ce&&n.set("startDate",It(ce).toISOString()),ue&&n.set("endDate",Ia(ue).toISOString()),o&&o!=="all"&&(o==="marketplace"?n.set("marketplace","true"):n.set("tokshow",o));const f=await fetch(`/api/shipping/metrics?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error(`External API error: ${f.status}`);return f.json()},enabled:!!(v!=null&&v.id),staleTime:0,refetchOnMount:!0}),{data:De,isLoading:rr,error:os,isError:ls,refetch:fa}=Ue({queryKey:["external-orders",v==null?void 0:v.id,i,o,w,M,ce==null?void 0:ce.toISOString(),ue==null?void 0:ue.toISOString()],queryFn:async()=>{const n=new URLSearchParams;v!=null&&v.id&&n.set("userId",v.id),i&&i!=="all"&&n.set("status",i),o&&o!=="all"&&(o==="marketplace"?n.set("marketplace","true"):n.set("tokshow",o)),ce&&n.set("startDate",It(ce).toISOString()),ue&&n.set("endDate",Ia(ue).toISOString()),n.set("page",w.toString()),n.set("limit",M.toString());const f=await fetch(`/api/orders?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error(`External API error: ${f.status}`);return f.json()},enabled:!!(v!=null&&v.id),staleTime:0,refetchOnMount:!0}),Pe=(De==null?void 0:De.orders)||[],ir=(De==null?void 0:De.total)||0,or=(De==null?void 0:De.pages)||0,{data:ds,refetch:Cl}=Ue({queryKey:["external-orders",v==null?void 0:v.id,"all","all"],queryFn:async()=>{const n=new URLSearchParams;v!=null&&v.id&&n.set("userId",v.id);const f=await fetch(`/api/orders?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error(`External API error: ${f.status}`);return f.json()},enabled:!!(v!=null&&v.id),staleTime:0,refetchOnMount:!0}),cs=(ds==null?void 0:ds.orders)||[],{data:_l,isLoading:lr,error:us,isError:ms,refetch:xa}=Ue({queryKey:["/api/bundles",v==null?void 0:v.id],queryFn:async()=>{if(!(v!=null&&v.id))throw new Error("User ID required");const n=await fetch(`/api/bundles?userId=${v.id}`);if(!n.ok)throw new Error("Failed to fetch bundles");return n.json()},enabled:!!(v!=null&&v.id),staleTime:0,refetchOnMount:!0});u.useEffect(()=>{const n=sessionStorage.getItem("openShipmentDrawer");if(n)try{const f=JSON.parse(n);_(f),we(!0),sessionStorage.removeItem("openShipmentDrawer")}catch(f){console.error("Failed to parse order from sessionStorage:",f),sessionStorage.removeItem("openShipmentDrawer")}},[]);const hs=(Pe||[]).sort((n,f)=>{var W,X,ee,Oe,lt,A;if(b&&Y){let te=0;if(b==="customer"){const H=typeof n.customer=="object"?`${((W=n.customer)==null?void 0:W.firstName)||""} ${((X=n.customer)==null?void 0:X.lastName)||""}`.trim():"",se=typeof f.customer=="object"?`${((ee=f.customer)==null?void 0:ee.firstName)||""} ${((Oe=f.customer)==null?void 0:Oe.lastName)||""}`.trim():"";te=H.localeCompare(se)}else if(b==="orderDate"){const H=n.createdAt?new Date(n.createdAt).getTime():0,se=f.createdAt?new Date(f.createdAt).getTime():0;te=H-se}else if(b==="items"){const H=n.giveaway?1:((lt=n.items)==null?void 0:lt.length)||0,se=f.giveaway?1:((A=f.items)==null?void 0:A.length)||0;te=H-se}else if(b==="total"){const H=(n.total||0)+(n.tax||0)+(n.shipping_fee||0),se=(f.total||0)+(f.tax||0)+(f.shipping_fee||0);te=H-se}else if(b==="status"){const H=n.status||"",se=f.status||"";te=H.localeCompare(se)}return Y==="asc"?te:-te}const C=n.createdAt?new Date(n.createdAt):new Date(0);return(f.createdAt?new Date(f.createdAt):new Date(0)).getTime()-C.getTime()}),dr=(n,f)=>{const C=Pe==null?void 0:Pe.find(F=>F._id===n);if(f&&(C==null?void 0:C.status)!=="processing"){P({title:"Only processing orders can be bundled",variant:"destructive"});return}a(f?[...t,n]:t.filter(F=>F!==n))},cr=n=>{if(n){const f=Pe.filter(C=>C.status==="processing").map(C=>C._id);a(f)}else a([])},ur=n=>{s.includes(n)?r(s.filter(f=>f!==n)):r([...s,n])},ot=n=>{b===n?Y==="asc"?_e("desc"):Y==="desc"&&(Ie(null),_e(null)):(Ie(n),_e("asc"))},ga=ae({mutationFn:async n=>{if(!(v!=null&&v.id))throw new Error("User ID required");const f=await fetch("/api/orders/bundle/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,userId:v.id})});if(!f.ok){const C=await f.json().catch(()=>({message:"Failed to create bundle"}));throw new Error(C.message||"Failed to create bundle")}return f.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/bundles"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),a([]),h(""),y(!1),P({title:"Bundle created successfully"})},onError:n=>{P({title:"Failed to create bundle",description:n.message,variant:"destructive"})}});ae({mutationFn:async({bundleId:n,orderIds:f})=>{if(!(v!=null&&v.id))throw new Error("User ID required");const C=await fetch(`/api/bundles/${n}?userId=${v.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:f?JSON.stringify({orderIds:f}):void 0});if(!C.ok)throw new Error("Failed to unbundle orders");return C.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/bundles"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),P({title:"Orders unbundled successfully"})},onError:()=>{P({title:"Failed to unbundle orders",variant:"destructive"})}}),ae({mutationFn:async({bundleId:n,relist:f})=>{if(!(v!=null&&v.id))throw new Error("User ID required");const C=(cs==null?void 0:cs.filter(ee=>ee.bundleId===n))||[],F=C.map(ee=>fetch(`/api/orders/${ee._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"cancelled",relist:f})})),X=(await Promise.all(F)).filter(ee=>!ee.ok);if(X.length>0)throw new Error(`Failed to cancel ${X.length} orders in bundle`);return{cancelledOrders:C.length}},onSuccess:n=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/bundles"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),P({title:`Bundle cancelled - ${n.cancelledOrders} orders cancelled`}),m(null),N(!1)},onError:n=>{P({title:"Failed to cancel bundle",description:n.message,variant:"destructive"})}}),ae({mutationFn:async n=>{const f=await fetch(`/api/orders/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"shipped"})});if(!f.ok){const C=await f.json().catch(()=>({message:"Failed to mark order as shipped"}));throw new Error(C.message||"Failed to mark order as shipped")}return f.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),P({title:"Order marked as shipped"})},onError:n=>{P({title:"Failed to mark order as shipped",description:n.message,variant:"destructive"})}}),ae({mutationFn:async n=>{if(!(v!=null&&v.id))throw new Error("User ID required");const f=await fetch(`/api/orders/bundle/${n}/ship`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:v.id})});if(!f.ok){const C=await f.json().catch(()=>({error:"Failed to mark bundle as shipped"}));throw new Error(C.error||"Failed to mark bundle as shipped")}return f.json()},onSuccess:n=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/bundles"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),P({title:`Bundle shipped - ${n.shippedOrders} orders marked as shipped`})},onError:n=>{P({title:"Failed to ship bundle",description:n.message,variant:"destructive"})}});const mr=()=>{if(t.length<2){P({title:"Select at least 2 orders to bundle",variant:"destructive"});return}y(!0)},hr=()=>{ga.mutate({orderIds:t})},va=ae({mutationFn:async({orderIds:n,labelFileType:f,carrierAccount:C})=>{if(!(v!=null&&v.id))throw new Error("User ID required");const F=await fetch("/api/shipping/bulk-labels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderIds:n,labelFileType:f,userId:v.id,carrierAccount:C})});if(!F.ok){const W=await F.json().catch(()=>({message:"Failed to purchase labels"}));throw new Error(W.message||"Failed to purchase labels")}return F.json()},onSuccess:n=>{T.invalidateQueries({queryKey:["external-orders"]}),T.invalidateQueries({queryKey:["/api/shipping/metrics"]}),T.invalidateQueries({queryKey:["show-orders-all",v==null?void 0:v.id,o]}),a([]),ze(!1),P({title:`${n.successCount||t.length} label(s) purchased successfully`,description:n.failureCount?`${n.failureCount} label(s) failed`:void 0})},onError:n=>{P({title:"Failed to purchase labels",description:n.message,variant:"destructive"})}}),pr=()=>{if(t.length===0){P({title:"No orders selected",description:"Please select at least one order to purchase labels",variant:"destructive"});return}ze(!0)},fr=n=>{const f=pe==null?void 0:pe.carrierAccount;va.mutate({orderIds:t,labelFileType:n,carrierAccount:f})};if(nr||rr||lr)return e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"px-4 sm:px-6 md:px-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-48 mb-8"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:Array.from({length:6}).map((n,f)=>e.jsx("div",{className:"h-20 bg-muted rounded"},f))}),e.jsx("div",{className:"h-96 bg-muted rounded"})]})})});if(is||ls||ms){const n=[];return is&&n.push("metrics"),ls&&n.push("orders"),ms&&n.push("bundles"),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"px-4 sm:px-6 md:px-8",children:e.jsx(Q,{className:"max-w-md mx-auto mt-8",children:e.jsx(G,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-destructive text-5xl mb-4",children:""}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Failed to Load Shipping Data"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:(os==null?void 0:os.message)||(rs==null?void 0:rs.message)||(us==null?void 0:us.message)||`Something went wrong while loading your ${n.join(", ")}. Please try again.`}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[is&&e.jsx(O,{onClick:()=>pa(),variant:"outline",size:"sm","data-testid":"button-retry-metrics",children:"Retry Metrics"}),ls&&e.jsx(O,{onClick:()=>fa(),variant:"outline",size:"sm","data-testid":"button-retry-orders",children:"Retry Orders"}),ms&&e.jsx(O,{onClick:()=>xa(),variant:"outline",size:"sm","data-testid":"button-retry-bundles",children:"Retry Bundles"}),e.jsx(O,{onClick:()=>{pa(),fa(),xa()},"data-testid":"button-retry-all",children:"Retry All"})]})]})})})})})}return e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"px-4 sm:px-6 md:px-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground","data-testid":"text-shipments-title",children:"Shipments"}),e.jsxs("div",{className:"mt-1 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"View shipments by live show or marketplace"}),e.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground",children:[Z(new Date,"MM/dd/yyyy 'at' h:mm a"),"  Shipping Complete"]})]})]}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"w-full grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4",children:[e.jsx(Q,{className:"border-2 border-accent bg-accent/10",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-total-sold",children:["$",(U==null?void 0:U.totalSold)||"0"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Sold"})]})}),e.jsx(Q,{className:"border border-border",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-total-earned",children:["$",(U==null?void 0:U.totalEarned)||"0"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Earned (Paid Out)"})]})}),e.jsx(Q,{className:"border border-border",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-shipping-spend",children:["$",(U==null?void 0:U.totalShippingSpend)||"0"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Shipping Spend"})]})}),e.jsx(Q,{className:"border border-border",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-items-sold",children:(U==null?void 0:U.itemsSold)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Items sold"})]})}),e.jsx(Q,{className:"border border-border",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-total-delivered",children:(U==null?void 0:U.totalDelivered)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Delivered"})]})}),e.jsx(Q,{className:"border border-border",children:e.jsxs(G,{className:"p-3 sm:p-4 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-foreground","data-testid":"metric-pending-delivery",children:(U==null?void 0:U.pendingDelivery)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending Delivery"})]})})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsx("div",{className:"w-full sm:w-auto sm:min-w-64 sm:max-w-md",children:e.jsxs(Ds,{value:o,onValueChange:Kn,children:[e.jsx(Ps,{"data-testid":"select-show",children:e.jsx(Os,{placeholder:"Filter by show..."})}),e.jsxs(Ms,{children:[e.jsx(ve,{value:"all",children:"All Shows & Marketplace"}),e.jsx(ve,{value:"marketplace",children:"Marketplace"}),Xt.map(n=>{const f=n.date||n.startDate||n.createdAt,C=f?`  ${Z(new Date(f),"d MMM  HH:mm")}`:"",F=n.title||`Show #${n._id.slice(-8)}`;return e.jsx(ve,{value:n._id,children:e.jsxs("span",{className:"block",children:[e.jsx("span",{className:"font-medium",children:F}),C&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:C})]})]})},n._id)})]})]})}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs(Ds,{value:i,onValueChange:Hn,children:[e.jsx(Ps,{"data-testid":"select-status",children:e.jsx(Os,{placeholder:"Filter by status..."})}),e.jsxs(Ms,{children:[e.jsx(ve,{value:"all",children:"All"}),e.jsx(ve,{value:"unfulfilled",children:"Unfulfilled"}),e.jsx(ve,{value:"processing",children:"Need Label"}),e.jsx(ve,{value:"ready_to_ship",children:"Ready to Ship"}),e.jsx(ve,{value:"shipped",children:"Shipped"}),e.jsx(ve,{value:"delivered",children:"Delivered"}),e.jsx(ve,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs(Ba,{children:[e.jsx(qa,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full sm:w-[160px] justify-start text-left font-normal","data-testid":"button-date-from",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),ce?Z(ce,"MMM d, yyyy"):"From date"]})}),e.jsx($s,{className:"w-auto p-0",align:"start",children:e.jsx(As,{mode:"single",selected:ce,onSelect:Yn,initialFocus:!0})})]})}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs(Ba,{children:[e.jsx(qa,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full sm:w-[160px] justify-start text-left font-normal","data-testid":"button-date-to",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),ue?Z(ue,"MMM d, yyyy"):"To date"]})}),e.jsx($s,{className:"w-auto p-0",align:"start",children:e.jsx(As,{mode:"single",selected:ue,onSelect:Vn,initialFocus:!0})})]})}),e.jsxs(O,{variant:"outline",onClick:Qn,"data-testid":"button-reset-filters",className:"w-full sm:w-auto",children:[e.jsx(wa,{size:16,className:"mr-1"}),"Reset Filters"]}),i==="unfulfilled"&&e.jsxs("div",{className:"w-full sm:w-auto sm:ml-auto",children:[e.jsx(O,{variant:"default",disabled:!o||o==="all",onClick:()=>nt(!0),"data-testid":"button-open-shipping-actions",className:"w-full sm:w-auto whitespace-nowrap",children:ha?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{size:16,className:"mr-1"}),"View SCAN Form"]}):e.jsxs(e.Fragment,{children:[e.jsx(Qr,{size:16,className:"mr-1"}),"Shipping Actions"]})}),e.jsx(Us,{open:qt,onOpenChange:nt,children:e.jsxs(Hs,{className:"w-full sm:max-w-md overflow-y-auto","data-testid":"sheet-shipping-actions",children:[e.jsx(Ks,{className:"mb-6",children:e.jsx(Ys,{children:"Shipping Actions"})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border border-border rounded-md p-4",children:[e.jsx("h3",{className:"font-semibold text-base mb-2",children:"Shipping actions"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["These actions apply to all shipments in your ",o==="marketplace"?"marketplace":"show","."]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{variant:"default",className:"w-full justify-start","data-testid":"button-export-labels",children:[e.jsx(Qs,{size:16,className:"mr-2"}),"Export shipping labels/slips"]}),ha&&e.jsxs(O,{variant:"default",className:"w-full justify-start",onClick:Xn,"data-testid":"button-view-scan",children:[e.jsx(Mt,{size:16,className:"mr-2"}),"View USPS SCAN Form"]}),e.jsxs(O,{variant:"outline",className:"w-full justify-start",onClick:Jn,"data-testid":"button-generate-scan",children:[e.jsx(Gr,{size:16,className:"mr-2"}),ns||as||Ge?"Regenerate USPS SCAN Form":"Generate USPS SCAN Form"]}),!ns&&(as||Ge)&&e.jsxs(O,{variant:"outline",className:"w-full justify-start",onClick:er,disabled:Jt.isPending,"data-testid":"button-check-scan-status",children:[e.jsx(Fs,{size:16,className:"mr-2"}),Jt.isPending?"Checking...":"Check Status"]}),e.jsxs(O,{variant:"outline",className:"w-full justify-start","data-testid":"button-mark-all-shipped",children:[e.jsx(Vs,{size:16,className:"mr-2"}),"Mark All Packages As Shipped"]})]})]})})]})})]})]})}),e.jsx(Ca,{open:Te,onOpenChange:Ee,children:e.jsxs(_a,{"data-testid":"dialog-scan-form",children:[e.jsxs(ka,{children:[e.jsx(Sa,{"data-testid":"text-scan-form-title",children:"Generate USPS Scan Form"}),e.jsx(Da,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md p-3","data-testid":"text-scan-form-warning",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium",children:" Important: This scan form can only be generated once and cannot be regenerated."})}),St&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-3","data-testid":"text-scan-form-loading",children:e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"Loading order information..."})}),Dt&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-3","data-testid":"text-scan-form-fetch-error",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:" Failed to load order information"}),e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300 mt-1",children:(es==null?void 0:es.message)||"Unable to fetch orders for this show"}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>tr(),className:"mt-2","data-testid":"button-retry-orders",children:"Retry"})]}),!St&&!Dt&&!ss&&Se&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-3","data-testid":"text-scan-form-error",children:[e.jsxs("p",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:[" Cannot generate scan form: ",it.length," order",it.length!==1?"s":""," ",it.length!==1?"do":"does"," not have shipping labels purchased yet."]}),e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300 mt-1",children:"Please purchase shipping labels for all orders before generating a scan form."})]}),le&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-3","data-testid":"text-scan-form-generation-error",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:" Failed to generate scan form"}),e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300 mt-1",children:le})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Show:"}),e.jsx("span",{className:"text-sm text-muted-foreground text-right","data-testid":"text-scan-form-show-name",children:o==="marketplace"?e.jsx("div",{className:"font-medium",children:"Marketplace Orders"}):o&&o!=="all"?(()=>{const n=Xt.find(W=>W._id===o),f=(n==null?void 0:n.date)||(n==null?void 0:n.startDate)||(n==null?void 0:n.createdAt),C=f?Z(new Date(f),"d MMM yyyy  HH:mm"):"",F=(n==null?void 0:n.title)||`Show #${o.slice(-8)}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium",children:F}),C&&e.jsx("div",{className:"text-xs",children:C})]})})():"-"})]}),e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Total Orders:"}),e.jsx("span",{className:"text-sm text-muted-foreground","data-testid":"text-scan-form-total-orders",children:sr})]}),!ss&&e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Orders without labels:"}),e.jsx("span",{className:"text-sm text-red-600 dark:text-red-400 font-medium","data-testid":"text-scan-form-orders-without-labels",children:it.length})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground","data-testid":"text-scan-form-description",children:["This will generate a USPS scan form for all ",o==="marketplace"?"marketplace orders":"orders in this show",". Make sure all shipping labels have been purchased before proceeding."]})]})})]}),e.jsxs(Pa,{children:[e.jsx(Oa,{"data-testid":"button-cancel-scan-form",children:"Cancel"}),e.jsx(Ma,{onClick:Zn,disabled:St||Dt||!Se||!ss||Gt.isPending||!!le,"data-testid":"button-confirm-scan-form",children:Gt.isPending?"Generating...":"Generate Scan Form"})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-full flex flex-col gap-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground whitespace-nowrap",children:["1-",hs.length," of ",hs.length]}),t.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[t.length," selected"]}),e.jsxs(Ze,{open:p,onOpenChange:y,children:[e.jsx(Lr,{asChild:!0,children:e.jsxs(O,{size:"sm",variant:"outline",onClick:mr,disabled:t.length<2,"data-testid":"button-create-bundle",children:[e.jsx(ht,{size:14,className:"mr-1"}),"Bundle (",t.length,")"]})}),e.jsxs(Xe,{children:[e.jsx(et,{children:e.jsx(tt,{children:"Create Shipment Bundle"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bundleName",className:"text-sm font-medium",children:"Bundle Name"}),e.jsx(mt,{id:"bundleName",value:d,onChange:n=>h(n.target.value),placeholder:"Enter bundle name",className:"mt-1","data-testid":"input-bundle-name"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(O,{variant:"outline",onClick:()=>y(!1),"data-testid":"button-cancel-bundle",children:"Cancel"}),e.jsx(O,{onClick:hr,disabled:ga.isPending,"data-testid":"button-confirm-bundle",children:"Create Bundle"})]})]})]})]}),e.jsxs(O,{size:"sm",variant:"default",onClick:pr,disabled:t.length===0,"data-testid":"button-buy-labels",children:[e.jsx(Is,{size:14,className:"mr-1"}),"Buy Labels (",t.length,")"]})]})]})}),e.jsx(Q,{className:"shadow border border-border w-full",children:e.jsx(G,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse divide-y divide-border text-sm",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 text-left w-10",children:e.jsx(pt,{checked:t.length===Pe.filter(n=>n.status==="processing").length&&Pe.filter(n=>n.status==="processing").length>0,onCheckedChange:cr,"data-testid":"checkbox-select-all-shipments"})}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-muted-foreground uppercase whitespace-nowrap cursor-pointer select-none hover:bg-muted/80",onClick:()=>ot("customer"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Customer",b==="customer"?Y==="asc"?e.jsx(ut,{size:14}):e.jsx(ct,{size:14}):e.jsx(dt,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-muted-foreground uppercase whitespace-nowrap cursor-pointer select-none hover:bg-muted/80",onClick:()=>ot("orderDate"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Order Date",b==="orderDate"?Y==="asc"?e.jsx(ut,{size:14}):e.jsx(ct,{size:14}):e.jsx(dt,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-muted-foreground uppercase whitespace-nowrap cursor-pointer select-none hover:bg-muted/80",onClick:()=>ot("items"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Items",b==="items"?Y==="asc"?e.jsx(ut,{size:14}):e.jsx(ct,{size:14}):e.jsx(dt,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-muted-foreground uppercase whitespace-nowrap cursor-pointer select-none hover:bg-muted/80",onClick:()=>ot("total"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Total",b==="total"?Y==="asc"?e.jsx(ut,{size:14}):e.jsx(ct,{size:14}):e.jsx(dt,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-muted-foreground uppercase whitespace-nowrap",children:"Dimensions"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-muted-foreground uppercase whitespace-nowrap cursor-pointer select-none hover:bg-muted/80",onClick:()=>ot("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Status",b==="status"?Y==="asc"?e.jsx(ut,{size:14}):e.jsx(ct,{size:14}):e.jsx(dt,{size:14,className:"opacity-50"})]})}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-muted-foreground uppercase whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-card divide-y divide-border",children:hs.map(n=>{var f,C,F,W,X,ee,Oe,lt;return e.jsxs(_r.Fragment,{children:[e.jsxs("tr",{"data-testid":`row-shipment-${n._id}`,children:[e.jsx("td",{className:"px-3 py-3",children:e.jsx(pt,{checked:t.includes(n._id),onCheckedChange:A=>dr(n._id,A),"data-testid":`checkbox-shipment-${n._id}`,disabled:n.status!=="processing",className:n.status!=="processing"?"opacity-50 cursor-not-allowed":""})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>ur(n._id),className:"p-1 h-5 w-5 mr-1","data-testid":`button-expand-${n._id}`,children:s.includes(n._id)?e.jsx(tn,{size:12}):e.jsx(Xa,{size:12})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center",children:[n.status==="delivered"&&e.jsx("div",{className:"text-xs bg-accent text-accent-foreground px-1 rounded mr-1",children:"NEW"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:typeof n.customer=="object"?`${((f=n.customer)==null?void 0:f.firstName)||"Unknown"} ${((C=n.customer)==null?void 0:C.lastName)||""}`.trim():"Unknown Customer"})]})})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:n.createdAt?Z(new Date(n.createdAt),"MMM dd, yyyy"):Z(new Date(n.date||0),"MMM dd, yyyy")})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-sm text-foreground font-medium",children:n.giveaway?1:((F=n.items)==null?void 0:F.length)||0})})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["$",n.giveaway?((n.total||0)+(n.tax||0)+(n.shipping_fee||0)).toFixed(2):n.items&&n.items.length>0?(n.items.reduce((te,H)=>{const se=H.quantity||0,Ot=H.price||0;return te+se*Ot},0)+(n.tax||0)+(n.shipping_fee||0)).toFixed(2):"0.00"]})})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("div",{className:"text-xs",children:n.weight?`${n.weight}${n.scale||"oz"}`:(X=(W=n.giveaway)==null?void 0:W.shipping_profile)!=null&&X.weight?`${n.giveaway.shipping_profile.weight}${n.giveaway.shipping_profile.scale||"oz"}`:n.items&&n.items.length>0&&n.items[0].weight?`${n.items[0].weight}${n.items[0].scale||"oz"}`:"-"}),e.jsx("div",{className:"text-xs",children:n.length&&n.width&&n.height?`${n.height}${n.width}${n.length}"`:n.giveaway?"Giveaway":n.items&&n.items.length>0&&n.items[0].height&&n.items[0].width&&n.items[0].length?`${n.items[0].height}${n.items[0].width}${n.items[0].length}"`:"-"})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{children:[e.jsx(Qe,{className:`${Ss[n.status]} text-xs`,"data-testid":`shipment-status-${n.status}`,children:n.status==="delivered"?"Delivered":n.status?n.status.replaceAll("_"," ").charAt(0).toUpperCase()+n.status.replaceAll("_"," ").slice(1):"Unknown"}),n.tracking_number&&e.jsx("div",{className:"text-xs text-primary font-mono mt-1 cursor-pointer hover:bg-primary/10 px-1 py-0.5 rounded transition-colors",onClick:()=>{navigator.clipboard.writeText(n.tracking_number),P({title:"Copied!",description:"Tracking number copied to clipboard"})},title:"Click to copy tracking number","data-testid":`tracking-number-${n._id}`,children:n.tracking_number})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(fs,{children:[e.jsx(xs,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm","data-testid":`button-order-menu-${n._id}`,children:e.jsx(vs,{size:16})})}),e.jsxs(gs,{align:"end",children:[!n.giveaway&&n.items&&n.items.length>1&&n.status!=="ready_to_ship"&&!n.shipment_id&&e.jsxs(me,{onClick:()=>{ge(n._id),be(!0)},"data-testid":`menu-unbundle-${n._id}`,children:[e.jsx(Zr,{size:14,className:"mr-2"}),"View & Unbundle"]}),n.status==="processing"&&e.jsxs(me,{onClick:()=>{Yt(n),Kt(!0)},children:[e.jsx(Mt,{size:14,className:"mr-2"}),"Edit/Ship Label"]}),n.status==="pending_cancellation"&&e.jsxs(e.Fragment,{children:[e.jsxs(me,{onClick:()=>{de(n._id),L(!0)},"data-testid":`menu-approve-cancellation-${n._id}`,className:"text-green-600",children:[e.jsx(ys,{size:14,className:"mr-2"}),"Approve Cancellation"]}),e.jsxs(me,{onClick:()=>{de(n._id),q(!0)},"data-testid":`menu-decline-cancellation-${n._id}`,className:"text-red-600",children:[e.jsx(ps,{size:14,className:"mr-2"}),"Decline Cancellation"]}),e.jsx(Ea,{})]}),n.status==="ready_to_ship"&&e.jsxs(e.Fragment,{children:[e.jsxs(me,{onClick:()=>{n.label?window.open(n.label,"_blank"):P({title:"No label available",description:"This order doesn't have a shipping label",variant:"destructive"})},"data-testid":`menu-view-label-${n._id}`,children:[e.jsx(Mt,{size:14,className:"mr-2"}),"View Label"]}),e.jsxs(me,{onClick:()=>{_(n),we(!0)},"data-testid":`menu-view-details-${n._id}`,children:[e.jsx(ht,{size:14,className:"mr-2"}),"View Shipment Details"]}),e.jsxs(me,{onClick:()=>{Ln(n._id)},"data-testid":`menu-mark-shipped-${n._id}`,children:[e.jsx(Jr,{size:14,className:"mr-2"}),"Mark as Shipped"]})]}),(n.status==="shipped"||n.status==="delivered")&&e.jsxs(me,{onClick:()=>{Yt(n),Kt(!0)},children:[e.jsx(Is,{size:14,className:"mr-2"}),"Reprint Label"]}),n.status!=="cancelled"&&n.status!=="shipped"&&!n.tracking_number&&!n.tracking_url&&e.jsxs(e.Fragment,{children:[e.jsx(Ea,{}),e.jsxs(me,{className:"text-red-600","data-testid":`menu-cancel-${n._id}`,onClick:()=>{m(n._id),Vt(!0)},children:[e.jsx(wa,{size:14,className:"mr-2"}),"Cancel Order"]})]})]})]})})})]}),s.includes(n._id)&&e.jsx("tr",{className:"bg-muted/50","data-testid":`expanded-row-${n._id}`,children:e.jsx("td",{colSpan:8,className:"px-3 py-3",children:e.jsxs("div",{className:"bg-card rounded-lg p-4 border",children:[e.jsx("h4",{className:"font-medium text-sm mb-3 text-muted-foreground",children:"Items in this order:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Listing"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Qty"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Weight"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Price"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Shipping"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:e.jsxs(bl,{children:[e.jsx(Nl,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-1 cursor-help",children:["S. Shipping",e.jsx(Fs,{size:12,className:"text-muted-foreground"})]})}),e.jsx(Tn,{className:"w-64",children:e.jsx("p",{className:"text-xs",children:"Shipping seller is paying"})})]})}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Date"}),e.jsx("th",{className:"text-left py-2 px-2 font-medium text-muted-foreground",children:"Status"}),e.jsx("th",{className:"text-center py-2 px-2 font-medium text-muted-foreground",children:"Actions"})]})}),e.jsx("tbody",{children:n.giveaway?e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[n.giveaway.images&&n.giveaway.images[0]?e.jsx("img",{src:n.giveaway.images[0],alt:n.giveaway.name,className:"w-10 h-10 object-cover rounded"}):e.jsx("div",{className:"w-10 h-10 bg-muted rounded flex items-center justify-center",children:e.jsx(ht,{size:16,className:"text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.giveaway.name}),e.jsx("p",{className:"text-xs text-muted-foreground lowercase",children:((ee=n.giveaway.category)==null?void 0:ee.name)||"-"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["#",n.invoice||n._id.slice(-8)]})]})]})}),e.jsx("td",{className:"py-2 px-2",children:n.giveaway.quantity||1}),e.jsx("td",{className:"py-2 px-2",children:(Oe=n.giveaway.shipping_profile)!=null&&Oe.weight?`${n.giveaway.shipping_profile.weight} ${n.giveaway.shipping_profile.scale||""}`:"-"}),e.jsx("td",{className:"py-2 px-2",children:"$0.00"}),e.jsxs("td",{className:"py-2 px-2",children:["$",(n.shipping_fee||0).toFixed(2)]}),e.jsx("td",{className:"py-2 px-2 text-center",children:n.seller_shipping_fee_pay&&n.seller_shipping_fee_pay>0?`$${n.seller_shipping_fee_pay.toFixed(2)}`:"-"}),e.jsx("td",{className:"py-2 px-2",children:"Giveaway"}),e.jsx("td",{className:"py-2 px-2 text-xs text-muted-foreground",children:n.date?new Date(n.date).toLocaleDateString():"-"}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("span",{className:`px-2 py-1 rounded-md text-xs ${Ss[n.status]||"bg-gray-100 text-gray-800"}`,children:n.status||"unfulfilled"})}),e.jsx("td",{className:"py-2 px-2 text-center",children:((lt=n.giveaway)==null?void 0:lt.status)==="pending_cancellation"?e.jsxs(fs,{children:[e.jsx(xs,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm","data-testid":`button-giveaway-actions-${n.giveaway._id}`,children:e.jsx(vs,{size:16})})}),e.jsxs(gs,{align:"end",children:[e.jsxs(me,{onClick:()=>{de(n._id),Ae(n.giveaway._id||null),L(!0)},"data-testid":`button-approve-item-${n.giveaway._id}`,className:"text-green-600",children:[e.jsx(ys,{size:14,className:"mr-2"}),"Approve"]}),e.jsxs(me,{onClick:()=>{de(n._id),Ae(n.giveaway._id||null),q(!0)},"data-testid":`button-decline-item-${n.giveaway._id}`,className:"text-red-600",children:[e.jsx(ps,{size:14,className:"mr-2"}),"Reject"]})]})]}):"-"})]}):n.items&&n.items.length>0?n.items.map((A,te)=>{var se,Ot,ja,ba;const H=A.status||n.status;return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[(se=A.productId)!=null&&se.images&&A.productId.images[0]?e.jsx("img",{src:A.productId.images[0],alt:A.productId.name,className:"w-10 h-10 object-cover rounded"}):e.jsx("div",{className:"w-10 h-10 bg-muted rounded flex items-center justify-center",children:e.jsx(ht,{size:16,className:"text-muted-foreground"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[((Ot=A.productId)==null?void 0:Ot.name)||"Item",A.order_reference?` ${A.order_reference}`:""]}),e.jsx("p",{className:"text-xs text-muted-foreground lowercase",children:((ba=(ja=A.productId)==null?void 0:ja.category)==null?void 0:ba.name)||"-"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["#",n.invoice||n._id.slice(-8)]})]})]})}),e.jsx("td",{className:"py-2 px-2",children:A.quantity||1}),e.jsx("td",{className:"py-2 px-2",children:A.weight?`${A.weight} ${A.scale||""}`:"-"}),e.jsxs("td",{className:"py-2 px-2",children:["$",(A.price||0).toFixed(2)]}),e.jsxs("td",{className:"py-2 px-2",children:["$",(A.shipping_fee||0).toFixed(2)]}),e.jsx("td",{className:"py-2 px-2 text-center",children:n.seller_shipping_fee_pay&&n.seller_shipping_fee_pay>0?`$${n.seller_shipping_fee_pay.toFixed(2)}`:"-"}),e.jsx("td",{className:"py-2 px-2",children:n.tokshow?"Show":"Marketplace"}),e.jsx("td",{className:"py-2 px-2 text-xs text-muted-foreground",children:n.date?new Date(n.date).toLocaleDateString():"-"}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("span",{className:`px-2 py-1 rounded-md text-xs ${Ss[H]||"bg-gray-100 text-gray-800"}`,children:(H==null?void 0:H.replace(/_/g," "))||"unfulfilled"})}),e.jsx("td",{className:"py-2 px-2 text-center",children:H==="pending_cancellation"?e.jsxs(fs,{children:[e.jsx(xs,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm","data-testid":`button-item-actions-${A._id||te}`,children:e.jsx(vs,{size:16})})}),e.jsxs(gs,{align:"end",children:[e.jsxs(me,{onClick:()=>{de(n._id),Ae(A._id||null),L(!0)},"data-testid":`button-approve-item-${A._id||te}`,className:"text-green-600",children:[e.jsx(ys,{size:14,className:"mr-2"}),"Approve"]}),e.jsxs(me,{onClick:()=>{de(n._id),Ae(A._id||null),q(!0)},"data-testid":`button-decline-item-${A._id||te}`,className:"text-red-600",children:[e.jsx(ps,{size:14,className:"mr-2"}),"Reject"]})]})]}):"-"})]},`${n._id}-${te}`)}):e.jsx("tr",{className:"border-b",children:e.jsx("td",{colSpan:10,className:"py-4 px-2 text-center text-muted-foreground",children:"No items available"})})})]})})]})})})]},n._id)})})]})})})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Yr,{currentPage:w,totalPages:or,totalItems:ir,itemsPerPage:M,itemsPerPageOptions:[10,20,50,100],onPageChange:qn,onItemsPerPageChange:Un,showingText:"shipping items",className:"bg-white dark:bg-gray-950 rounded-lg border p-4"})}),e.jsx(dl,{open:Ce,onOpenChange:be,bundleOrders:Ne?[Pe.find(n=>n._id===Ne)].filter(Boolean):[],onUnbundle:async n=>{const f=Object.keys(n);for(const C of f)Bn(n[C])},isPending:ma.isPending}),e.jsx(Sn,{open:We,onOpenChange:ze,orderCount:t.length,onConfirm:fr,isPending:va.isPending}),e.jsx(ul,{open:wt,onOpenChange:Je,scanForms:Ct,isLoading:k}),e.jsx(cl,{open:at,onOpenChange:we,order:I}),e.jsx(Ze,{open:E,onOpenChange:L,children:e.jsxs(Xe,{"data-testid":"dialog-approve-cancellation",children:[e.jsxs(et,{children:[e.jsxs(tt,{children:["Approve ",ke?"Item":"Order"," Cancellation Request"]}),e.jsxs(vt,{children:["Are you sure you want to approve this ",ke?"item":"order"," cancellation request? ",ke?"The item":"The order"," will be cancelled and the buyer will be refunded."]})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 py-4",children:[e.jsxs($e,{htmlFor:"relist-switch",className:"flex flex-col space-y-1",children:[e.jsxs("span",{children:["Relist ",ke?"item":"product"]}),e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["Make the ",ke?"item":"product"," available for sale again after cancellation"]})]}),e.jsx(Kr,{id:"relist-switch",checked:la,onCheckedChange:Ht,"data-testid":"switch-approve-relist"})]}),e.jsxs(Tt,{children:[e.jsx(O,{variant:"outline",onClick:()=>{L(!1),de(null),Ae(null),Ht(!1)},disabled:_t.isPending,"data-testid":"button-cancel-approve",children:"Cancel"}),e.jsx(O,{onClick:Wn,disabled:_t.isPending,"data-testid":"button-confirm-approve",children:_t.isPending?"Approving...":"Approve Cancellation"})]})]})}),e.jsx(Ze,{open:B,onOpenChange:q,children:e.jsxs(Xe,{"data-testid":"dialog-decline-cancellation",children:[e.jsxs(et,{children:[e.jsxs(tt,{children:["Decline ",ke?"Item":"Order"," Cancellation Request"]}),e.jsxs(vt,{children:["Please provide a reason for declining this ",ke?"item":"order"," cancellation request. The buyer will be notified."]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx($e,{htmlFor:"decline-reason",children:"Reason (Optional)"}),e.jsx(Hr,{id:"decline-reason",placeholder:"Enter your reason for declining...",value:oa,onChange:n=>Ut(n.target.value),rows:3,"data-testid":"textarea-decline-reason"})]})}),e.jsxs(Tt,{children:[e.jsx(O,{variant:"outline",onClick:()=>{q(!1),de(null),Ae(null),Ut("")},disabled:kt.isPending,"data-testid":"button-cancel-decline",children:"Cancel"}),e.jsx(O,{variant:"destructive",onClick:zn,disabled:kt.isPending,"data-testid":"button-confirm-decline",children:kt.isPending?"Declining...":"Decline Request"})]})]})}),da&&e.jsx(ol,{order:da,currentTab:i,open:En,onOpenChange:n=>{Kt(n),n||Yt(null)}}),j&&e.jsx(Ca,{open:An,onOpenChange:n=>{Vt(n),n||(m(null),N(!1))},children:e.jsxs(_a,{children:[e.jsxs(ka,{children:[e.jsx(Sa,{children:"Cancel Order"}),e.jsxs(Da,{children:["Are you sure you want to cancel order #",((ya=Pe.find(n=>n._id===j))==null?void 0:ya.invoice)||j.slice(-8),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex items-center space-x-2 my-4",children:[e.jsx(pt,{id:"relist-order",checked:g,onCheckedChange:n=>N(n===!0),"data-testid":"checkbox-relist"}),e.jsx("label",{htmlFor:"relist-order",className:"text-sm",children:"Relist this order for future processing"})]}),e.jsxs(Pa,{children:[e.jsx(Oa,{onClick:()=>{m(null),N(!1),Vt(!1)},"data-testid":"button-keep-order",children:"Keep Order"}),e.jsx(Ma,{onClick:$n,disabled:Qt.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 disabled:opacity-50","data-testid":"button-confirm-cancel",children:Qt.isPending?"Cancelling...":"Cancel Order"})]})]})})]})})}export{yd as default};
