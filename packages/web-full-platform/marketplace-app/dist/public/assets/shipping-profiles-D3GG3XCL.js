import{c as U,r as m,a as H,e as W,t as G,j as e,k as v}from"./index-sx6K5zvX.js";import{u as S}from"./useQuery-BbAFWd3P.js";import{u as y}from"./useMutation-CvlU_VR_.js";import{C as u,a as P,b as E,d as B,c as R}from"./card-y7XVqkDr.js";import{B as d}from"./button-BhKWRVKT.js";import{I as k}from"./input-D9aLazCK.js";import{L as g}from"./label-BJe6VCdD.js";import{T as V}from"./textarea-HC14YaqM.js";import{S as Y,a as Z,b as J,c as X,d as ee}from"./select-C7m4p16O.js";import{D as se,a as ie,b as te,c as re,d as ae,e as ne}from"./dialog-lan0uYA-.js";import{A as le,a as oe,b as de,c as ce,d as pe,e as he,f as me,g as ue,h as ge}from"./alert-dialog-7qLZ3S2i.js";import{D as xe,a as fe,b as je,c as F}from"./dropdown-menu-BOeL9IeC.js";import{P as T}from"./plus-C4q9dHNM.js";import{P as A}from"./package-vaCfuI3Q.js";import{E as be}from"./ellipsis-DYmGatb3.js";import{S as ve}from"./square-pen-Cy68seCm.js";import{T as ye}from"./trash-2-DvJeVEKj.js";import"./index-BdQq_4o_.js";import"./index-CLz3BQaN.js";import"./index-BVScwSuZ.js";import"./index-DI5236x7.js";import"./index-yIM9ZdYr.js";import"./chevron-down-D9nmsT4r.js";import"./check-y82geyed.js";import"./chevron-up-BQLqsJm2.js";import"./index-BvxB2yyY.js";import"./index-UxBk8lm-.js";import"./chevron-right-BMekTT0X.js";import"./circle-BdzxhEiG.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=U("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]),we=[{key:"lb",label:"Pound (lb)"},{key:"oz",label:"Ounce (oz)"},{key:"kg",label:"Kilogram (kg)"},{key:"g",label:"Gram (g)"}];function Xe(){const[q,c]=m.useState(!1),[I,p]=m.useState(!1),[l,h]=m.useState(null),[r,a]=m.useState({name:"",description:"",weight:0,scale:"oz"}),{user:i}=H(),{toast:n}=W(),x=G(),N=(i==null?void 0:i._id)||(i==null?void 0:i.id),{data:O}=S({queryKey:[`/api/profile/${N}`],enabled:!!N,staleTime:0}),f=O||i,{data:w=[],isLoading:M,error:_}=S({queryKey:["shipping-profiles",i==null?void 0:i.id],queryFn:async()=>{const s=await fetch(`/api/shipping/profiles/${i==null?void 0:i.id}`);if(!s.ok)throw new Error("Failed to fetch shipping profiles");return s.json()},enabled:!!(i!=null&&i.id)}),j=y({mutationFn:async s=>{const t=await v("POST",`/api/shipping/profiles/${i==null?void 0:i.id}`,s);if(!t.ok)throw new Error("Failed to create shipping profile");return t.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["shipping-profiles"]}),c(!1),o(),n({title:"Success",description:"Shipping profile created successfully"})},onError:s=>{n({title:"Error",description:"Failed to create shipping profile",variant:"destructive"})}}),b=y({mutationFn:async s=>{const{id:t,...Q}=s,C=await v("PUT",`/api/shipping/profiles/${t}`,{...Q,userId:i==null?void 0:i.id});if(!C.ok)throw new Error("Failed to update shipping profile");return C.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["shipping-profiles"]}),p(!1),h(null),o(),n({title:"Success",description:"Shipping profile updated successfully"})},onError:s=>{n({title:"Error",description:"Failed to update shipping profile",variant:"destructive"})}}),$=y({mutationFn:async s=>{const t=await v("DELETE",`/api/shipping/profiles/${s}`,{});if(!t.ok)throw new Error("Failed to delete shipping profile");return t.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["shipping-profiles"]}),n({title:"Success",description:"Shipping profile deleted successfully"})},onError:s=>{n({title:"Error",description:"Failed to delete shipping profile",variant:"destructive"})}}),o=()=>{a({name:"",description:"",weight:0,scale:"oz"})},D=()=>{c(!0),o()},L=s=>{h(s),a({name:s.name,description:s.description||"",weight:s.weight,scale:s.scale}),p(!0)},K=s=>{s.preventDefault(),l?b.mutate({...r,id:l._id}):j.mutate(r)},z=s=>{$.mutate(s)};return f!=null&&f.seller?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Shipping Profiles"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your shipping profiles and settings"})]}),e.jsxs(d,{onClick:D,"data-testid":"button-create-profile",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Profile"]})]}),M?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((s,t)=>e.jsxs(u,{className:"animate-pulse",children:[e.jsxs(P,{children:[e.jsx("div",{className:"h-6 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded"}),e.jsx("div",{className:"h-4 bg-muted rounded w-2/3"})]})})]},t))}):_?e.jsxs(u,{className:"p-8 text-center",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Error loading profiles"}),e.jsx("p",{className:"text-muted-foreground",children:"Failed to load shipping profiles. Please try again."})]}):w.length===0?e.jsxs(u,{className:"p-8 text-center",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No shipping profiles"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Get started by creating your first shipping profile."}),e.jsxs(d,{onClick:D,"data-testid":"button-create-first-profile",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Your First Profile"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(s=>e.jsxs(u,{className:"relative",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{className:"text-lg text-foreground",children:s.name}),s.description&&e.jsx(R,{className:"mt-1",children:s.description})]}),e.jsxs(xe,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm","data-testid":`dropdown-profile-${s._id}`,children:e.jsx(be,{className:"h-4 w-4"})})}),e.jsxs(je,{align:"end",children:[e.jsxs(F,{onClick:()=>L(s),"data-testid":`button-edit-${s._id}`,children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(le,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(F,{onSelect:t=>t.preventDefault(),"data-testid":`button-delete-${s._id}`,children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Delete"]})}),e.jsxs(de,{children:[e.jsxs(ce,{children:[e.jsx(pe,{children:"Delete Shipping Profile"}),e.jsxs(he,{children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']})]}),e.jsxs(me,{children:[e.jsx(ue,{children:"Cancel"}),e.jsx(ge,{onClick:()=>z(s._id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]})]})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.weight," ",s.scale]})]})})})]},s._id))}),e.jsx(se,{open:q||I,onOpenChange:s=>{s||(c(!1),p(!1),h(null),o())},children:e.jsxs(ie,{className:"max-w-md",children:[e.jsxs(te,{children:[e.jsx(re,{children:l?"Edit Shipping Profile":"Create Shipping Profile"}),e.jsx(ae,{children:l?"Update the shipping profile details below.":"Create a new shipping profile for your products."})]}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Profile Name"}),e.jsx(k,{id:"name",value:r.name,onChange:s=>a({...r,name:s.target.value}),placeholder:"e.g., Standard Shipping",required:!0,"data-testid":"input-profile-name"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"description",children:"Description"}),e.jsx(V,{id:"description",value:r.description,onChange:s=>a({...r,description:s.target.value}),placeholder:"Optional description","data-testid":"input-profile-description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"weight",children:"Weight"}),e.jsx(k,{id:"weight",type:"number",value:r.weight,onChange:s=>a({...r,weight:Number(s.target.value)}),placeholder:"0",min:"0",step:"0.01",required:!0,"data-testid":"input-profile-weight"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"scale",children:"Unit"}),e.jsxs(Y,{value:r.scale,onValueChange:s=>a({...r,scale:s}),required:!0,children:[e.jsx(Z,{"data-testid":"select-profile-scale",children:e.jsx(J,{placeholder:"Select unit"})}),e.jsx(X,{children:we.map(s=>e.jsx(ee,{value:s.key,children:s.label},s.key))})]})]})]}),e.jsxs(ne,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>{c(!1),p(!1),h(null),o()},children:"Cancel"}),e.jsx(d,{type:"submit",disabled:j.isPending||b.isPending,"data-testid":"button-save-profile",children:j.isPending||b.isPending?"Saving...":l?"Update Profile":"Create Profile"})]})]})]})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"Only sellers can access shipping profiles management."})]})}export{Xe as default};
