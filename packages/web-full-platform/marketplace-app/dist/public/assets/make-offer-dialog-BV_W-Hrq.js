import{b as D,r as u,j as e,B as v}from"./index-GnvmivW0.js";import{D as y,a as S,b as $,c as w,d as O}from"./dialog-D1L4tMGI.js";import{I as A}from"./input-CDJz7BeV.js";import{D as F}from"./dollar-sign-BPAh4ytq.js";function M({open:a,onOpenChange:l,product:n,shippingEstimate:o,onContinueWithOffer:f}){const{theme:m}=D(),[r,x]=u.useState("-10%"),[b,c]=u.useState(""),i=t=>t?t.length===8?`#${t.substring(2)}`:t.startsWith("#")?t:`#${t}`:"",N=i(m.button_color),h=i(m.button_text_color),d=(n==null?void 0:n.price)||0;o!=null&&o.shippingCost||o!=null&&o.shipping_cost||o!=null&&o.amount,o!=null&&o.tax;const g=[{value:"-20%",label:"-20%",discount:.2},{value:"-15%",label:"-15%",discount:.15},{value:"-10%",label:"-10%",discount:.1},{value:"-5%",label:"-5%",discount:.05}],s=(()=>{if(r==="custom")return parseFloat(b)||0;const t=g.find(k=>k.value===r);return t?Math.round(d*(1-t.discount)*100)/100:d})();u.useEffect(()=>{a&&(x("-10%"),c(""))},[a]);const C=()=>{s>0&&f&&(l(!1),f(s))},j=t=>{x(t),t!=="custom"&&c("")};return e.jsx(y,{open:a,onOpenChange:l,children:e.jsxs(S,{className:"sm:max-w-md p-0 gap-0 overflow-hidden",children:[e.jsxs("div",{className:"p-6 pb-4",children:[e.jsxs($,{className:"mb-0 pb-0",children:[e.jsx(w,{className:"text-lg font-semibold text-foreground",children:"Select offer amount"}),e.jsx(O,{className:"sr-only",children:"Choose a discount percentage or enter a custom offer amount"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[g.map(t=>e.jsx("button",{onClick:()=>j(t.value),className:`px-4 py-2 rounded-md border text-sm font-medium transition-colors ${r===t.value?"bg-foreground text-background border-foreground":"bg-background text-foreground border-border hover:bg-muted"}`,"data-testid":`button-offer-${t.value}`,children:t.label},t.value)),e.jsx("button",{onClick:()=>j("custom"),className:`px-4 py-2 rounded-md border text-sm font-medium transition-colors ${r==="custom"?"bg-foreground text-background border-foreground":"bg-background text-foreground border-border hover:bg-muted"}`,"data-testid":"button-offer-custom",children:"Custom"})]}),r==="custom"&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(A,{type:"number",step:"0.01",min:"0",placeholder:"Enter your offer",value:b,onChange:t=>c(t.target.value),className:"pl-8","data-testid":"input-custom-offer-price"})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("span",{className:"text-muted-foreground",children:"You Pay:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground line-through",children:["US$",d.toFixed(2)]}),e.jsxs("span",{className:"text-green-600 font-bold text-lg",children:["US$",s.toFixed(2)]}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"+ shipping & taxes"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border-t bg-background",children:[e.jsx(v,{variant:"outline",onClick:()=>l(!1),className:"px-6","data-testid":"button-cancel-offer",children:"Cancel"}),e.jsx(v,{onClick:C,disabled:!s||s<=0,className:"flex-1 font-semibold",style:{backgroundColor:N||"#FACC15",color:h||"#000000"},"data-testid":"button-continue-offer",children:"Continue With Offer"})]})]})})}export{M as MakeOfferDialog,M as default};
