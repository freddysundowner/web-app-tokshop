import{r as x,e as b,u as $,a as C,j as t}from"./index-sx6K5zvX.js";import{C as m}from"./card-y7XVqkDr.js";import{B as L}from"./button-BhKWRVKT.js";import{I as U}from"./input-D9aLazCK.js";import{A as S,a as _,b as F}from"./avatar-0uinKUeM.js";import{B as I}from"./badge-CnP4rDPZ.js";import{u as M}from"./useQuery-BbAFWd3P.js";import{U as u}from"./users-BlXGC3jf.js";import{S as f}from"./search-CokuAmim.js";import{L as A}from"./loader-circle-B7f4O2pk.js";import{M as k}from"./message-circle-wvvinv5k.js";function G(){const[s,h]=x.useState(""),{toast:N}=b(),[,g]=$(),{user:r}=C(),o=(r==null?void 0:r._id)||(r==null?void 0:r.id),{data:j,isLoading:n}=M({queryKey:[`/api/users/friends/${o}`],enabled:!!o}),i=j||[],l=x.useMemo(()=>{if(!s.trim())return i;const e=s.toLowerCase();return i.filter(a=>{const d=`${a.firstName||""} ${a.lastName||""}`.trim(),y=a.userName||"",v=a.email||"";return d.toLowerCase().includes(e)||y.toLowerCase().includes(e)||v.toLowerCase().includes(e)})},[i,s]),p=e=>{g(`/inbox/${e._id}`);const a=e.userName||`${e.firstName||""} ${e.lastName||""}`.trim()||e.email;N({title:"Opening Messages",description:`Starting conversation with ${a}`})},c=e=>e.userName?e.userName:e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email||"Unknown User",w=e=>{var a,d;return e.firstName||e.lastName?`${((a=e.firstName)==null?void 0:a[0])||""}${((d=e.lastName)==null?void 0:d[0])||""}`.toUpperCase():e.userName?e.userName[0].toUpperCase():e.email?e.email[0].toUpperCase():"U"};return t.jsx("div",{className:"min-h-screen bg-background","data-testid":"page-friends",children:t.jsxs("div",{className:"w-full p-4 sm:p-6 space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-foreground","data-testid":"heading-friends",children:"People I Follow"}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-1","data-testid":"text-description",children:["Users you're following â€¢ ",i.length," total"]})]}),t.jsxs(I,{variant:"secondary",className:"text-base px-3 py-1","data-testid":"badge-count-total",children:[t.jsx(u,{className:"h-4 w-4 mr-1.5"}),i.length]})]}),t.jsxs("div",{className:"relative max-w-xl",children:[t.jsx(f,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(U,{placeholder:"Search people you follow...",value:s,onChange:e=>h(e.target.value),className:"pl-10","data-testid":"input-search-following"})]}),n&&t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(A,{className:"h-8 w-8 animate-spin text-primary"})}),!n&&t.jsx("div",{className:"space-y-3",children:l.length>0?t.jsxs(t.Fragment,{children:[s&&t.jsxs("p",{className:"text-sm text-muted-foreground","data-testid":"text-search-results",children:["Found ",l.length," ",l.length!==1?"people":"person"]}),t.jsx("div",{className:"space-y-3",children:l.map(e=>t.jsx(m,{className:"p-4 hover-elevate","data-testid":`card-following-${e._id}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(S,{className:"h-14 w-14","data-testid":`avatar-${e._id}`,children:[t.jsx(_,{src:e.profilePhoto,alt:c(e)}),t.jsx(F,{className:"bg-primary text-primary-foreground text-lg",children:w(e)})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-semibold text-foreground text-base","data-testid":`text-name-${e._id}`,children:c(e)}),e.userName&&t.jsxs("p",{className:"text-sm text-muted-foreground","data-testid":`text-username-${e._id}`,children:["@",e.userName]}),t.jsx("div",{className:"flex items-center gap-3 mt-1",children:e.followerCount!==void 0&&t.jsxs("p",{className:"text-xs text-muted-foreground","data-testid":`text-followers-${e._id}`,children:[e.followerCount.toLocaleString()," followers"]})})]}),t.jsxs(L,{size:"default",variant:"default",onClick:()=>p(e),"data-testid":`button-message-${e._id}`,children:[t.jsx(k,{className:"h-4 w-4 mr-2"}),"Message"]})]})},e._id))})]}):s?t.jsx(m,{className:"p-12","data-testid":"card-no-results",children:t.jsxs("div",{className:"text-center",children:[t.jsx(f,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),t.jsx("p",{className:"text-foreground font-medium text-lg","data-testid":"text-no-results",children:"No one found"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-2","data-testid":"text-no-results-description",children:"Try searching with a different name or username"})]})}):t.jsx(m,{className:"p-12","data-testid":"card-empty-following",children:t.jsxs("div",{className:"text-center",children:[t.jsx(u,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),t.jsx("p",{className:"text-foreground font-medium text-lg","data-testid":"text-empty-following",children:"Not following anyone yet"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-2","data-testid":"text-empty-following-description",children:"Start following people to see them here"})]})})})]})})}export{G as default};
