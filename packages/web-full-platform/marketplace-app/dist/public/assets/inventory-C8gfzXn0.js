import{c as ht,g as St,h as Pt,r as T,j as e,i as Et,P as pt,d as It,a as mt,e as ft,q as be,u as At,k as Oe}from"./index-DOZKoalF.js";import{u as tt}from"./useQuery-48pQeuS3.js";import{u as Dt}from"./useMutation-BBndlB0x.js";import{C as ye,b as Te,a as xt,d as Tt}from"./card-C6zn3jP-.js";import{B as L}from"./button-bCrgsaso.js";import{B as qe}from"./badge-DdltLmN9.js";import{I as Rt}from"./input-CsVTZWQJ.js";import{S as _e,a as Ce,b as Se,c as Pe,d as M}from"./select-fROaTUpr.js";import{D as Ot,a as Ft,b as Lt,c as We,d as Ut}from"./dropdown-menu-D0VRtd9b.js";import{D as st,C as ke}from"./checkbox-DceMgmJj.js";import{D as Ee,a as Ie,b as Ae,c as De,d as Ue}from"./dialog-D_mWFmtX.js";import{C as qt}from"./pagination-BOwtfPQN.js";import{A as zt,a as Mt}from"./alert-BccqnU99.js";import{T as $t,a as Bt,b as at,c as Fe,d as Vt,e as Le}from"./table-DgQOOHri.js";import{L as Ht}from"./label-CmdcELDJ.js";import{T as Kt,a as Qt,b as Me,c as $e}from"./tabs-BCgd9IQZ.js";import{U as gt}from"./upload-DYhQNpyI.js";import{F as Wt}from"./file-text-Bo1vIAZG.js";import{T as rt}from"./triangle-alert-Bmp0Lc24.js";import{C as He}from"./circle-check-big-DWYr1aIm.js";import{L as Gt}from"./loader-circle-Bz7fq4IJ.js";import{P as Ge}from"./package-BkkIjgzC.js";import{P as it}from"./plus-CGXGABxL.js";import{S as Xt}from"./search-DsOHL3-T.js";import{S as nt}from"./square-pen-VTL5VpGh.js";import{E as Jt}from"./ellipsis-WVit2xoA.js";import{E as Zt}from"./eye-BEx2yl5C.js";import{R as Yt}from"./refresh-cw-CHHXFRCr.js";import{T as es}from"./trash-2-DlPQcTq2.js";import"./index-BdQq_4o_.js";import"./index-DwAU5pHh.js";import"./index-CXm_CZR6.js";import"./index-CxUEmdCc.js";import"./index-AFSU6Owo.js";import"./chevron-down-Bi2HuHPT.js";import"./check-Bj3EYrSG.js";import"./chevron-up-0jCUr4SU.js";import"./index-CYumVO2i.js";import"./chevron-right-SEiIbCON.js";import"./circle-D2uhURtr.js";import"./index-D0GAShZH.js";import"./chevron-left-DwmM2L3b.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=ht("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=ht("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var yt={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(_,B){((Q,N)=>{_.exports=N()})(Pt,function Q(){var N=typeof self<"u"?self:typeof window<"u"?window:N!==void 0?N:{},P,de=!N.document&&!!N.postMessage,ce=N.IS_PAPA_WORKER||!1,Z={},Y=0,p={};function X(s){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(a){var i=ee(a);i.chunkSize=parseInt(i.chunkSize),a.step||a.chunk||(i.chunkSize=null),this._handle=new V(i),(this._handle.streamer=this)._config=i}).call(this,s),this.parseChunk=function(a,i){var c=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<c){let j=this._config.newline;j||(r=this._config.quoteChar||'"',j=this._handle.guessLineEndings(a,r)),a=[...a.split(j).slice(c)].join(j)}this.isFirstChunk&&I(this._config.beforeFirstChunk)&&(r=this._config.beforeFirstChunk(a))!==void 0&&(a=r),this.isFirstChunk=!1,this._halted=!1;var c=this._partialLine+a,r=(this._partialLine="",this._handle.parse(c,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(a=r.meta.cursor,c=(this._finished||(this._partialLine=c.substring(a-this._baseIndex),this._baseIndex=a),r&&r.data&&(this._rowCount+=r.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),ce)N.postMessage({results:r,workerId:p.WORKER_ID,finished:c});else if(I(this._config.chunk)&&!i){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=r=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!c||!I(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||r&&r.meta.paused||this._nextChunk(),r}this._halted=!0},this._sendError=function(a){I(this._config.error)?this._config.error(a):ce&&this._config.error&&N.postMessage({workerId:p.WORKER_ID,error:a,finished:!1})}}function ue(s){var a;(s=s||{}).chunkSize||(s.chunkSize=p.RemoteChunkSize),X.call(this,s),this._nextChunk=de?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),de||(a.onload=se(this._chunkLoaded,this),a.onerror=se(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!de),this._config.downloadRequestHeaders){var i,c=this._config.downloadRequestHeaders;for(i in c)a.setRequestHeader(i,c[i])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,a.setRequestHeader("Range","bytes="+this._start+"-"+r));try{a.send(this._config.downloadRequestBody)}catch(j){this._chunkError(j.message)}de&&a.status===0&&this._chunkError()}},this._chunkLoaded=function(){a.readyState===4&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize||a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(i=>(i=i.getResponseHeader("Content-Range"))!==null?parseInt(i.substring(i.lastIndexOf("/")+1)):-1)(a),this.parseChunk(a.responseText)))},this._chunkError=function(i){i=a.statusText||i,this._sendError(new Error(i))}}function xe(s){(s=s||{}).chunkSize||(s.chunkSize=p.LocalChunkSize),X.call(this,s);var a,i,c=typeof FileReader<"u";this.stream=function(r){this._input=r,i=r.slice||r.webkitSlice||r.mozSlice,c?((a=new FileReader).onload=se(this._chunkLoaded,this),a.onerror=se(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var r=this._input,j=(this._config.chunkSize&&(j=Math.min(this._start+this._config.chunkSize,this._input.size),r=i.call(r,this._start,j)),a.readAsText(r,this._config.encoding));c||this._chunkLoaded({target:{result:j}})},this._chunkLoaded=function(r){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(r.target.result)},this._chunkError=function(){this._sendError(a.error)}}function J(s){var a;X.call(this,s=s||{}),this.stream=function(i){return a=i,this._nextChunk()},this._nextChunk=function(){var i,c;if(!this._finished)return i=this._config.chunkSize,a=i?(c=a.substring(0,i),a.substring(i)):(c=a,""),this._finished=!a,this.parseChunk(c)}}function w(s){X.call(this,s=s||{});var a=[],i=!0,c=!1;this.pause=function(){X.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){X.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(r){this._input=r,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){c&&a.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):i=!0},this._streamData=se(function(r){try{a.push(typeof r=="string"?r:r.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(j){this._streamError(j)}},this),this._streamError=se(function(r){this._streamCleanUp(),this._sendError(r)},this),this._streamEnd=se(function(){this._streamCleanUp(),c=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function V(s){var a,i,c,r,j=Math.pow(2,53),z=-j,S=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,D=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,f=this,q=0,m=0,H=!1,n=!1,o=[],l={data:[],errors:[],meta:{}};function h(g){return s.skipEmptyLines==="greedy"?g.join("").trim()==="":g.length===1&&g[0].length===0}function v(){if(l&&c&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),c=!1),s.skipEmptyLines&&(l.data=l.data.filter(function(u){return!h(u)})),x()){let u=function(R,O){I(s.transformHeader)&&(R=s.transformHeader(R,O)),o.push(R)};if(l)if(Array.isArray(l.data[0])){for(var g=0;x()&&g<l.data.length;g++)l.data[g].forEach(u);l.data.splice(0,1)}else l.data.forEach(u)}function y(u,R){for(var O=s.header?{}:[],E=0;E<u.length;E++){var F=E,C=u[E],C=((te,b)=>(U=>(s.dynamicTypingFunction&&s.dynamicTyping[U]===void 0&&(s.dynamicTyping[U]=s.dynamicTypingFunction(U)),(s.dynamicTyping[U]||s.dynamicTyping)===!0))(te)?b==="true"||b==="TRUE"||b!=="false"&&b!=="FALSE"&&((U=>{if(S.test(U)&&(U=parseFloat(U),z<U&&U<j))return 1})(b)?parseFloat(b):D.test(b)?new Date(b):b===""?null:b):b)(F=s.header?E>=o.length?"__parsed_extra":o[E]:F,C=s.transform?s.transform(C,F):C);F==="__parsed_extra"?(O[F]=O[F]||[],O[F].push(C)):O[F]=C}return s.header&&(E>o.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+o.length+" fields but parsed "+E,m+R):E<o.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+o.length+" fields but parsed "+E,m+R)),O}var A;l&&(s.header||s.dynamicTyping||s.transform)&&(A=1,!l.data.length||Array.isArray(l.data[0])?(l.data=l.data.map(y),A=l.data.length):l.data=y(l.data,0),s.header&&l.meta&&(l.meta.fields=o),m+=A)}function x(){return s.header&&o.length===0}function k(g,y,A,u){g={type:g,code:y,message:A},u!==void 0&&(g.row=u),l.errors.push(g)}I(s.step)&&(r=s.step,s.step=function(g){l=g,x()?v():(v(),l.data.length!==0&&(q+=g.data.length,s.preview&&q>s.preview?i.abort():(l.data=l.data[0],r(l,f))))}),this.parse=function(g,y,A){var u=s.quoteChar||'"',u=(s.newline||(s.newline=this.guessLineEndings(g,u)),c=!1,s.delimiter?I(s.delimiter)&&(s.delimiter=s.delimiter(g),l.meta.delimiter=s.delimiter):((u=((R,O,E,F,C)=>{var te,b,U,ae;C=C||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var oe=0;oe<C.length;oe++){for(var re,we=C[oe],W=0,le=0,K=0,G=(U=void 0,new ve({comments:F,delimiter:we,newline:O,preview:10}).parse(R)),pe=0;pe<G.data.length;pe++)E&&h(G.data[pe])?K++:(re=G.data[pe].length,le+=re,U===void 0?U=re:0<re&&(W+=Math.abs(re-U),U=re));0<G.data.length&&(le/=G.data.length-K),(b===void 0||W<=b)&&(ae===void 0||ae<le)&&1.99<le&&(b=W,te=we,ae=le)}return{successful:!!(s.delimiter=te),bestDelimiter:te}})(g,s.newline,s.skipEmptyLines,s.comments,s.delimitersToGuess)).successful?s.delimiter=u.bestDelimiter:(c=!0,s.delimiter=p.DefaultDelimiter),l.meta.delimiter=s.delimiter),ee(s));return s.preview&&s.header&&u.preview++,a=g,i=new ve(u),l=i.parse(a,y,A),v(),H?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return H},this.pause=function(){H=!0,i.abort(),a=I(s.chunk)?"":a.substring(i.getCharIndex())},this.resume=function(){f.streamer._halted?(H=!1,f.streamer.parseChunk(a,!0)):setTimeout(f.resume,3)},this.aborted=function(){return n},this.abort=function(){n=!0,i.abort(),l.meta.aborted=!0,I(s.complete)&&s.complete(l),a=""},this.guessLineEndings=function(R,u){R=R.substring(0,1048576);var u=new RegExp(he(u)+"([^]*?)"+he(u),"gm"),A=(R=R.replace(u,"")).split("\r"),u=R.split(`
`),R=1<u.length&&u[0].length<A[0].length;if(A.length===1||R)return`
`;for(var O=0,E=0;E<A.length;E++)A[E][0]===`
`&&O++;return O>=A.length/2?`\r
`:"\r"}}function he(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ve(s){var a=(s=s||{}).delimiter,i=s.newline,c=s.comments,r=s.step,j=s.preview,z=s.fastMode,S=null,D=!1,f=s.quoteChar==null?'"':s.quoteChar,q=f;if(s.escapeChar!==void 0&&(q=s.escapeChar),(typeof a!="string"||-1<p.BAD_DELIMITERS.indexOf(a))&&(a=","),c===a)throw new Error("Comment character same as delimiter");c===!0?c="#":(typeof c!="string"||-1<p.BAD_DELIMITERS.indexOf(c))&&(c=!1),i!==`
`&&i!=="\r"&&i!==`\r
`&&(i=`
`);var m=0,H=!1;this.parse=function(n,o,l){if(typeof n!="string")throw new Error("Input must be a string");var h=n.length,v=a.length,x=i.length,k=c.length,g=I(r),y=[],A=[],u=[],R=m=0;if(!n)return W();if(z||z!==!1&&n.indexOf(f)===-1){for(var O=n.split(i),E=0;E<O.length;E++){if(u=O[E],m+=u.length,E!==O.length-1)m+=i.length;else if(l)return W();if(!c||u.substring(0,k)!==c){if(g){if(y=[],ae(u.split(a)),le(),H)return W()}else ae(u.split(a));if(j&&j<=E)return y=y.slice(0,j),W(!0)}}return W()}for(var F=n.indexOf(a,m),C=n.indexOf(i,m),te=new RegExp(he(q)+he(f),"g"),b=n.indexOf(f,m);;)if(n[m]===f)for(b=m,m++;;){if((b=n.indexOf(f,b+1))===-1)return l||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:m}),re();if(b===h-1)return re(n.substring(m,b).replace(te,f));if(f===q&&n[b+1]===q)b++;else if(f===q||b===0||n[b-1]!==q){F!==-1&&F<b+1&&(F=n.indexOf(a,b+1));var U=oe((C=C!==-1&&C<b+1?n.indexOf(i,b+1):C)===-1?F:Math.min(F,C));if(n.substr(b+1+U,v)===a){u.push(n.substring(m,b).replace(te,f)),n[m=b+1+U+v]!==f&&(b=n.indexOf(f,m)),F=n.indexOf(a,m),C=n.indexOf(i,m);break}if(U=oe(C),n.substring(b+1+U,b+1+U+x)===i){if(u.push(n.substring(m,b).replace(te,f)),we(b+1+U+x),F=n.indexOf(a,m),b=n.indexOf(f,m),g&&(le(),H))return W();if(j&&y.length>=j)return W(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:m}),b++}}else if(c&&u.length===0&&n.substring(m,m+k)===c){if(C===-1)return W();m=C+x,C=n.indexOf(i,m),F=n.indexOf(a,m)}else if(F!==-1&&(F<C||C===-1))u.push(n.substring(m,F)),m=F+v,F=n.indexOf(a,m);else{if(C===-1)break;if(u.push(n.substring(m,C)),we(C+x),g&&(le(),H))return W();if(j&&y.length>=j)return W(!0)}return re();function ae(K){y.push(K),R=m}function oe(K){var G=0;return G=K!==-1&&(K=n.substring(b+1,K))&&K.trim()===""?K.length:G}function re(K){return l||(K===void 0&&(K=n.substring(m)),u.push(K),m=h,ae(u),g&&le()),W()}function we(K){m=K,ae(u),u=[],C=n.indexOf(i,m)}function W(K){if(s.header&&!o&&y.length&&!D){var G=y[0],pe=Object.create(null),ze=new Set(G);let Be=!1;for(let ie=0;ie<G.length;ie++){let ne=G[ie];if(pe[ne=I(s.transformHeader)?s.transformHeader(ne,ie):ne]){let Ne,Re=pe[ne];for(;Ne=ne+"_"+Re,Re++,ze.has(Ne););ze.add(Ne),G[ie]=Ne,pe[ne]++,Be=!0,(S=S===null?{}:S)[Ne]=ne}else pe[ne]=1,G[ie]=ne;ze.add(ne)}Be&&console.warn("Duplicate headers found and renamed."),D=!0}return{data:y,errors:A,meta:{delimiter:a,linebreak:i,aborted:H,truncated:!!K,cursor:R+(o||0),renamedHeaders:S}}}function le(){r(W()),y=[],A=[]}},this.abort=function(){H=!0},this.getCharIndex=function(){return m}}function ge(s){var a=s.data,i=Z[a.workerId],c=!1;if(a.error)i.userError(a.error,a.file);else if(a.results&&a.results.data){var r={abort:function(){c=!0,me(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:fe,resume:fe};if(I(i.userStep)){for(var j=0;j<a.results.data.length&&(i.userStep({data:a.results.data[j],errors:a.results.errors,meta:a.results.meta},r),!c);j++);delete a.results}else I(i.userChunk)&&(i.userChunk(a.results,r,a.file),delete a.results)}a.finished&&!c&&me(a.workerId,a.results)}function me(s,a){var i=Z[s];I(i.userComplete)&&i.userComplete(a),i.terminate(),delete Z[s]}function fe(){throw new Error("Not implemented.")}function ee(s){if(typeof s!="object"||s===null)return s;var a,i=Array.isArray(s)?[]:{};for(a in s)i[a]=ee(s[a]);return i}function se(s,a){return function(){s.apply(a,arguments)}}function I(s){return typeof s=="function"}return p.parse=function(s,a){var i=(a=a||{}).dynamicTyping||!1;if(I(i)&&(a.dynamicTypingFunction=i,i={}),a.dynamicTyping=i,a.transform=!!I(a.transform)&&a.transform,!a.worker||!p.WORKERS_SUPPORTED)return i=null,p.NODE_STREAM_INPUT,typeof s=="string"?(s=(c=>c.charCodeAt(0)!==65279?c:c.slice(1))(s),i=new(a.download?ue:J)(a)):s.readable===!0&&I(s.read)&&I(s.on)?i=new w(a):(N.File&&s instanceof File||s instanceof Object)&&(i=new xe(a)),i.stream(s);(i=(()=>{var c;return!!p.WORKERS_SUPPORTED&&(c=(()=>{var r=N.URL||N.webkitURL||null,j=Q.toString();return p.BLOB_URL||(p.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",j,")();"],{type:"text/javascript"})))})(),(c=new N.Worker(c)).onmessage=ge,c.id=Y++,Z[c.id]=c)})()).userStep=a.step,i.userChunk=a.chunk,i.userComplete=a.complete,i.userError=a.error,a.step=I(a.step),a.chunk=I(a.chunk),a.complete=I(a.complete),a.error=I(a.error),delete a.worker,i.postMessage({input:s,config:a,workerId:i.id})},p.unparse=function(s,a){var i=!1,c=!0,r=",",j=`\r
`,z='"',S=z+z,D=!1,f=null,q=!1,m=((()=>{if(typeof a=="object"){if(typeof a.delimiter!="string"||p.BAD_DELIMITERS.filter(function(o){return a.delimiter.indexOf(o)!==-1}).length||(r=a.delimiter),typeof a.quotes!="boolean"&&typeof a.quotes!="function"&&!Array.isArray(a.quotes)||(i=a.quotes),typeof a.skipEmptyLines!="boolean"&&typeof a.skipEmptyLines!="string"||(D=a.skipEmptyLines),typeof a.newline=="string"&&(j=a.newline),typeof a.quoteChar=="string"&&(z=a.quoteChar),typeof a.header=="boolean"&&(c=a.header),Array.isArray(a.columns)){if(a.columns.length===0)throw new Error("Option columns is empty");f=a.columns}a.escapeChar!==void 0&&(S=a.escapeChar+z),a.escapeFormulae instanceof RegExp?q=a.escapeFormulae:typeof a.escapeFormulae=="boolean"&&a.escapeFormulae&&(q=/^[=+\-@\t\r].*$/)}})(),new RegExp(he(z),"g"));if(typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(s)){if(!s.length||Array.isArray(s[0]))return H(null,s,D);if(typeof s[0]=="object")return H(f||Object.keys(s[0]),s,D)}else if(typeof s=="object")return typeof s.data=="string"&&(s.data=JSON.parse(s.data)),Array.isArray(s.data)&&(s.fields||(s.fields=s.meta&&s.meta.fields||f),s.fields||(s.fields=Array.isArray(s.data[0])?s.fields:typeof s.data[0]=="object"?Object.keys(s.data[0]):[]),Array.isArray(s.data[0])||typeof s.data[0]=="object"||(s.data=[s.data])),H(s.fields||[],s.data||[],D);throw new Error("Unable to serialize unrecognized input");function H(o,l,h){var v="",x=(typeof o=="string"&&(o=JSON.parse(o)),typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(o)&&0<o.length),k=!Array.isArray(l[0]);if(x&&c){for(var g=0;g<o.length;g++)0<g&&(v+=r),v+=n(o[g],g);0<l.length&&(v+=j)}for(var y=0;y<l.length;y++){var A=(x?o:l[y]).length,u=!1,R=x?Object.keys(l[y]).length===0:l[y].length===0;if(h&&!x&&(u=h==="greedy"?l[y].join("").trim()==="":l[y].length===1&&l[y][0].length===0),h==="greedy"&&x){for(var O=[],E=0;E<A;E++){var F=k?o[E]:E;O.push(l[y][F])}u=O.join("").trim()===""}if(!u){for(var C=0;C<A;C++){0<C&&!R&&(v+=r);var te=x&&k?o[C]:C;v+=n(l[y][te],C)}y<l.length-1&&(!h||0<A&&!R)&&(v+=j)}}return v}function n(o,l){var h,v;return o==null?"":o.constructor===Date?JSON.stringify(o).slice(1,25):(v=!1,q&&typeof o=="string"&&q.test(o)&&(o="'"+o,v=!0),h=o.toString().replace(m,S),(v=v||i===!0||typeof i=="function"&&i(o,l)||Array.isArray(i)&&i[l]||((x,k)=>{for(var g=0;g<k.length;g++)if(-1<x.indexOf(k[g]))return!0;return!1})(h,p.BAD_DELIMITERS)||-1<h.indexOf(r)||h.charAt(0)===" "||h.charAt(h.length-1)===" ")?z+h+z:h)}},p.RECORD_SEP="",p.UNIT_SEP="",p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!de&&!!N.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=ve,p.ParserHandle=V,p.NetworkStreamer=ue,p.FileStreamer=xe,p.StringStreamer=J,p.ReadableStreamStreamer=w,N.jQuery&&((P=N.jQuery).fn.parse=function(s){var a=s.config||{},i=[];return this.each(function(j){if(!(P(this).prop("tagName").toUpperCase()==="INPUT"&&P(this).attr("type").toLowerCase()==="file"&&N.FileReader)||!this.files||this.files.length===0)return!0;for(var z=0;z<this.files.length;z++)i.push({file:this.files[z],inputElem:this,instanceConfig:P.extend({},a)})}),c(),this;function c(){if(i.length===0)I(s.complete)&&s.complete();else{var j,z,S,D,f=i[0];if(I(s.before)){var q=s.before(f.file,f.inputElem);if(typeof q=="object"){if(q.action==="abort")return j="AbortError",z=f.file,S=f.inputElem,D=q.reason,void(I(s.error)&&s.error({name:j},z,S,D));if(q.action==="skip")return void r();typeof q.config=="object"&&(f.instanceConfig=P.extend(f.instanceConfig,q.config))}else if(q==="skip")return void r()}var m=f.instanceConfig.complete;f.instanceConfig.complete=function(H){I(m)&&m(H,f.file,f.inputElem),r()},p.parse(f.file,f.instanceConfig)}}function r(){i.splice(0,1),c()}}),ce&&(N.onmessage=function(s){s=s.data,p.WORKER_ID===void 0&&s&&(p.WORKER_ID=s.workerId),typeof s.input=="string"?N.postMessage({workerId:p.WORKER_ID,results:p.parse(s.input,s.config),finished:!0}):(N.File&&s.input instanceof File||s.input instanceof Object)&&(s=p.parse(s.input,s.config))&&N.postMessage({workerId:p.WORKER_ID,results:s,finished:!0})}),(ue.prototype=Object.create(X.prototype)).constructor=ue,(xe.prototype=Object.create(X.prototype)).constructor=xe,(J.prototype=Object.create(J.prototype)).constructor=J,(w.prototype=Object.create(X.prototype)).constructor=w,p})})(yt);var ss=yt.exports;const Je=St(ss);var Ye="Progress",et=100,[as]=Et(Ye),[rs,is]=as(Ye),vt=T.forwardRef((_,B)=>{const{__scopeProgress:Q,value:N=null,max:P,getValueLabel:de=ns,...ce}=_;(P||P===0)&&!ot(P)&&console.error(os(`${P}`,"Progress"));const Z=ot(P)?P:et;N!==null&&!lt(N,Z)&&console.error(ls(`${N}`,"Progress"));const Y=lt(N,Z)?N:null,p=Qe(Y)?de(Y,Z):void 0;return e.jsx(rs,{scope:Q,value:Y,max:Z,children:e.jsx(pt.div,{"aria-valuemax":Z,"aria-valuemin":0,"aria-valuenow":Qe(Y)?Y:void 0,"aria-valuetext":p,role:"progressbar","data-state":wt(Y,Z),"data-value":Y??void 0,"data-max":Z,...ce,ref:B})})});vt.displayName=Ye;var jt="ProgressIndicator",bt=T.forwardRef((_,B)=>{const{__scopeProgress:Q,...N}=_,P=is(jt,Q);return e.jsx(pt.div,{"data-state":wt(P.value,P.max),"data-value":P.value??void 0,"data-max":P.max,...N,ref:B})});bt.displayName=jt;function ns(_,B){return`${Math.round(_/B*100)}%`}function wt(_,B){return _==null?"indeterminate":_===B?"complete":"loading"}function Qe(_){return typeof _=="number"}function ot(_){return Qe(_)&&!isNaN(_)&&_>0}function lt(_,B){return Qe(_)&&!isNaN(_)&&_<=B&&_>=0}function os(_,B){return`Invalid prop \`max\` of value \`${_}\` supplied to \`${B}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${et}\`.`}function ls(_,B){return`Invalid prop \`value\` of value \`${_}\` supplied to \`${B}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${et} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Nt=vt,ds=bt;const kt=T.forwardRef(({className:_,value:B,...Q},N)=>e.jsx(Nt,{ref:N,className:It("relative h-4 w-full overflow-hidden rounded-full bg-secondary",_),...Q,children:e.jsx(ds,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(B||0)}%)`}})}));kt.displayName=Nt.displayName;const cs=new Set(["category","shippingprofile","weight","width","height","length","scale"]),us=_=>_.toLowerCase().replace(/[^a-z0-9]/g,""),dt=["name","price","quantity"],Ke={name:{label:"Product Name",required:!0,type:"text"},description:{label:"Description",required:!1,type:"text"},price:{label:"Price",required:!0,type:"number"},quantity:{label:"Quantity",required:!0,type:"number"},listingType:{label:"Listing Type",required:!1,type:"select",options:["buy_now","auction"]},colors:{label:"Colors (comma-separated)",required:!1,type:"array"},sizes:{label:"Sizes (comma-separated)",required:!1,type:"array"},featured:{label:"Featured",required:!1,type:"boolean"}},hs=5*1024*1024,Ze=10;function ps({isOpen:_,onClose:B,onSuccess:Q}){const[N,P]=T.useState("upload"),[de,ce]=T.useState([]),[Z,Y]=T.useState([]),[p,X]=T.useState({}),[ue,xe]=T.useState([]),[J,w]=T.useState({processed:0,total:0,successful:0,failed:0,isProcessing:!1}),[V,he]=T.useState([]),[ve,ge]=T.useState(!1),me=T.useRef(null),{user:fe}=mt(),{toast:ee}=ft(),se=()=>{P("upload"),ce([]),Y([]),X({}),xe([]),w({processed:0,total:0,successful:0,failed:0,isProcessing:!1}),he([]),ge(!1),me.current&&(me.current.value="")},I=()=>{se(),B()},s=()=>{const n=[{name:"Example Product 1",description:"A great product with excellent features",price:"29.99",quantity:"100",listingType:"buy_now",colors:"Red, Blue, Black",sizes:"S, M, L, XL",featured:"true"},{name:"Example Product 2",description:"Another amazing product",price:"49.99",quantity:"50",listingType:"buy_now",colors:"White, Gray",sizes:"One Size",featured:"false"}],o=Je.unparse(n),l=new Blob([o],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),v=URL.createObjectURL(l);h.setAttribute("href",v),h.setAttribute("download","product_upload_template.csv"),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h)},a=n=>!n.type.includes("csv")&&!n.name.endsWith(".csv")?"Please upload a CSV file":n.size>hs?"File size must be less than 5MB":null,i=n=>{Je.parse(n,{header:!0,skipEmptyLines:!0,complete:o=>{if(o.errors.length>0){ee({title:"CSV Parse Error",description:`Errors found in CSV: ${o.errors.map(x=>x.message).join(", ")}`,variant:"destructive"});return}if(o.data.length===0){ee({title:"Empty CSV",description:"The CSV file appears to be empty",variant:"destructive"});return}const h=Object.keys(o.data[0]).filter(x=>!cs.has(us(x)));Y(h),ce(o.data);const v={};h.forEach(x=>{const k=x.toLowerCase().trim(),g=Object.keys(Ke).find(y=>y.toLowerCase()===k||Ke[y].label.toLowerCase()===k);g?v[x]=g:v[x]=""}),X(v),P("mapping")},error:o=>{ee({title:"CSV Parse Error",description:o.message,variant:"destructive"})}})},c=n=>{const o=a(n);if(o){ee({title:"Invalid File",description:o,variant:"destructive"});return}i(n)},r=n=>{var l;const o=(l=n.target.files)==null?void 0:l[0];o&&c(o)},j=T.useCallback(n=>{n.preventDefault(),ge(!1);const o=n.dataTransfer.files[0];o&&c(o)},[]),z=T.useCallback(n=>{n.preventDefault(),ge(!0)},[]),S=T.useCallback(n=>{n.preventDefault(),ge(!1)},[]),D=async()=>{const n=[];de.forEach((o,l)=>{const h={name:"",price:0,quantity:0,rowIndex:l+1,errors:[],isValid:!0};Object.entries(p).forEach(([v,x])=>{var g;const k=(g=o[v])==null?void 0:g.trim();if(x&&k!==void 0){const y=Ke[x];if(y.required&&(!k||k===""))h.errors.push(`${y.label} is required`),h.isValid=!1;else if(k&&k!=="")switch(y.type){case"number":const A=parseFloat(k);isNaN(A)||A<0?(h.errors.push(`${y.label} must be a valid positive number`),h.isValid=!1):h[x]=A;break;case"select":const u=y;u.options&&!u.options.includes(k)?(h.errors.push(`${y.label} must be one of: ${u.options.join(", ")}`),h.isValid=!1):h[x]=k;break;case"array":const R=k.split(",").map(E=>E.trim()).filter(E=>E);h[x]=R;break;case"boolean":const O=k.toLowerCase();["true","1","yes","y"].includes(O)?h[x]=!0:["false","0","no","n",""].includes(O)?h[x]=!1:(h.errors.push(`${y.label} must be true/false, yes/no, 1/0, or y/n`),h.isValid=!1);break;default:h[x]=k}}}),dt.forEach(v=>{Object.values(p).includes(v)||(h.errors.push(`Required field '${v}' is not mapped`),h.isValid=!1)}),n.push(h)}),xe(n),P("preview")},f=async()=>{const n=ue.filter(h=>h.isValid);if(n.length===0){ee({title:"No Valid Products",description:"Please fix validation errors before proceeding",variant:"destructive"});return}P("processing"),w({processed:0,total:n.length,successful:0,failed:0,isProcessing:!0});const o=[];let l=0;for(let h=0;h<n.length;h+=Ze){const v=n.slice(h,h+Ze);try{const x=v.map(u=>({name:u.name,description:u.description||"",price:u.price,quantity:u.quantity,listingType:u.listingType||"buy_now",status:"inactive",colors:u.colors||[],sizes:u.sizes||[],featured:u.featured||!1}));if(console.log(`Uploading batch ${Math.floor(h/Ze)+1} with ${x.length} products`),!(fe!=null&&fe.id))throw new Error("User authentication required");const k=await fetch(`/api/products/bulkadd/${fe.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:x})});if(!k.ok){const u=await k.json();throw new Error(u.message||"Failed to upload batch")}const g=await k.json(),y=g.successful||v.length,A=g.failed||0;l+=y,A>0&&g.errors&&g.errors.forEach((u,R)=>{const O=h+R;O<v.length&&o.push({row:v[O].rowIndex,error:u.message||"Failed to create product",data:v[O]})}),w(u=>({...u,processed:u.processed+v.length,successful:u.successful+y,failed:u.failed+A}))}catch(x){console.error("Batch upload error:",x),v.forEach(k=>{o.push({row:k.rowIndex,error:x.message||"Batch upload failed",data:k})}),w(k=>({...k,processed:k.processed+v.length,failed:k.failed+v.length}))}}he(o),w(h=>({...h,isProcessing:!1})),P("complete"),be.invalidateQueries({queryKey:["external-products"]}),ee({title:"Upload Complete",description:`${l} products uploaded successfully${o.length>0?`, ${o.length} failed`:""}`,variant:l>0?"default":"destructive"})},q=()=>{if(V.length===0)return;const n=V.map(x=>({row:x.row,error:x.error,name:x.data.name,price:x.data.price,quantity:x.data.quantity})),o=Je.unparse(n),l=new Blob([o],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),v=URL.createObjectURL(l);h.setAttribute("href",v),h.setAttribute("download","upload_errors.csv"),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h)},m=ue.filter(n=>n.isValid).length,H=ue.length-m;return e.jsx(Ee,{open:_,onOpenChange:I,children:e.jsxs(Ie,{className:"max-w-6xl max-h-[90vh] overflow-y-auto","data-testid":"dialog-csv-upload",children:[e.jsxs(Ae,{children:[e.jsxs(De,{className:"flex items-center gap-2","data-testid":"text-csv-upload-title",children:[e.jsx(gt,{className:"h-5 w-5"}),"Bulk Product Upload"]}),e.jsx(Ue,{children:"Upload products in bulk using a CSV file. Download our template to get started."})]}),e.jsxs(Kt,{value:N,className:"w-full",children:[e.jsx("div",{className:"w-full overflow-x-auto pb-2",children:e.jsxs(Qt,{className:"inline-flex w-full min-w-max sm:w-full sm:min-w-0 sm:grid sm:grid-cols-3 lg:grid-cols-5",children:[e.jsx(Me,{value:"upload",disabled:N!=="upload","data-testid":"tab-upload",className:"flex-shrink-0 sm:flex-shrink",children:"Upload"}),e.jsx(Me,{value:"mapping",disabled:N==="upload","data-testid":"tab-mapping",className:"flex-shrink-0 sm:flex-shrink",children:"Mapping"}),e.jsx(Me,{value:"preview",disabled:!["preview","processing","complete"].includes(N),"data-testid":"tab-preview",className:"flex-shrink-0 sm:flex-shrink",children:"Preview"}),e.jsx(Me,{value:"processing",disabled:N!=="processing","data-testid":"tab-processing",className:"flex-shrink-0 sm:flex-shrink",children:"Processing"}),e.jsx(Me,{value:"complete",disabled:N!=="complete","data-testid":"tab-complete",className:"flex-shrink-0 sm:flex-shrink",children:"Complete"})]})}),e.jsxs($e,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Upload CSV File"}),e.jsxs(L,{variant:"outline",onClick:s,"data-testid":"button-download-template",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),e.jsx(ye,{children:e.jsx(Te,{className:"pt-6",children:e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${ve?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,onDrop:j,onDragOver:z,onDragLeave:S,"data-testid":"drop-zone-csv",children:[e.jsx(Wt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Drop your CSV file here"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"or click to browse your files"}),e.jsx(L,{onClick:()=>{var n;return(n=me.current)==null?void 0:n.click()},"data-testid":"button-browse-files",children:"Browse Files"}),e.jsx("input",{ref:me,type:"file",accept:".csv",onChange:r,className:"hidden","data-testid":"input-file-csv"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Maximum file size: 5MB. CSV format only."})]})})})]}),e.jsxs($e,{value:"mapping",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Map CSV Columns to Product Fields"}),e.jsx("p",{className:"text-muted-foreground",children:"Match your CSV columns to the correct product fields."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z.map(n=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ht,{children:['CSV Column: "',n,'"']}),e.jsxs(_e,{value:p[n]||"skip",onValueChange:o=>X(l=>({...l,[n]:o==="skip"?"":o})),"data-testid":`select-mapping-${n}`,children:[e.jsx(Ce,{children:e.jsx(Se,{placeholder:"Select product field"})}),e.jsxs(Pe,{children:[e.jsx(M,{value:"skip",children:e.jsx("span",{className:"text-muted-foreground",children:"Skip this column"})}),Object.entries(Ke).map(([o,l])=>e.jsx(M,{value:o,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.label}),l.required&&e.jsx(qe,{variant:"destructive",className:"text-xs",children:"Required"})]})},o))]})]})]},n))}),e.jsxs(zt,{children:[e.jsx(rt,{className:"h-4 w-4"}),e.jsxs(Mt,{children:["Make sure to map all required fields: ",dt.join(", ")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(L,{variant:"outline",onClick:()=>P("upload"),"data-testid":"button-back-to-upload",children:"Back"}),e.jsx(L,{onClick:D,"data-testid":"button-continue-to-preview",children:"Continue to Preview"})]})]}),e.jsxs($e,{value:"preview",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Preview & Validate"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your data before uploading. Fix any validation errors below."})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:[m," Valid"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{children:[H," Invalid"]})]})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded-lg",children:e.jsxs($t,{children:[e.jsx(Bt,{children:e.jsxs(at,{children:[e.jsx(Fe,{children:"Row"}),e.jsx(Fe,{children:"Status"}),e.jsx(Fe,{children:"Name"}),e.jsx(Fe,{children:"Price"}),e.jsx(Fe,{children:"Quantity"}),e.jsx(Fe,{children:"Errors"})]})}),e.jsx(Vt,{children:ue.map(n=>e.jsxs(at,{"data-testid":`row-product-${n.rowIndex}`,children:[e.jsx(Le,{children:n.rowIndex}),e.jsx(Le,{children:n.isValid?e.jsx(He,{className:"h-4 w-4 text-green-600"}):e.jsx(Xe,{className:"h-4 w-4 text-red-600"})}),e.jsx(Le,{children:n.name||"N/A"}),e.jsx(Le,{children:n.price>0?`$${n.price}`:"N/A"}),e.jsx(Le,{children:n.quantity>0?n.quantity:"N/A"}),e.jsx(Le,{children:n.errors.length>0&&e.jsx("div",{className:"space-y-1",children:n.errors.map((o,l)=>e.jsx(qe,{variant:"destructive",className:"text-xs block w-fit",children:o},l))})})]},n.rowIndex))})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(L,{variant:"outline",onClick:()=>P("mapping"),"data-testid":"button-back-to-mapping",children:"Back to Mapping"}),e.jsxs(L,{onClick:f,disabled:m===0,"data-testid":"button-start-upload",children:["Upload ",m," Products"]})]})]}),e.jsxs($e,{value:"processing",className:"space-y-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Gt,{className:"h-12 w-12 animate-spin mx-auto"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Processing Upload..."}),e.jsx("p",{className:"text-muted-foreground",children:"Uploading products in batches. Please don't close this window."})]}),e.jsx(ye,{children:e.jsx(Te,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[J.processed," / ",J.total]})]}),e.jsx(kt,{value:J.processed/J.total*100,className:"w-full","data-testid":"progress-upload"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Successful: ",J.successful]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{children:["Failed: ",J.failed]})]})]})]})})})]}),e.jsxs($e,{value:"complete",className:"space-y-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(He,{className:"h-16 w-16 text-green-600 mx-auto"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Upload Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your products have been processed."})]}),e.jsx(ye,{children:e.jsx(Te,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:J.successful}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Successful"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:J.failed}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Failed"})]})]})})}),V.length>0&&e.jsxs(ye,{children:[e.jsx(xt,{children:e.jsxs(Tt,{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"h-5 w-5 text-yellow-600"}),"Upload Errors"]})}),e.jsxs(Te,{children:[e.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[V.slice(0,5).map((n,o)=>e.jsxs("div",{className:"text-sm text-red-600",children:["Row ",n.row,": ",n.error]},o)),V.length>5&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["... and ",V.length-5," more errors"]})]}),e.jsxs(L,{variant:"outline",onClick:q,className:"mt-4","data-testid":"button-download-errors",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Download Error Report"]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(L,{variant:"outline",onClick:se,"data-testid":"button-upload-more",children:"Upload More Products"}),e.jsx(L,{onClick:()=>{Q(),I()},"data-testid":"button-done",children:"Done"})]})]})]})]})})}const ct={active:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",inactive:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",out_of_stock:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",draft:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"},ut={active:1,out_of_stock:2,draft:3,inactive:4};function sa(){const[_,B]=T.useState(""),[Q,N]=T.useState("all"),[P,de]=T.useState("all"),[ce,Z]=T.useState("newest"),[Y,p]=T.useState(1),[X,ue]=T.useState(20),[xe,J]=T.useState(!1),[w,V]=T.useState(new Set),[he,ve]=T.useState(!1),[ge,me]=T.useState(!1),[fe,ee]=T.useState(!1),[se,I]=T.useState(!1),[s,a]=T.useState(!1),[i,c]=T.useState(!1),[r,j]=T.useState({updateCategory:!1,updateShipping:!1,updateStatus:!1,updatePrice:!1,updateInventory:!1,categoryId:"",shippingProfileId:"",status:"",priceAmount:"",inventoryAmount:""}),[,z]=At(),{user:S}=mt(),{toast:D}=ft(),{data:f,isLoading:q,error:m,isError:H,refetch:n}=tt({queryKey:["external-products",S==null?void 0:S.id,Q,P,Y,X],queryFn:async()=>{const t=new URLSearchParams;S!=null&&S.id&&t.set("userId",S.id),Q&&Q!=="all"&&t.set("status",Q),P&&P!=="all"&&t.set("categoryId",P),t.set("type","inventory"),t.set("page",Y.toString()),t.set("limit",X.toString());const d=await fetch(`/api/products?${t.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!d.ok)throw new Error(`External API error: ${d.status}`);return d.json()},enabled:!!(S!=null&&S.id)}),{data:o,error:l,isLoading:h}=tt({queryKey:["shipping-profiles",S==null?void 0:S.id],queryFn:async()=>{const t=await fetch(`/api/shipping/profiles/${S==null?void 0:S.id}`);if(!t.ok)throw new Error("Failed to fetch shipping profiles");return t.json()},enabled:!!(S!=null&&S.id)}),v=Dt({mutationFn:async t=>{const d=await fetch(`/api/products/${t}/delete`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!d.ok)throw new Error("Failed to delete product");return d.json()},onSuccess:()=>{be.invalidateQueries({queryKey:["external-products"]}),D({title:"Product deleted successfully"})},onError:()=>{D({title:"Failed to delete product",variant:"destructive"})}}),x=t=>{z(`/inventory/edit/${t._id}`)},k=(t,d)=>{confirm(`Are you sure you want to delete "${d}"? This action cannot be undone.`)&&v.mutate(t)},g=t=>{z(`/product/${t._id}`)},y=()=>{z("/inventory/add")},A=()=>{J(!0)},u=()=>{n()},R=(t,d)=>{V($=>{const je=new Set($);return d?je.add(t):je.delete(t),je})},O=t=>{const d=(f==null?void 0:f.products)||[];V(t?new Set(d.map($=>$._id)):new Set)},E=()=>{V(new Set)},F=async t=>{if(w.size!==0)try{const d=Array.from(w);if((await Oe("PUT","/api/products/bulkedit",{productIds:d,updates:{category:t,status:"active"}})).ok)await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),D({title:"Success",description:`Category assigned to ${d.length} products`});else throw new Error("Failed to assign category")}catch{D({title:"Error",description:"Failed to assign category to products",variant:"destructive"})}},C=async t=>{if(w.size!==0)try{const d=Array.from(w);if((await Oe("PUT","/api/products/bulkedit",{productIds:d,updates:{shippingProfile:t,status:"active"}})).ok)await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),D({title:"Success",description:`Shipping profile assigned to ${d.length} products`});else throw new Error("Failed to assign shipping profile")}catch{D({title:"Error",description:"Failed to assign shipping profile to products",variant:"destructive"})}},te=async t=>{if(w.size!==0)try{const d=Array.from(w);if((await Oe("PUT","/api/products/bulkedit",{productIds:d,updates:{priceUpdate:t}})).ok)await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),D({title:"Success",description:`Prices updated for ${d.length} products`});else throw new Error("Failed to update prices")}catch{D({title:"Error",description:"Failed to update product prices",variant:"destructive"})}},b=async t=>{if(w.size!==0)try{const d=Array.from(w);if((await Oe("PUT","/api/products/bulkedit",{productIds:d,updates:{status:t}})).ok)await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),D({title:"Success",description:`Status updated to ${t} for ${d.length} products`});else throw new Error("Failed to update status")}catch{D({title:"Error",description:"Failed to update product status",variant:"destructive"})}},U=async t=>{if(w.size!==0)try{const d=Array.from(w);if((await Oe("PUT","/api/products/bulkedit",{productIds:d,updates:{inventoryUpdate:t}})).ok)await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),D({title:"Success",description:`Inventory updated for ${d.length} products`});else throw new Error("Failed to update inventory")}catch{D({title:"Error",description:"Failed to update product inventory",variant:"destructive"})}},ae=(t,d)=>{j($=>({...$,[t]:d,...t==="updateCategory"&&!d&&{categoryId:""},...t==="updateShipping"&&!d&&{shippingProfileId:""},...t==="updateStatus"&&!d&&{status:""},...t==="updatePrice"&&!d&&{priceAmount:""},...t==="updateInventory"&&!d&&{inventoryAmount:""}}))},oe=(t,d)=>{j($=>({...$,[t]:d}))},re=()=>{j({updateCategory:!1,updateShipping:!1,updateStatus:!1,updatePrice:!1,updateInventory:!1,categoryId:"",shippingProfileId:"",status:"",priceAmount:"",inventoryAmount:""})},we=async()=>{if(w.size!==0)try{const t=Array.from(w),d={};if(r.updateCategory&&r.categoryId&&(d.category=r.categoryId),r.updateShipping&&r.shippingProfileId&&(d.shippingProfile=r.shippingProfileId),r.updateStatus&&r.status&&(d.status=r.status),r.updatePrice&&r.priceAmount!==""&&(d.price=Number(r.priceAmount)),r.updateInventory&&r.inventoryAmount!==""&&(d.quantity=Number(r.inventoryAmount)),Object.keys(d).length===0){D({title:"No Updates Selected",description:"Please select at least one field to update",variant:"destructive"});return}if((await Oe("PUT","/api/products/bulkedit",{productIds:t,updates:d})).ok){await be.invalidateQueries({queryKey:["external-products"]}),V(new Set),c(!1),re();const je=Object.keys(d).length;D({title:"Success",description:`${je} field${je>1?"s":""} updated for ${t.length} products`})}else throw new Error("Failed to update products")}catch{D({title:"Error",description:"Failed to update products",variant:"destructive"})}},W=()=>{const t=r.updateCategory||r.updateShipping||r.updateStatus||r.updatePrice||r.updateInventory,d=(!r.updateCategory||r.categoryId)&&(!r.updateShipping||r.shippingProfileId)&&(!r.updateStatus||r.status)&&(!r.updatePrice||r.priceAmount!==""&&!isNaN(Number(r.priceAmount))&&Number(r.priceAmount)>=0)&&(!r.updateInventory||r.inventoryAmount!==""&&!isNaN(Number(r.inventoryAmount))&&Number(r.inventoryAmount)>=0);return t&&d},le=t=>{p(t)},K=t=>{ue(t),p(1)},G=()=>{p(1)},pe=t=>{N(t),G()},ze=t=>{de(t),G()},Be=t=>{Z(t),G()},ie=(f==null?void 0:f.products)||[],ne=(f==null?void 0:f.totalDoc)||0,Ne=(f==null?void 0:f.pages)||0,Re=(ie==null?void 0:ie.reduce((t,d)=>(d.category&&d.category._id&&!t.find($=>$._id===d.category._id)&&t.push(d.category),t),[]))||[],Ve=(ie==null?void 0:ie.filter(t=>{var $;return _===""||t.name.toLowerCase().includes(_.toLowerCase())||(($=t.description)==null?void 0:$.toLowerCase().includes(_.toLowerCase()))}).sort((t,d)=>{switch(ce){case"newest":return new Date(d.createdAt||"").getTime()-new Date(t.createdAt||"").getTime();case"oldest":return new Date(t.createdAt||"").getTime()-new Date(d.createdAt||"").getTime();case"name":return t.name.localeCompare(d.name);case"price-high":return d.price-t.price;case"price-low":return t.price-d.price;case"quantity-high":return d.quantity-t.quantity;case"quantity-low":return t.quantity-d.quantity;case"status":return(ut[t.status]||99)-(ut[d.status]||99);default:return 0}}))||[],_t=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),Ct=t=>{const d=ct[t]||ct.draft;return e.jsx(qe,{variant:"secondary",className:d,children:(t==null?void 0:t.replace("_"," ").toUpperCase())||"UNKNOWN"})};return q?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Inventory"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your product inventory"})]}),e.jsx("div",{className:"h-10 w-32 bg-muted animate-pulse rounded"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map((t,d)=>e.jsxs(ye,{className:"overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-muted animate-pulse"}),e.jsxs(xt,{children:[e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted animate-pulse rounded w-1/2"})]}),e.jsx(Te,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-muted animate-pulse rounded w-full"}),e.jsx("div",{className:"h-3 bg-muted animate-pulse rounded w-2/3"})]})})]},d))})]}):H?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Inventory"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your product inventory"})]})}),e.jsxs(ye,{className:"p-8 text-center",children:[e.jsx(Ge,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Unable to load inventory"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:(m==null?void 0:m.message)||"There was an error loading your products. Please try again."}),e.jsx(L,{onClick:()=>n(),"data-testid":"button-retry-products",children:"Try Again"})]})]}):e.jsxs("div",{className:"p-6 space-y-6","data-testid":"page-inventory",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground","data-testid":"text-page-title",children:"Inventory"}),e.jsxs("p",{className:"text-muted-foreground","data-testid":"text-page-description",children:["Manage your product inventory (",ne," products)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:"outline",onClick:A,"data-testid":"button-bulk-upload",children:[e.jsx(gt,{className:"h-4 w-4 mr-2"}),"Bulk Upload"]}),e.jsxs(L,{onClick:y,"data-testid":"button-add-product",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Add Product"]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Xt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(Rt,{placeholder:"Search products...",value:_,onChange:t=>B(t.target.value),className:"pl-10","data-testid":"input-search-products"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_e,{value:Q,onValueChange:pe,children:[e.jsx(Ce,{className:"w-[140px]","data-testid":"select-status-filter",children:e.jsx(Se,{placeholder:"Status"})}),e.jsxs(Pe,{children:[e.jsx(M,{value:"all",children:"All Status"}),e.jsx(M,{value:"active",children:"Active"}),e.jsx(M,{value:"inactive",children:"Inactive"}),e.jsx(M,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(M,{value:"draft",children:"Draft"})]})]}),e.jsxs(_e,{value:P,onValueChange:ze,children:[e.jsx(Ce,{className:"w-[140px]","data-testid":"select-category-filter",children:e.jsx(Se,{placeholder:"Category"})}),e.jsxs(Pe,{children:[e.jsx(M,{value:"all",children:"All Categories"}),Re.map(t=>e.jsx(M,{value:t._id,children:t.name},t._id))]})]}),e.jsxs(_e,{value:ce,onValueChange:Be,children:[e.jsx(Ce,{className:"w-[140px]","data-testid":"select-sort",children:e.jsx(Se,{placeholder:"Sort by"})}),e.jsxs(Pe,{children:[e.jsx(M,{value:"newest",children:"Newest"}),e.jsx(M,{value:"oldest",children:"Oldest"}),e.jsx(M,{value:"name",children:"Name"}),e.jsx(M,{value:"price-high",children:"Price: High to Low"}),e.jsx(M,{value:"price-low",children:"Price: Low to High"}),e.jsx(M,{value:"quantity-high",children:"Stock: High to Low"}),e.jsx(M,{value:"quantity-low",children:"Stock: Low to High"}),e.jsx(M,{value:"status",children:"Status"})]})]})]})]}),w.size>0&&e.jsx(ye,{className:"border-primary/20 bg-primary/5",children:e.jsx(Te,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:[w.size," product",w.size>1?"s":""," selected"]}),e.jsx(L,{variant:"outline",size:"sm",onClick:E,"data-testid":"button-clear-selection",children:"Clear Selection"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsxs(L,{variant:"default",size:"sm",onClick:()=>c(!0),"data-testid":"button-bulk-edit",children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),"Bulk Edit"]})})]})})}),Ve.length===0?e.jsxs(ye,{className:"p-8 text-center",children:[e.jsx(Ge,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No products found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:_||Q!=="all"||P!=="all"?"Try adjusting your search or filters to find products.":"Get started by adding your first product to your inventory."}),!_&&Q==="all"&&P==="all"&&e.jsxs(L,{onClick:y,"data-testid":"button-add-first-product",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Add Your First Product"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsx(Te,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-4 font-medium w-12",children:e.jsx(ke,{checked:w.size===Ve.length&&Ve.length>0,onCheckedChange:O,"data-testid":"checkbox-select-all"})}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Image"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Product"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Category"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Price"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Stock"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:Ve.map((t,d)=>{var $;return e.jsxs("tr",{className:`border-b hover:bg-muted/20 ${d%2===0?"bg-background":"bg-muted/10"} ${w.has(t._id)?"bg-primary/10":""} ${t.status==="draft"?"opacity-75 border-l-4 border-l-orange-300":""}`,"data-testid":`row-product-${t._id}`,children:[e.jsx("td",{className:"p-4",children:e.jsx(ke,{checked:w.has(t._id),onCheckedChange:je=>R(t._id,je),"data-testid":`checkbox-product-${t._id}`})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"w-12 h-12 bg-muted rounded overflow-hidden flex-shrink-0",children:t.images&&t.images.length>0?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover","data-testid":`img-product-${t._id}`}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ge,{className:"h-6 w-6 text-muted-foreground"})})})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-medium text-foreground truncate","data-testid":`text-product-name-${t._id}`,children:t.name}),t.description&&e.jsx("div",{className:"text-sm text-muted-foreground truncate mt-1","data-testid":`text-product-description-${t._id}`,children:t.description}),t.sku&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["SKU: ",t.sku]})]})}),e.jsx("td",{className:"p-4",children:e.jsx(qe,{variant:"secondary",className:"text-xs","data-testid":`badge-product-category-${t._id}`,children:(($=t.category)==null?void 0:$.name)||"Uncategorized"})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"font-semibold text-foreground","data-testid":`text-product-price-${t._id}`,children:_t(t.price)})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`font-medium ${t.quantity===0?"text-destructive":t.quantity<=10?"text-yellow-600 dark:text-yellow-400":"text-foreground"}`,"data-testid":`text-product-quantity-${t._id}`,children:t.quantity}),t.quantity===0&&e.jsx(qe,{variant:"destructive",className:"text-xs px-1.5 py-0.5","data-testid":`badge-out-of-stock-${t._id}`,children:"Out"}),t.quantity>0&&t.quantity<=10&&e.jsx(qe,{variant:"outline",className:"text-xs px-1.5 py-0.5 border-yellow-300 text-yellow-700 dark:text-yellow-400","data-testid":`badge-low-stock-${t._id}`,children:"Low"})]})}),e.jsx("td",{className:"p-4",children:Ct(t.status||"draft")}),e.jsx("td",{className:"p-4",children:e.jsxs(Ot,{children:[e.jsx(Ft,{asChild:!0,children:e.jsx(L,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0","data-testid":`button-product-actions-${t._id}`,children:e.jsx(Jt,{className:"h-4 w-4"})})}),e.jsxs(Lt,{align:"end",children:[e.jsxs(We,{onClick:()=>g(t),children:[e.jsx(Zt,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(We,{onClick:()=>x(t),children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),"Edit Product"]}),e.jsx(Ut,{}),e.jsx(We,{onClick:()=>k(t._id,t.name),className:"text-destructive",disabled:v.isPending,children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Yt,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Delete"]})})]})]})})]},t._id)})})]})})})}),e.jsx(qt,{currentPage:Y,totalPages:Ne,totalItems:ne,itemsPerPage:X,itemsPerPageOptions:[10,20,50,100],onPageChange:le,onItemsPerPageChange:K,showingText:"products",className:"bg-white dark:bg-gray-950 rounded-lg border p-4"})]}),e.jsx(ps,{isOpen:xe,onClose:()=>J(!1),onSuccess:u}),he&&e.jsx(Ee,{open:he,onOpenChange:ve,children:e.jsxs(Ie,{className:"max-w-md",children:[e.jsxs(Ae,{children:[e.jsx(De,{children:"Assign Category"}),e.jsxs(Ue,{children:["Choose a category to assign to ",w.size," selected product",w.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:Re.map(t=>e.jsx(L,{variant:"outline",className:"w-full justify-start",onClick:()=>{F(t._id),ve(!1)},"data-testid":`button-select-category-${t._id}`,children:t.name},t._id))})]})}),ge&&e.jsx(Ee,{open:ge,onOpenChange:me,children:e.jsxs(Ie,{className:"max-w-md",children:[e.jsxs(Ae,{children:[e.jsx(De,{children:"Assign Shipping Profile"}),e.jsxs(Ue,{children:["Choose a shipping profile to assign to ",w.size," selected product",w.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:o==null?void 0:o.map(t=>e.jsx(L,{variant:"outline",className:"w-full justify-start",onClick:()=>{C(t._id),me(!1)},"data-testid":`button-select-shipping-${t._id}`,children:t.name},t._id))})]})}),fe&&e.jsx(Ee,{open:fe,onOpenChange:ee,children:e.jsxs(Ie,{className:"max-w-md",children:[e.jsxs(Ae,{children:[e.jsx(De,{children:"Update Prices"}),e.jsxs(Ue,{children:["Update prices for ",w.size," selected product",w.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Increase price by what percentage?","10");t&&!isNaN(Number(t))&&(te({type:"increase",amount:Number(t),isPercentage:!0}),ee(!1))},"data-testid":"button-price-increase-percent",children:"Increase by %"}),e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease price by what percentage?","10");t&&!isNaN(Number(t))&&(te({type:"decrease",amount:Number(t),isPercentage:!0}),ee(!1))},"data-testid":"button-price-decrease-percent",children:"Decrease by %"}),e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Increase price by what amount?","5.00");t&&!isNaN(Number(t))&&(te({type:"increase",amount:Number(t),isPercentage:!1}),ee(!1))},"data-testid":"button-price-increase-amount",children:"Increase by $"}),e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease price by what amount?","5.00");t&&!isNaN(Number(t))&&(te({type:"decrease",amount:Number(t),isPercentage:!1}),ee(!1))},"data-testid":"button-price-decrease-amount",children:"Decrease by $"})]})})]})}),se&&e.jsx(Ee,{open:se,onOpenChange:I,children:e.jsxs(Ie,{className:"max-w-md",children:[e.jsxs(Ae,{children:[e.jsx(De,{children:"Update Status"}),e.jsxs(Ue,{children:["Set status for ",w.size," selected product",w.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:["active","inactive","draft"].map(t=>e.jsxs(L,{variant:"outline",className:"w-full justify-start capitalize",onClick:()=>{b(t),I(!1)},"data-testid":`button-set-status-${t}`,children:["Set to ",t]},t))})]})}),s&&e.jsx(Ee,{open:s,onOpenChange:a,children:e.jsxs(Ie,{className:"max-w-md",children:[e.jsxs(Ae,{children:[e.jsx(De,{children:"Update Inventory"}),e.jsxs(Ue,{children:["Update inventory for ",w.size," selected product",w.size>1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Set inventory to what price?","100");t&&!isNaN(Number(t))&&Number(t)>=0&&(U({type:"set",amount:Number(t)}),a(!1))},"data-testid":"button-inventory-set",children:"Set Quantity"}),e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Increase inventory by what price?","10");t&&!isNaN(Number(t))&&(U({type:"increase",amount:Number(t)}),a(!1))},"data-testid":"button-inventory-increase",children:"Increase Quantity"}),e.jsx(L,{variant:"outline",onClick:()=>{const t=window.prompt("Decrease inventory by what price?","10");t&&!isNaN(Number(t))&&(U({type:"decrease",amount:Number(t)}),a(!1))},"data-testid":"button-inventory-decrease",children:"Decrease Quantity"})]})})]})}),i&&e.jsx(Ee,{open:i,onOpenChange:c,children:e.jsxs(Ie,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ae,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"h-5 w-5"}),"Bulk Edit Products"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Update ",w.size," selected products"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{id:"update-category",checked:r.updateCategory,onCheckedChange:t=>ae("updateCategory",t),"data-testid":"checkbox-update-category"}),e.jsx("label",{htmlFor:"update-category",className:"text-sm font-medium",children:"Update Category"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(_e,{value:r.categoryId,onValueChange:t=>oe("categoryId",t),disabled:!r.updateCategory,children:[e.jsx(Ce,{"data-testid":"select-bulk-category",children:e.jsx(Se,{placeholder:"Select category"})}),e.jsx(Pe,{children:Re.map(t=>e.jsx(M,{value:t._id,children:t.name},t._id))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{id:"update-shipping",checked:r.updateShipping,onCheckedChange:t=>ae("updateShipping",t),"data-testid":"checkbox-update-shipping"}),e.jsx("label",{htmlFor:"update-shipping",className:"text-sm font-medium",children:"Update Shipping Profile"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(_e,{value:r.shippingProfileId,onValueChange:t=>oe("shippingProfileId",t),disabled:!r.updateShipping,children:[e.jsx(Ce,{"data-testid":"select-bulk-shipping",children:e.jsx(Se,{placeholder:"Select shipping profile"})}),e.jsx(Pe,{children:o==null?void 0:o.map(t=>e.jsx(M,{value:t._id,children:t.name},t._id))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{id:"update-status",checked:r.updateStatus,onCheckedChange:t=>ae("updateStatus",t),"data-testid":"checkbox-update-status"}),e.jsx("label",{htmlFor:"update-status",className:"text-sm font-medium",children:"Update Status"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs(_e,{value:r.status,onValueChange:t=>oe("status",t),disabled:!r.updateStatus,children:[e.jsx(Ce,{"data-testid":"select-bulk-status",children:e.jsx(Se,{placeholder:"Select status"})}),e.jsxs(Pe,{children:[e.jsx(M,{value:"active",children:"Active"}),e.jsx(M,{value:"inactive",children:"Inactive"}),e.jsx(M,{value:"draft",children:"Draft"}),e.jsx(M,{value:"out_of_stock",children:"Out of Stock"})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{id:"update-price",checked:r.updatePrice,onCheckedChange:t=>ae("updatePrice",t),"data-testid":"checkbox-update-price"}),e.jsx("label",{htmlFor:"update-price",className:"text-sm font-medium",children:"Update Price"})]}),e.jsx("div",{className:"ml-6",children:e.jsx("input",{type:"number",placeholder:"Price",value:r.priceAmount,onChange:t=>oe("priceAmount",t.target.value),className:"flex h-10 w-32 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:!r.updatePrice,"data-testid":"input-price-amount"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{id:"update-inventory",checked:r.updateInventory,onCheckedChange:t=>ae("updateInventory",t),"data-testid":"checkbox-update-inventory"}),e.jsx("label",{htmlFor:"update-inventory",className:"text-sm font-medium",children:"Update Inventory"})]}),e.jsx("div",{className:"ml-6",children:e.jsx("input",{type:"number",placeholder:"Quantity",value:r.inventoryAmount,onChange:t=>oe("inventoryAmount",t.target.value),className:"flex h-10 w-32 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:!r.updateInventory,"data-testid":"input-inventory-amount"})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[w.size," products will be updated"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>{c(!1),re()},"data-testid":"button-bulk-edit-cancel",children:"Cancel"}),e.jsx(L,{disabled:!W(),onClick:we,"data-testid":"button-bulk-edit-submit",children:"Update Products"})]})]})]})})]})}export{sa as default};
