import{r as y,j as z}from"./index-GnvmivW0.js";import{R as P,T as j,P as _,a as pt,b as be}from"./show-view-BvVfGJKH.js";import"./input-CDJz7BeV.js";import"./alert-BCAR44i4.js";import"./dialog-D1L4tMGI.js";import"./useMutation-DAKVWGzI.js";import"./firebase-chat-DdFjaliD.js";import"./buy-now-dialog-B3KMFRJV.js";import"./badge-CL9MXKGS.js";import"./separator-Datc7ShZ.js";import"./chevron-right-CXw-mF7y.js";import"./plus-CxBznHFO.js";import"./credit-card-B0WsppBV.js";import"./map-pin-Dn0fBe7g.js";import"./info-C2t8FPuk.js";import"./truck-DP2GNOS8.js";import"./make-offer-dialog-BV_W-Hrq.js";import"./dollar-sign-BPAh4ytq.js";import"./avatar-T6GBhCEI.js";import"./ellipsis-vertical-CJSSwQPi.js";import"./clock-C8Dw1EBc.js";import"./gift-BuwW3fIO.js";import"./package-DWwkENv3.js";import"./tag-jpmwmyGV.js";import"./chevron-up-Cda9uppk.js";import"./chevron-down-tcDKR_mK.js";import"./user-CCcReMRJ.js";import"./switch-C_scnTkE.js";import"./index-Vue-pIA6.js";import"./label-CbaFYhHW.js";import"./use-api-config-kum11Yvc.js";import"./user-badge-QQMJS_dE.js";import"./circle-check-big-CLZG244L.js";import"./star-Dvv0yNqt.js";import"./radio-B2CyFjtD.js";import"./users-S9Kp6t2T.js";import"./square-pen-BpFUY4eK.js";import"./shopping-bag-DVKU65dg.js";import"./flag-kVKTLwg_.js";import"./video--84agJTh.js";import"./isTomorrow-DSpd_Oy4.js";import"./constructNow-BkTMlMS8.js";import"./en-US-Cc-9gH5A.js";import"./isSameDay-bd8GA9bu.js";import"./format-Crz72tIO.js";import"./send-BnGR3x8s.js";import"./share-dialog-flp6buSS.js";import"./scroll-area-FQ9vYp1R.js";import"./index-CmYyiKyk.js";import"./index-BdQq_4o_.js";import"./form-CgNvNzQO.js";import"./textarea-DkmXbh6O.js";import"./select-EUq1_viI.js";import"./check-DoxmrmEj.js";import"./upload-images-Cu-UJNNB.js";var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ht={exports:{}},me=ht.exports,Et;function ge(){return Et||(Et=1,function(t){(function(r,e){t.exports?t.exports=e():r.log=e()})(me,function(){var r=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],i={},u=null;function f(h,k){var b=h[k];if(typeof b.bind=="function")return b.bind(h);try{return Function.prototype.bind.call(b,h)}catch{return function(){return Function.prototype.apply.apply(b,[h,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(h){return h==="debug"&&(h="log"),typeof console===e?!1:h==="trace"&&n?a:console[h]!==void 0?f(console,h):console.log!==void 0?f(console,"log"):r}function d(){for(var h=this.getLevel(),k=0;k<o.length;k++){var b=o[k];this[b]=k<h?r:this.methodFactory(b,h,this.name)}if(this.log=this.debug,typeof console===e&&h<this.levels.SILENT)return"No console available for logging"}function T(h){return function(){typeof console!==e&&(d.call(this),this[h].apply(this,arguments))}}function E(h,k,b){return l(h)||T.apply(this,arguments)}function m(h,k){var b=this,A,U,c,s="loglevel";typeof h=="string"?s+=":"+h:typeof h=="symbol"&&(s=void 0);function p(S){var C=(o[S]||"silent").toUpperCase();if(!(typeof window===e||!s)){try{window.localStorage[s]=C;return}catch{}try{window.document.cookie=encodeURIComponent(s)+"="+C+";"}catch{}}}function v(){var S;if(!(typeof window===e||!s)){try{S=window.localStorage[s]}catch{}if(typeof S===e)try{var C=window.document.cookie,N=encodeURIComponent(s),F=C.indexOf(N+"=");F!==-1&&(S=/^([^;]+)/.exec(C.slice(F+N.length+1))[1])}catch{}return b.levels[S]===void 0&&(S=void 0),S}}function w(){if(!(typeof window===e||!s)){try{window.localStorage.removeItem(s)}catch{}try{window.document.cookie=encodeURIComponent(s)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function g(S){var C=S;if(typeof C=="string"&&b.levels[C.toUpperCase()]!==void 0&&(C=b.levels[C.toUpperCase()]),typeof C=="number"&&C>=0&&C<=b.levels.SILENT)return C;throw new TypeError("log.setLevel() called with invalid level: "+S)}b.name=h,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=k||E,b.getLevel=function(){return c??U??A},b.setLevel=function(S,C){return c=g(S),C!==!1&&p(c),d.call(b)},b.setDefaultLevel=function(S){U=g(S),v()||b.setLevel(S,!1)},b.resetLevel=function(){c=null,w(),d.call(b)},b.enableAll=function(S){b.setLevel(b.levels.TRACE,S)},b.disableAll=function(S){b.setLevel(b.levels.SILENT,S)},b.rebuild=function(){if(u!==b&&(A=g(u.getLevel())),d.call(b),u===b)for(var S in i)i[S].rebuild()},A=g(u?u.getLevel():"WARN");var O=v();O!=null&&(c=g(O)),d.call(b)}u=new m,u.getLogger=function(h){if(typeof h!="symbol"&&typeof h!="string"||h==="")throw new TypeError("You must supply a name when creating a logger.");var k=i[h];return k||(k=i[h]=new m(h,u.methodFactory)),k};var x=typeof window!==e?window.log:void 0;return u.noConflict=function(){return typeof window!==e&&window.log===u&&(window.log=x),u},u.getLoggers=function(){return i},u.default=u,u})}(ht)),ht.exports}var we=ge();const Se=Mt(we);var dt=function(t,r){return dt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])},dt(t,r)};function M(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");dt(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}function ke(t,r,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function f(d){try{l(n.next(d))}catch(T){u(T)}}function a(d){try{l(n.throw(d))}catch(T){u(T)}}function l(d){d.done?i(d.value):o(d.value).then(f,a)}l((n=n.apply(t,[])).next())})}function Ft(t,r){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=f(0),u.throw=f(1),u.return=f(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(l){return function(d){return a([l,d])}}function a(l){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,l[0]&&(e=0)),e;)try{if(n=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,o=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){e.label=l[1];break}if(l[0]===6&&e.label<i[1]){e.label=i[1],i=l;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(l);break}i[2]&&e.ops.pop(),e.trys.pop();continue}l=r.call(t,e)}catch(d){l=[6,d],o=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function W(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function et(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),o,i=[],u;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(f){u={error:f}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i}function rt(t,r,e){if(arguments.length===2)for(var n=0,o=r.length,i;n<o;n++)(i||!(n in r))&&(i||(i=Array.prototype.slice.call(r,0,n)),i[n]=r[n]);return t.concat(i||Array.prototype.slice.call(r))}function V(t){return this instanceof V?(this.v=t,this):new V(t)}function xe(t,r,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(t,r||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(m){return function(x){return Promise.resolve(x).then(m,T)}}function f(m,x){n[m]&&(o[m]=function(h){return new Promise(function(k,b){i.push([m,h,k,b])>1||a(m,h)})},x&&(o[m]=x(o[m])))}function a(m,x){try{l(n[m](x))}catch(h){E(i[0][3],h)}}function l(m){m.value instanceof V?Promise.resolve(m.value.v).then(d,T):E(i[0][2],m)}function d(m){a("next",m)}function T(m){a("throw",m)}function E(m,x){m(x),i.shift(),i.length&&a(i[0][0],i[0][1])}}function _e(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t[Symbol.asyncIterator],e;return r?r.call(t):(t=typeof W=="function"?W(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(u){return new Promise(function(f,a){u=t[i](u),o(f,a,u.done,u.value)})}}function o(i,u,f,a){Promise.resolve(a).then(function(l){i({value:l,done:f})},u)}}function I(t){return typeof t=="function"}function bt(t){var r=function(n){Error.call(n),n.stack=new Error().stack},e=t(r);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var lt=bt(function(t){return function(r){t(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(e,n){return n+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function nt(t,r){if(t){var e=t.indexOf(r);0<=e&&t.splice(e,1)}}var B=function(){function t(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var r,e,n,o,i;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var f=W(u),a=f.next();!a.done;a=f.next()){var l=a.value;l.remove(this)}}catch(h){r={error:h}}finally{try{a&&!a.done&&(e=f.return)&&e.call(f)}finally{if(r)throw r.error}}else u.remove(this);var d=this.initialTeardown;if(I(d))try{d()}catch(h){i=h instanceof lt?h.errors:[h]}var T=this._finalizers;if(T){this._finalizers=null;try{for(var E=W(T),m=E.next();!m.done;m=E.next()){var x=m.value;try{Tt(x)}catch(h){i=i??[],h instanceof lt?i=rt(rt([],et(i)),et(h.errors)):i.push(h)}}}catch(h){n={error:h}}finally{try{m&&!m.done&&(o=E.return)&&o.call(E)}finally{if(n)throw n.error}}}if(i)throw new lt(i)}},t.prototype.add=function(r){var e;if(r&&r!==this)if(this.closed)Tt(r);else{if(r instanceof t){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(r)}},t.prototype._hasParent=function(r){var e=this._parentage;return e===r||Array.isArray(e)&&e.includes(r)},t.prototype._addParent=function(r){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(r),e):e?[e,r]:r},t.prototype._removeParent=function(r){var e=this._parentage;e===r?this._parentage=null:Array.isArray(e)&&nt(e,r)},t.prototype.remove=function(r){var e=this._finalizers;e&&nt(e,r),r instanceof t&&r._removeParent(this)},t.EMPTY=function(){var r=new t;return r.closed=!0,r}(),t}(),$t=B.EMPTY;function zt(t){return t instanceof B||t&&"closed"in t&&I(t.remove)&&I(t.add)&&I(t.unsubscribe)}function Tt(t){I(t)?t():t.unsubscribe()}var Ee={Promise:void 0},Te={setTimeout:function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];return setTimeout.apply(void 0,rt([t,r],et(e)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function Dt(t){Te.setTimeout(function(){throw t})}function Ct(){}function tt(t){t()}var mt=function(t){M(r,t);function r(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,zt(e)&&e.add(n)):n.destination=Pe,n}return r.create=function(e,n,o){return new vt(e,n,o)},r.prototype.next=function(e){this.isStopped||this._next(e)},r.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(e){this.destination.next(e)},r.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(B),Ce=function(){function t(r){this.partialObserver=r}return t.prototype.next=function(r){var e=this.partialObserver;if(e.next)try{e.next(r)}catch(n){q(n)}},t.prototype.error=function(r){var e=this.partialObserver;if(e.error)try{e.error(r)}catch(n){q(n)}else q(r)},t.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(e){q(e)}},t}(),vt=function(t){M(r,t);function r(e,n,o){var i=t.call(this)||this,u;return I(e)||!e?u={next:e??void 0,error:n??void 0,complete:o??void 0}:u=e,i.destination=new Ce(u),i}return r}(mt);function q(t){Dt(t)}function Oe(t){throw t}var Pe={closed:!0,next:Ct,error:Oe,complete:Ct},gt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Jt(t){return t}function Le(t){return t.length===0?Jt:t.length===1?t[0]:function(r){return t.reduce(function(e,n){return n(e)},r)}}var R=function(){function t(r){r&&(this._subscribe=r)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(r,e,n){var o=this,i=Ae(r)?r:new vt(r,e,n);return tt(function(){var u=o,f=u.operator,a=u.source;i.add(f?f.call(i,a):a?o._subscribe(i):o._trySubscribe(i))}),i},t.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(e){r.error(e)}},t.prototype.forEach=function(r,e){var n=this;return e=Ot(e),new e(function(o,i){var u=new vt({next:function(f){try{r(f)}catch(a){i(a),u.unsubscribe()}},error:i,complete:o});n.subscribe(u)})},t.prototype._subscribe=function(r){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(r)},t.prototype[gt]=function(){return this},t.prototype.pipe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Le(r)(this)},t.prototype.toPromise=function(r){var e=this;return r=Ot(r),new r(function(n,o){var i;e.subscribe(function(u){return i=u},function(u){return o(u)},function(){return n(i)})})},t.create=function(r){return new t(r)},t}();function Ot(t){var r;return(r=t??Ee.Promise)!==null&&r!==void 0?r:Promise}function Ie(t){return t&&I(t.next)&&I(t.error)&&I(t.complete)}function Ae(t){return t&&t instanceof mt||Ie(t)&&zt(t)}function je(t){return I(t==null?void 0:t.lift)}function G(t){return function(r){if(je(r))return r.lift(function(e){try{return t(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ot(t,r,e,n,o){return new Re(t,r,e,n,o)}var Re=function(t){M(r,t);function r(e,n,o,i,u,f){var a=t.call(this,e)||this;return a.onFinalize=u,a.shouldUnsubscribe=f,a._next=n?function(l){try{n(l)}catch(d){e.error(d)}}:t.prototype._next,a._error=i?function(l){try{i(l)}catch(d){e.error(d)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=o?function(){try{o()}catch(l){e.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,a}return r.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}},r}(mt),Ne=bt(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Vt=function(t){M(r,t);function r(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.prototype.lift=function(e){var n=new Pt(this,this);return n.operator=e,n},r.prototype._throwIfClosed=function(){if(this.closed)throw new Ne},r.prototype.next=function(e){var n=this;tt(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var u=W(n.currentObservers),f=u.next();!f.done;f=u.next()){var a=f.value;a.next(e)}}catch(l){o={error:l}}finally{try{f&&!f.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}}})},r.prototype.error=function(e){var n=this;tt(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=e;for(var o=n.observers;o.length;)o.shift().error(e)}})},r.prototype.complete=function(){var e=this;tt(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var n=e.observers;n.length;)n.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},r.prototype._innerSubscribe=function(e){var n=this,o=this,i=o.hasError,u=o.isStopped,f=o.observers;return i||u?$t:(this.currentObservers=null,f.push(e),new B(function(){n.currentObservers=null,nt(f,e)}))},r.prototype._checkFinalizedStatuses=function(e){var n=this,o=n.hasError,i=n.thrownError,u=n.isStopped;o?e.error(i):u&&e.complete()},r.prototype.asObservable=function(){var e=new R;return e.source=this,e},r.create=function(e,n){return new Pt(e,n)},r}(R),Pt=function(t){M(r,t);function r(e,n){var o=t.call(this)||this;return o.destination=e,o.source=n,o}return r.prototype.next=function(e){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,e)},r.prototype.error=function(e){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,e)},r.prototype.complete=function(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)},r.prototype._subscribe=function(e){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&o!==void 0?o:$t},r}(Vt);(function(t){M(r,t);function r(e){var n=t.call(this)||this;return n._value=e,n}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return!n.closed&&e.next(this._value),n},r.prototype.getValue=function(){var e=this,n=e.hasError,o=e.thrownError,i=e._value;if(n)throw o;return this._throwIfClosed(),i},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r})(Vt);var Ue={now:function(){return Date.now()}},Me=function(t){M(r,t);function r(e,n){return t.call(this)||this}return r.prototype.schedule=function(e,n){return this},r}(B),Lt={setInterval:function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];return setInterval.apply(void 0,rt([t,r],et(e)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},Fe=function(t){M(r,t);function r(e,n){var o=t.call(this,e,n)||this;return o.scheduler=e,o.work=n,o.pending=!1,o}return r.prototype.schedule=function(e,n){var o;if(n===void 0&&(n=0),this.closed)return this;this.state=e;var i=this.id,u=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(u,i,n)),this.pending=!0,this.delay=n,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(u,this.id,n),this},r.prototype.requestAsyncId=function(e,n,o){return o===void 0&&(o=0),Lt.setInterval(e.flush.bind(e,this),o)},r.prototype.recycleAsyncId=function(e,n,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return n;n!=null&&Lt.clearInterval(n)},r.prototype.execute=function(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(e,n);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(e,n){var o=!1,i;try{this.work(e)}catch(u){o=!0,i=u||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},r.prototype.unsubscribe=function(){if(!this.closed){var e=this,n=e.id,o=e.scheduler,i=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,nt(i,this),n!=null&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},r}(Me),It=function(){function t(r,e){e===void 0&&(e=t.now),this.schedulerActionCtor=r,this.now=e}return t.prototype.schedule=function(r,e,n){return e===void 0&&(e=0),new this.schedulerActionCtor(this,r).schedule(n,e)},t.now=Ue.now,t}(),$e=function(t){M(r,t);function r(e,n){n===void 0&&(n=It.now);var o=t.call(this,e,n)||this;return o.actions=[],o._active=!1,o}return r.prototype.flush=function(e){var n=this.actions;if(this._active){n.push(e);return}var o;this._active=!0;do if(o=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,o){for(;e=n.shift();)e.unsubscribe();throw o}},r}(It);new $e(Fe);function ze(t){return t&&I(t.schedule)}function De(t){return t[t.length-1]}function Wt(t){return ze(De(t))?t.pop():void 0}var Yt=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function Ht(t){return I(t==null?void 0:t.then)}function Bt(t){return I(t[gt])}function Gt(t){return Symbol.asyncIterator&&I(t==null?void 0:t[Symbol.asyncIterator])}function Kt(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Je(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qt=Je();function Zt(t){return I(t==null?void 0:t[Qt])}function qt(t){return xe(this,arguments,function(){var r,e,n,o;return Ft(this,function(i){switch(i.label){case 0:r=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,V(r.read())];case 3:return e=i.sent(),n=e.value,o=e.done,o?[4,V(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,V(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Xt(t){return I(t==null?void 0:t.getReader)}function K(t){if(t instanceof R)return t;if(t!=null){if(Bt(t))return Ve(t);if(Yt(t))return We(t);if(Ht(t))return Ye(t);if(Gt(t))return te(t);if(Zt(t))return He(t);if(Xt(t))return Be(t)}throw Kt(t)}function Ve(t){return new R(function(r){var e=t[gt]();if(I(e.subscribe))return e.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function We(t){return new R(function(r){for(var e=0;e<t.length&&!r.closed;e++)r.next(t[e]);r.complete()})}function Ye(t){return new R(function(r){t.then(function(e){r.closed||(r.next(e),r.complete())},function(e){return r.error(e)}).then(null,Dt)})}function He(t){return new R(function(r){var e,n;try{for(var o=W(t),i=o.next();!i.done;i=o.next()){var u=i.value;if(r.next(u),r.closed)return}}catch(f){e={error:f}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}r.complete()})}function te(t){return new R(function(r){Ge(t,r).catch(function(e){return r.error(e)})})}function Be(t){return te(qt(t))}function Ge(t,r){var e,n,o,i;return ke(this,void 0,void 0,function(){var u,f;return Ft(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),e=_e(t),a.label=1;case 1:return[4,e.next()];case 2:if(n=a.sent(),!!n.done)return[3,4];if(u=n.value,r.next(u),r.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return f=a.sent(),o={error:f},[3,11];case 6:return a.trys.push([6,,9,10]),n&&!n.done&&(i=e.return)?[4,i.call(e)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function D(t,r,e,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=r.schedule(function(){e(),o?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(i),!o)return i}function ee(t,r){return r===void 0&&(r=0),G(function(e,n){e.subscribe(ot(n,function(o){return D(n,t,function(){return n.next(o)},r)},function(){return D(n,t,function(){return n.complete()},r)},function(o){return D(n,t,function(){return n.error(o)},r)}))})}function re(t,r){return r===void 0&&(r=0),G(function(e,n){n.add(t.schedule(function(){return e.subscribe(n)},r))})}function Ke(t,r){return K(t).pipe(re(r),ee(r))}function Qe(t,r){return K(t).pipe(re(r),ee(r))}function Ze(t,r){return new R(function(e){var n=0;return r.schedule(function(){n===t.length?e.complete():(e.next(t[n++]),e.closed||this.schedule())})})}function qe(t,r){return new R(function(e){var n;return D(e,r,function(){n=t[Qt](),D(e,r,function(){var o,i,u;try{o=n.next(),i=o.value,u=o.done}catch(f){e.error(f);return}u?e.complete():e.next(i)},0,!0)}),function(){return I(n==null?void 0:n.return)&&n.return()}})}function ne(t,r){if(!t)throw new Error("Iterable cannot be null");return new R(function(e){D(e,r,function(){var n=t[Symbol.asyncIterator]();D(e,r,function(){n.next().then(function(o){o.done?e.complete():e.next(o.value)})},0,!0)})})}function Xe(t,r){return ne(qt(t),r)}function tr(t,r){if(t!=null){if(Bt(t))return Ke(t,r);if(Yt(t))return Ze(t,r);if(Ht(t))return Qe(t,r);if(Gt(t))return ne(t,r);if(Zt(t))return qe(t,r);if(Xt(t))return Xe(t,r)}throw Kt(t)}function er(t,r){return r?tr(t,r):K(t)}bt(function(t){return function(r){r===void 0&&(r=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=r}});function it(t,r){return G(function(e,n){var o=0;e.subscribe(ot(n,function(i){n.next(t.call(r,i,o++))}))})}function rr(t,r,e,n,o,i,u,f){var a=[],l=0,d=0,T=!1,E=function(){T&&!a.length&&!l&&r.complete()},m=function(h){return l<n?x(h):a.push(h)},x=function(h){l++;var k=!1;K(e(h,d++)).subscribe(ot(r,function(b){r.next(b)},function(){k=!0},void 0,function(){if(k)try{l--;for(var b=function(){var A=a.shift();u||x(A)};a.length&&l<n;)b();E()}catch(A){r.error(A)}}))};return t.subscribe(ot(r,m,function(){T=!0,E()})),function(){}}function oe(t,r,e){return e===void 0&&(e=1/0),I(r)?oe(function(n,o){return it(function(i,u){return r(n,i,o,u)})(K(t(n,o)))},e):(typeof r=="number"&&(e=r),G(function(n,o){return rr(n,o,t,e)}))}function nr(t){return oe(Jt,t)}function or(){return nr(1)}function At(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return or()(er(t,Wt(t)))}function ut(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=Wt(t);return G(function(n,o){(e?At(t,n,e):At(t,n)).subscribe(o)})}var ir="lk";function wt(t){return typeof t>"u"?!1:ur(t)||cr(t)}function ur(t){var r;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((r=t.publication)==null?void 0:r.track)<"u":!1}function cr(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function sr(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function ar(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(sr(t))return`${t.participant.identity}_${t.source}_placeholder`;if(wt(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}var lr=[P.ConnectionStateChanged,P.RoomMetadataChanged,P.ActiveSpeakersChanged,P.ConnectionQualityChanged,P.ParticipantConnected,P.ParticipantDisconnected,P.ParticipantPermissionsChanged,P.ParticipantMetadataChanged,P.ParticipantNameChanged,P.ParticipantAttributesChanged,P.TrackMuted,P.TrackUnmuted,P.TrackPublished,P.TrackUnpublished,P.TrackStreamStateChanged,P.TrackSubscriptionFailed,P.TrackSubscriptionPermissionChanged,P.TrackSubscriptionStatusChanged],fr=[...lr,P.LocalTrackPublished,P.LocalTrackUnpublished];_.TrackPublished,_.TrackUnpublished,_.TrackMuted,_.TrackUnmuted,_.TrackStreamStateChanged,_.TrackSubscribed,_.TrackUnsubscribed,_.TrackSubscriptionPermissionChanged,_.TrackSubscriptionFailed,_.LocalTrackPublished,_.LocalTrackUnpublished;var pr=[_.ConnectionQualityChanged,_.IsSpeakingChanged,_.ParticipantMetadataChanged,_.ParticipantPermissionsChanged,_.TrackMuted,_.TrackUnmuted,_.TrackPublished,_.TrackUnpublished,_.TrackStreamStateChanged,_.TrackSubscriptionFailed,_.TrackSubscriptionPermissionChanged,_.TrackSubscriptionStatusChanged];[...pr,_.LocalTrackPublished,_.LocalTrackUnpublished];var J=Se.getLogger("lk-components-js");J.setDefaultLevel("WARN");var ie=(t=>(t.AgentState="lk.agent.state",t.PublishOnBehalf="lk.publish_on_behalf",t.TranscriptionFinal="lk.transcription_final",t.TranscriptionSegmentId="lk.segment_id",t.TranscribedTrackId="lk.transcribed_track_id",t))(ie||{});function ue(t){return typeof t=="object"}function ce(t){return Array.isArray(t)&&t.filter(ue).length>0}function hr(t){return`${ir}-${t}`}function dr(t){const r=yt(t),e=br(t.participant).pipe(it(()=>yt(t)),ut(r));return{className:hr(t.source===j.Source.Camera||t.source===j.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:e}}function yt(t){if(wt(t))return t.publication;{const{source:r,name:e,participant:n}=t;if(r&&e)return n.getTrackPublications().find(o=>o.source===r&&o.trackName===e);if(e)return n.getTrackPublicationByName(e);if(r)return n.getTrackPublication(r);throw new Error("At least one of source and name needs to be defined")}}function vr(t,...r){return new R(e=>{const n=()=>{e.next(t)};return r.forEach(o=>{t.on(o,n)}),()=>{r.forEach(o=>{t.off(o,n)})}}).pipe(ut(t))}function yr(t,...r){return new R(e=>{const n=()=>{e.next(t)};return r.forEach(o=>{t.on(o,n)}),()=>{r.forEach(o=>{t.off(o,n)})}}).pipe(ut(t))}function br(t){return yr(t,_.TrackMuted,_.TrackUnmuted,_.ParticipantPermissionsChanged,_.TrackPublished,_.TrackUnpublished,_.LocalTrackPublished,_.LocalTrackUnpublished,_.MediaDevicesError,_.TrackSubscriptionStatusChanged).pipe(it(r=>{const{isMicrophoneEnabled:e,isCameraEnabled:n,isScreenShareEnabled:o}=r,i=r.getTrackPublication(j.Source.Microphone),u=r.getTrackPublication(j.Source.Camera);return{isCameraEnabled:n,isMicrophoneEnabled:e,isScreenShareEnabled:o,cameraTrack:u,microphoneTrack:i,participant:r}}))}function jt(t,r,e=!0){const n=[t.localParticipant,...Array.from(t.remoteParticipants.values())],o=[];return n.forEach(i=>{r.forEach(u=>{const f=Array.from(i.trackPublications.values()).filter(a=>a.source===u&&(!e||a.track)).map(a=>({participant:i,publication:a,source:a.source}));o.push(...f)})}),{trackReferences:o,participants:n}}function mr(t,r,e){var n,o;const i=(n=e.additionalRoomEvents)!=null?n:fr,u=(o=e.onlySubscribed)!=null?o:!0,f=Array.from(new Set([P.ParticipantConnected,P.ParticipantDisconnected,P.ConnectionStateChanged,P.LocalTrackPublished,P.LocalTrackUnpublished,P.TrackPublished,P.TrackUnpublished,P.TrackSubscriptionStatusChanged,...i]).values());return vr(t,...f).pipe(it(a=>{const l=jt(a,r,u);return J.debug(`TrackReference[] was updated. (length ${l.trackReferences.length})`,l),l}),ut(jt(t,r,u)))}y.createContext(void 0);const gr=y.createContext(void 0);function wr(){return y.useContext(gr)}function se(t){const r=wr(),e=t??r;if(!e)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return e}y.createContext(void 0);const ae=y.createContext(void 0);function Sr(){return y.useContext(ae)}function kr(t){const r=Sr(),e=t??r;if(!e)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return e}y.createContext(void 0);y.createContext(void 0);function le(t){var r,e,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(r=0;r<o;r++)t[r]&&(e=le(t[r]))&&(n&&(n+=" "),n+=e)}else for(e in t)t[e]&&(n&&(n+=" "),n+=e);return n}function xr(){for(var t,r,e=0,n="",o=arguments.length;e<o;e++)(t=arguments[e])&&(r=le(t))&&(n&&(n+=" "),n+=r);return n}function _r(...t){return(...r)=>{for(const e of t)if(typeof e=="function")try{e(...r)}catch(n){console.error(n)}}}function Er(...t){const r={...t[0]};for(let e=1;e<t.length;e++){const n=t[e];for(const o in n){const i=r[o],u=n[o];typeof i=="function"&&typeof u=="function"&&o[0]==="o"&&o[1]==="n"&&o.charCodeAt(2)>=65&&o.charCodeAt(2)<=90?r[o]=_r(i,u):(o==="className"||o==="UNSAFE_className")&&typeof i=="string"&&typeof u=="string"?r[o]=xr(i,u):r[o]=u!==void 0?u:i}}return r}function Tr(t){return t!==void 0}function Cr(...t){return Er(...t.filter(Tr))}function fe(t=[j.Source.Camera,j.Source.Microphone,j.Source.ScreenShare,j.Source.ScreenShareAudio,j.Source.Unknown],r={}){const e=kr(r.room),[n,o]=y.useState([]),[i,u]=y.useState([]),f=y.useMemo(()=>t.map(a=>ue(a)?a.source:a),[JSON.stringify(t)]);return y.useEffect(()=>{const a=mr(e,f,{additionalRoomEvents:r.updateOnlyOn,onlySubscribed:r.onlySubscribed}).subscribe(({trackReferences:l,participants:d})=>{J.debug("setting track bundles",l,d),o(l),u(d)});return()=>a.unsubscribe()},[e,JSON.stringify(r.onlySubscribed),JSON.stringify(r.updateOnlyOn),JSON.stringify(t)]),y.useMemo(()=>{if(ce(t)){const a=Pr(t,i),l=Array.from(n);return i.forEach(d=>{a.has(d.identity)&&(a.get(d.identity)??[]).forEach(T=>{if(n.find(({participant:m,publication:x})=>d.identity===m.identity&&x.source===T))return;J.debug(`Add ${T} placeholder for participant ${d.identity}.`);const E={participant:d,source:T};l.push(E)})}),l}else return n},[n,i,t])}function Or(t,r){const e=new Set(t);for(const n of r)e.delete(n);return e}function Pr(t,r){const e=new Map;if(ce(t)){const n=t.filter(o=>o.withPlaceholder).map(o=>o.source);r.forEach(o=>{const i=o.getTrackPublications().map(f=>{var a;return(a=f.track)==null?void 0:a.source}).filter(f=>f!==void 0),u=Array.from(Or(new Set(n),new Set(i)));u.length>0&&e.set(o.identity,u)})}return e}ie.AgentState;var X={exports:{}},Rt;function Lr(){if(Rt)return X.exports;Rt=1;var t=typeof Reflect=="object"?Reflect:null,r=t&&typeof t.apply=="function"?t.apply:function(c,s,p){return Function.prototype.apply.call(c,s,p)},e;t&&typeof t.ownKeys=="function"?e=t.ownKeys:Object.getOwnPropertySymbols?e=function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:e=function(c){return Object.getOwnPropertyNames(c)};function n(c){console&&console.warn&&console.warn(c)}var o=Number.isNaN||function(c){return c!==c};function i(){i.init.call(this)}X.exports=i,X.exports.once=b,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var u=10;function f(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(c){if(typeof c!="number"||c<0||o(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");u=c}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(c){if(typeof c!="number"||c<0||o(c))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+c+".");return this._maxListeners=c,this};function a(c){return c._maxListeners===void 0?i.defaultMaxListeners:c._maxListeners}i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(c){for(var s=[],p=1;p<arguments.length;p++)s.push(arguments[p]);var v=c==="error",w=this._events;if(w!==void 0)v=v&&w.error===void 0;else if(!v)return!1;if(v){var g;if(s.length>0&&(g=s[0]),g instanceof Error)throw g;var O=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw O.context=g,O}var S=w[c];if(S===void 0)return!1;if(typeof S=="function")r(S,this,s);else for(var C=S.length,N=x(S,C),p=0;p<C;++p)r(N[p],this,s);return!0};function l(c,s,p,v){var w,g,O;if(f(p),g=c._events,g===void 0?(g=c._events=Object.create(null),c._eventsCount=0):(g.newListener!==void 0&&(c.emit("newListener",s,p.listener?p.listener:p),g=c._events),O=g[s]),O===void 0)O=g[s]=p,++c._eventsCount;else if(typeof O=="function"?O=g[s]=v?[p,O]:[O,p]:v?O.unshift(p):O.push(p),w=a(c),w>0&&O.length>w&&!O.warned){O.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=c,S.type=s,S.count=O.length,n(S)}return c}i.prototype.addListener=function(c,s){return l(this,c,s,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(c,s){return l(this,c,s,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(c,s,p){var v={fired:!1,wrapFn:void 0,target:c,type:s,listener:p},w=d.bind(v);return w.listener=p,v.wrapFn=w,w}i.prototype.once=function(c,s){return f(s),this.on(c,T(this,c,s)),this},i.prototype.prependOnceListener=function(c,s){return f(s),this.prependListener(c,T(this,c,s)),this},i.prototype.removeListener=function(c,s){var p,v,w,g,O;if(f(s),v=this._events,v===void 0)return this;if(p=v[c],p===void 0)return this;if(p===s||p.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete v[c],v.removeListener&&this.emit("removeListener",c,p.listener||s));else if(typeof p!="function"){for(w=-1,g=p.length-1;g>=0;g--)if(p[g]===s||p[g].listener===s){O=p[g].listener,w=g;break}if(w<0)return this;w===0?p.shift():h(p,w),p.length===1&&(v[c]=p[0]),v.removeListener!==void 0&&this.emit("removeListener",c,O||s)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(c){var s,p,v;if(p=this._events,p===void 0)return this;if(p.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):p[c]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete p[c]),this;if(arguments.length===0){var w=Object.keys(p),g;for(v=0;v<w.length;++v)g=w[v],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=p[c],typeof s=="function")this.removeListener(c,s);else if(s!==void 0)for(v=s.length-1;v>=0;v--)this.removeListener(c,s[v]);return this};function E(c,s,p){var v=c._events;if(v===void 0)return[];var w=v[s];return w===void 0?[]:typeof w=="function"?p?[w.listener||w]:[w]:p?k(w):x(w,w.length)}i.prototype.listeners=function(c){return E(this,c,!0)},i.prototype.rawListeners=function(c){return E(this,c,!1)},i.listenerCount=function(c,s){return typeof c.listenerCount=="function"?c.listenerCount(s):m.call(c,s)},i.prototype.listenerCount=m;function m(c){var s=this._events;if(s!==void 0){var p=s[c];if(typeof p=="function")return 1;if(p!==void 0)return p.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function x(c,s){for(var p=new Array(s),v=0;v<s;++v)p[v]=c[v];return p}function h(c,s){for(;s+1<c.length;s++)c[s]=c[s+1];c.pop()}function k(c){for(var s=new Array(c.length),p=0;p<s.length;++p)s[p]=c[p].listener||c[p];return s}function b(c,s){return new Promise(function(p,v){function w(O){c.removeListener(s,g),v(O)}function g(){typeof c.removeListener=="function"&&c.removeListener("error",w),p([].slice.call(arguments))}U(c,s,g,{once:!0}),s!=="error"&&A(c,w,{once:!0})})}function A(c,s,p){typeof c.on=="function"&&U(c,"error",s,p)}function U(c,s,p,v){if(typeof c.on=="function")v.once?c.once(s,p):c.on(s,p);else if(typeof c.addEventListener=="function")c.addEventListener(s,function w(g){v.once&&c.removeEventListener(s,w),p(g)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}return X.exports}Lr();function pe(t,r={}){const[e,n]=y.useState(yt(t)),[o,i]=y.useState(e==null?void 0:e.isMuted),[u,f]=y.useState(e==null?void 0:e.isSubscribed),[a,l]=y.useState(e==null?void 0:e.track),[d,T]=y.useState("landscape"),E=y.useRef(),{className:m,trackObserver:x}=y.useMemo(()=>dr(t),[t.participant.sid??t.participant.identity,t.source,wt(t)&&t.publication.trackSid]);return y.useEffect(()=>{const h=x.subscribe(k=>{J.debug("update track",k),n(k),i(k==null?void 0:k.isMuted),f(k==null?void 0:k.isSubscribed),l(k==null?void 0:k.track)});return()=>h==null?void 0:h.unsubscribe()},[x]),y.useEffect(()=>{var h,k;return a&&(E.current&&a.detach(E.current),(h=r.element)!=null&&h.current&&!(t.participant.isLocal&&(a==null?void 0:a.kind)==="audio")&&a.attach(r.element.current)),E.current=(k=r.element)==null?void 0:k.current,()=>{E.current&&(a==null||a.detach(E.current))}},[a,r.element]),y.useEffect(()=>{var h,k;if(typeof((h=e==null?void 0:e.dimensions)==null?void 0:h.width)=="number"&&typeof((k=e==null?void 0:e.dimensions)==null?void 0:k.height)=="number"){const b=e.dimensions.width>e.dimensions.height?"landscape":"portrait";T(b)}},[e]),{publication:e,isMuted:o,isSubscribed:u,track:a,elementProps:Cr(r.props,{className:m,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":e==null?void 0:e.source,...(e==null?void 0:e.kind)==="video"&&{"data-lk-orientation":d}})}}var ft,Nt;function Ir(){if(Nt)return ft;Nt=1;var t="Expected a function",r=NaN,e="[object Symbol]",n=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,u=/^0o[0-7]+$/i,f=parseInt,a=typeof Z=="object"&&Z&&Z.Object===Object&&Z,l=typeof self=="object"&&self&&self.Object===Object&&self,d=a||l||Function("return this")(),T=Object.prototype,E=T.toString,m=Math.max,x=Math.min,h=function(){return d.Date.now()};function k(s,p,v){var w,g,O,S,C,N,F=0,St=!1,Y=!1,ct=!0;if(typeof s!="function")throw new TypeError(t);p=c(p)||0,b(v)&&(St=!!v.leading,Y="maxWait"in v,O=Y?m(c(v.maxWait)||0,p):O,ct="trailing"in v?!!v.trailing:ct);function st(L){var $=w,H=g;return w=g=void 0,F=L,S=s.apply(H,$),S}function he(L){return F=L,C=setTimeout(Q,p),St?st(L):S}function de(L){var $=L-N,H=L-F,_t=p-$;return Y?x(_t,O-H):_t}function kt(L){var $=L-N,H=L-F;return N===void 0||$>=p||$<0||Y&&H>=O}function Q(){var L=h();if(kt(L))return xt(L);C=setTimeout(Q,de(L))}function xt(L){return C=void 0,ct&&w?st(L):(w=g=void 0,S)}function ve(){C!==void 0&&clearTimeout(C),F=0,w=N=g=C=void 0}function ye(){return C===void 0?S:xt(h())}function at(){var L=h(),$=kt(L);if(w=arguments,g=this,N=L,$){if(C===void 0)return he(N);if(Y)return C=setTimeout(Q,p),st(N)}return C===void 0&&(C=setTimeout(Q,p)),S}return at.cancel=ve,at.flush=ye,at}function b(s){var p=typeof s;return!!s&&(p=="object"||p=="function")}function A(s){return!!s&&typeof s=="object"}function U(s){return typeof s=="symbol"||A(s)&&E.call(s)==e}function c(s){if(typeof s=="number")return s;if(U(s))return r;if(b(s)){var p=typeof s.valueOf=="function"?s.valueOf():s;s=b(p)?p+"":p}if(typeof s!="string")return s===0?s:+s;s=s.replace(n,"");var v=i.test(s);return v||u.test(s)?f(s.slice(2),v?2:8):o.test(s)?r:+s}return ft=k,ft}var Ar=Ir();const Ut=Mt(Ar);function jr(t){const r=y.useRef(t);r.current=t,y.useEffect(()=>()=>{r.current()},[])}function Rr(t,r=500,e){const n=y.useRef();jr(()=>{n.current&&n.current.cancel()});const o=y.useMemo(()=>{const i=Ut(t,r,e),u=(...f)=>i(...f);return u.cancel=()=>{i.cancel()},u.isPending=()=>!!n.current,u.flush=()=>i.flush(),u},[t,r,e]);return y.useEffect(()=>{n.current=Ut(t,r,e)},[t,r,e]),o}function Nr(t,r,e){const n=(l,d)=>l===d,o=t instanceof Function?t():t,[i,u]=y.useState(o),f=y.useRef(o),a=Rr(u,r,e);return n(f.current,o)||(a(o),f.current=o),[i,a]}function Ur({threshold:t=0,root:r=null,rootMargin:e="0%",freezeOnceVisible:n=!1,initialIsIntersecting:o=!1,onChange:i}={}){var u;const[f,a]=y.useState(null),[l,d]=y.useState(()=>({isIntersecting:o,entry:void 0})),T=y.useRef();T.current=i;const E=((u=l.entry)==null?void 0:u.isIntersecting)&&n;y.useEffect(()=>{if(!f||!("IntersectionObserver"in window)||E)return;const h=new IntersectionObserver(k=>{const b=Array.isArray(h.thresholds)?h.thresholds:[h.thresholds];k.forEach(A=>{const U=A.isIntersecting&&b.some(c=>A.intersectionRatio>=c);d({isIntersecting:U,entry:A}),T.current&&T.current(U,A)})},{threshold:t,root:r,rootMargin:e});return h.observe(f),()=>{h.disconnect()}},[f,JSON.stringify(t),r,e,E,n]);const m=y.useRef(null);y.useEffect(()=>{var h;!f&&(h=l.entry)!=null&&h.target&&!n&&!E&&m.current!==l.entry.target&&(m.current=l.entry.target,d({isIntersecting:o,entry:void 0}))},[f,l.entry,n,E,o]);const x=[a,!!l.isIntersecting,l.entry];return x.ref=x[0],x.isIntersecting=x[1],x.entry=x[2],x}const Mr=y.forwardRef(function({onTrackClick:t,onClick:r,onSubscriptionStatusChanged:e,trackRef:n,manageSubscription:o,...i},u){const f=se(n),a=y.useRef(null);y.useImperativeHandle(u,()=>a.current);const l=Ur({root:a.current}),[d]=Nr(l,3e3);y.useEffect(()=>{o&&f.publication instanceof pt&&(d==null?void 0:d.isIntersecting)===!1&&(l==null?void 0:l.isIntersecting)===!1&&f.publication.setSubscribed(!1)},[d,f,o]),y.useEffect(()=>{o&&f.publication instanceof pt&&(l==null?void 0:l.isIntersecting)===!0&&f.publication.setSubscribed(!0)},[l,f,o]);const{elementProps:T,publication:E,isSubscribed:m}=pe(f,{element:a,props:i});y.useEffect(()=>{e==null||e(!!m)},[m,e]);const x=h=>{r==null||r(h),t==null||t({participant:f==null?void 0:f.participant,track:E})};return y.createElement("video",{ref:a,...T,muted:!0,onClick:x})}),Fr=y.forwardRef(function({trackRef:t,onSubscriptionStatusChanged:r,volume:e,...n},o){const i=se(t),u=y.useRef(null);y.useImperativeHandle(o,()=>u.current);const{elementProps:f,isSubscribed:a,track:l,publication:d}=pe(i,{element:u,props:n});return y.useEffect(()=>{r==null||r(!!a)},[a,r]),y.useEffect(()=>{l===void 0||e===void 0||(l instanceof be?l.setVolume(e):J.warn("Volume can only be set on remote audio tracks."))},[e,l]),y.useEffect(()=>{d===void 0||n.muted===void 0||(d instanceof pt?d.setEnabled(!n.muted):J.warn("Can only call setEnabled on remote track publications."))},[n.muted,d,l]),y.createElement("audio",{ref:u,...f})});function $r({room:t,volume:r,muted:e}){const n=fe([j.Source.Microphone,j.Source.ScreenShareAudio,j.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0,room:t}).filter(o=>!o.participant.isLocal&&o.publication.kind===j.Kind.Audio);return y.createElement("div",{style:{display:"none"}},n.map(o=>y.createElement(Fr,{key:ar(o),trackRef:o,volume:r,muted:e})))}function zr(){const t=fe([j.Source.Camera,j.Source.ScreenShare]);return z.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center",children:t.length>0&&z.jsx("div",{className:"w-full h-full",children:t.map(r=>z.jsx("div",{className:"w-full h-full",children:z.jsx(Mr,{trackRef:r,className:"w-full h-full object-cover",style:{imageRendering:"auto",transform:"translateZ(0)",backfaceVisibility:"hidden"}})},r.participant.identity))})})}function Vn({room:t}){return z.jsx(ae.Provider,{value:t,children:z.jsxs("div",{className:"w-full h-full","data-testid":"livekit-video-container",children:[z.jsx(zr,{}),z.jsx($r,{})]})})}export{Vn as LiveKitVideoPlayer,Vn as default};
