import{r as n,g as z,a as I,j as e,x as _,B as d,L as G,ac as M,a_ as D}from"./index-GnvmivW0.js";import{u as B,F as K,a as f,b,c as j,d as y,t as R}from"./form-CgNvNzQO.js";import{C as W,a as H,b as O}from"./card-Bsqf9o7h.js";import{I as v}from"./input-CDJz7BeV.js";import{A as T,a as V}from"./alert-BCAR44i4.js";import{S as $}from"./separator-Datc7ShZ.js";import{C as q,A as J,E as Q}from"./eye-off-CFCqOyIF.js";import{M as U}from"./mail-Ck7aiNy-.js";import{E as X}from"./eye-MrtS8r4d.js";import"./label-CbaFYhHW.js";function le(){const[c,w]=n.useState(!1),[u,r]=n.useState(""),[m,i]=n.useState(!1),[p,N]=n.useState(!1),{toast:s}=z(),{emailLogin:k,loginWithGoogle:S,loginWithApple:C,isLoading:L}=I();n.useEffect(()=>{(async()=>{try{const a=await fetch("/api/settings/keys");if(a.ok){const o=await a.json();if(o.success&&o.data){const{firebase_api_key:h,firebase_auth_domain:E,firebase_project_id:g}=o.data;h&&g&&(M({apiKey:h,authDomain:E,projectId:g,storageBucket:"",appId:""}),N(!0))}}}catch(a){console.error("Failed to fetch Firebase keys:",a)}})()},[]);const l=B({resolver:R(D),defaultValues:{email:"",password:""}}),F=async()=>{if(!p){s({title:"Please wait",description:"Initializing authentication...",variant:"default"});return}try{i(!0),r(""),await S()}catch(t){let a="Google login failed";t.code==="auth/unauthorized-domain"?a="Domain not authorized for Firebase authentication. Please contact support.":t.code==="auth/popup-blocked"?a="Popup was blocked. Please allow popups and try again.":t.message&&(a=t.message),r(a),s({title:"Login failed",description:a,variant:"destructive"})}finally{i(!1)}},P=async()=>{if(!p){s({title:"Please wait",description:"Initializing authentication...",variant:"default"});return}try{i(!0),r(""),await C()}catch(t){let a="Apple login failed";t.code==="auth/unauthorized-domain"?a="Domain not authorized for Firebase authentication. Please contact support.":t.code==="auth/popup-blocked"?a="Popup was blocked. Please allow popups and try again.":t.message&&(a=t.message),r(a),s({title:"Login failed",description:a,variant:"destructive"})}finally{i(!1)}},x=t=>{t==="Google"?F():t==="Apple"?P():s({title:"Coming Soon",description:`${t} login will be available soon!`,variant:"default"})},A=async t=>{try{i(!0),r(""),await k(t.email,t.password)}catch(a){const o=a instanceof Error?a.message:"Login failed";r(o),s({title:"Login failed",description:o,variant:"destructive"})}finally{i(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-primary/5 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 w-full max-w-lg px-4 sm:px-6 md:px-8",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("div",{className:"space-y-2",children:e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold",children:[e.jsx("span",{className:"text-primary",children:"Shop Live."}),e.jsx("br",{}),e.jsx("span",{className:"text-accent",children:"Stream. Sell. Connect."})]})})}),e.jsxs(W,{className:"shadow-2xl border border-border/50 bg-card/80 backdrop-blur-sm relative",children:[(L||m)&&e.jsxs("div",{className:"absolute inset-0 bg-card/95 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-lg","data-testid":"loading-overlay",children:[e.jsx(_,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-foreground",children:"Signing you in..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we authenticate your account"})]})]}),e.jsx(H,{className:"pb-4",children:e.jsx("div",{className:"text-center mb-4",children:e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Sign in to continue"})})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{type:"button",variant:"outline",className:"w-full !bg-white hover:!bg-gray-50 !text-gray-900 !border-gray-300 dark:!bg-white dark:hover:!bg-gray-100 dark:!text-gray-900",onClick:()=>x("Google"),"data-testid":"button-google-login",children:[e.jsx(q,{className:"h-4 w-4 mr-2 !text-gray-900"}),"Continue with Google"]}),e.jsxs(d,{type:"button",variant:"outline",className:"w-full bg-black hover:bg-gray-900 text-white border-gray-800",onClick:()=>x("Apple"),"data-testid":"button-apple-login",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Continue with Apple"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"my-4"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"px-3 bg-card text-muted-foreground text-sm",children:"or"})})]}),u&&e.jsx(T,{variant:"destructive",className:"mb-4","data-testid":"alert-login-error",children:e.jsx(V,{children:u})}),e.jsx(K,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(A),className:"space-y-4",children:[e.jsx(f,{control:l.control,name:"email",render:({field:t})=>e.jsxs(b,{children:[e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{type:"email",placeholder:"Email Address",className:"pl-10 bg-input border-border text-foreground placeholder:text-muted-foreground","data-testid":"input-email",...t})]})}),e.jsx(y,{})]})}),e.jsx(f,{control:l.control,name:"password",render:({field:t})=>e.jsxs(b,{children:[e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(v,{type:c?"text":"password",placeholder:"Password",className:"bg-input border-border text-foreground placeholder:text-muted-foreground pr-10","data-testid":"input-password",...t}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>w(!c),"data-testid":"button-toggle-password",children:c?e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})})]})}),e.jsx(y,{})]})}),e.jsx(d,{type:"submit",className:"w-full bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90 text-white font-medium py-3 rounded-lg transition-all duration-200",disabled:m,"data-testid":"button-login",children:m?"Please wait...":"Log in"})]})}),e.jsxs("div",{className:"text-center pt-2 space-y-2",children:[e.jsx("button",{onClick:()=>{s({title:"Coming Soon",description:"Password reset will be available soon!",variant:"default"})},className:"text-primary hover:text-primary/80 text-sm font-medium","data-testid":"link-forgot-password",children:"Forgot Password?"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Don't have an account?"," ",e.jsx(G,{href:"/signup",children:e.jsx("button",{className:"text-primary hover:text-primary/80 font-medium","data-testid":"link-signup",children:"Sign up"})})]})]})]})]}),e.jsx("div",{className:"text-center mt-8 text-muted-foreground text-sm",children:e.jsx("p",{children:"Need help? Contact our support team"})})]})]})}export{le as default};
