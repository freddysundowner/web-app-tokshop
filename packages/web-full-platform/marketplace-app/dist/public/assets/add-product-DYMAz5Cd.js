import{u as _,a as $,e as B,j as e,X as D,q as G,p as z}from"./index-DOZKoalF.js";import{u as M,F as R,a as n,b as o,e as i,c as l,d,f as F,t as K}from"./form-BJNwnS3h.js";import{u as P}from"./useQuery-48pQeuS3.js";import{u as Q}from"./useMutation-BBndlB0x.js";import{C as p,a as h,d as u,c as m,b as x}from"./card-C6zn3jP-.js";import{B as y}from"./button-bCrgsaso.js";import{I as v}from"./input-CsVTZWQJ.js";import{T as U}from"./textarea-C334aam0.js";import{S as C,a as w,b as N,c as b,d as c}from"./select-fROaTUpr.js";import{R as O,a as T}from"./radio-group-CSuKdiEr.js";import{I as Y}from"./image-uploader-C--Io-tW.js";import{A as H}from"./arrow-left-BP7H-sSw.js";import{S as J}from"./save-BhnFI72X.js";import"./label-CmdcELDJ.js";import"./index-BdQq_4o_.js";import"./index-DwAU5pHh.js";import"./index-CXm_CZR6.js";import"./index-CxUEmdCc.js";import"./index-AFSU6Owo.js";import"./chevron-down-Bi2HuHPT.js";import"./check-Bj3EYrSG.js";import"./chevron-up-0jCUr4SU.js";import"./index-CYumVO2i.js";import"./circle-D2uhURtr.js";import"./badge-DdltLmN9.js";import"./loader-circle-Bz7fq4IJ.js";import"./image-CyAY67GT.js";import"./upload-DYhQNpyI.js";function Se(){const[,g]=_(),{user:t}=$(),{toast:S}=B(),a=M({resolver:K(z),defaultValues:{name:"",description:"",price:void 0,quantity:void 0,category:"",listingType:"buy_now",weight:"",height:"",width:"",length:"",scale:"oz",shippingProfile:"",images:[],colors:[],sizes:[],featured:!1}}),{data:f,isLoading:I}=P({queryKey:["external-categories",t==null?void 0:t.id],queryFn:async()=>{const s=await fetch(`/api/categories?userId=${t==null?void 0:t.id}&status=active&page=1&limit=100`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch categories: ${s.status}`);return s.json()},enabled:!!(t!=null&&t.id)}),{data:k,isLoading:q}=P({queryKey:["external-shipping-profiles",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id))throw new Error("User ID required");const s=await fetch(`/api/shipping/profiles/${t.id}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch shipping profiles: ${s.status}`);return s.json()},enabled:!!(t!=null&&t.id)}),j=Q({mutationFn:async s=>{const r=await fetch(`/api/products/${t==null?void 0:t.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const A=await r.json();throw new Error(A.message||"Failed to create product")}return r.json()},onSuccess:()=>{G.invalidateQueries({queryKey:["external-products"]}),S({title:"Product Created",description:"Your product has been created successfully."}),g("/inventory")},onError:s=>{S({title:"Failed to Create Product",description:s.message,variant:"destructive"})}}),E=s=>{j.mutate(s)},V=(f==null?void 0:f.categories)||[],L=k||[];return e.jsxs("div",{className:"p-3 sm:p-6 space-y-6","data-testid":"page-add-product",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(y,{variant:"outline",onClick:()=>g("/inventory"),"data-testid":"button-back-to-inventory",className:"w-full sm:w-auto",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"sm:inline",children:"Back to Inventory"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground","data-testid":"text-page-title",children:"Add New Product"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground","data-testid":"text-page-description",children:"Create a new product for your inventory"})]})]}),e.jsx(R,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(E),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Basic Information"}),e.jsx(m,{children:"Essential product details and description"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsx(n,{control:a.control,name:"name",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Product Name *"}),e.jsx(l,{children:e.jsx(v,{placeholder:"Enter product name",...s,"data-testid":"input-product-name"})}),e.jsx(d,{})]})}),e.jsx(n,{control:a.control,name:"description",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Description"}),e.jsx(l,{children:e.jsx(U,{placeholder:"Enter product description",...s,rows:4,"data-testid":"textarea-product-description"})}),e.jsx(d,{})]})})]})]}),e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Pricing & Inventory"}),e.jsx(m,{children:"Set your product price and stock levels"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{control:a.control,name:"price",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Price ($) *"}),e.jsx(l,{children:e.jsx(v,{type:"number",step:"0.01",min:"0",placeholder:"0.00",...s,onChange:r=>s.onChange(r.target.value),"data-testid":"input-product-price"})}),e.jsx(d,{})]})}),e.jsx(n,{control:a.control,name:"quantity",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Quantity *"}),e.jsx(l,{children:e.jsx(v,{type:"number",min:"0",placeholder:"0",...s,onChange:r=>s.onChange(r.target.value),"data-testid":"input-product-quantity"})}),e.jsx(d,{})]})})]})})]}),e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Product Images"}),e.jsx(m,{children:"Upload images of your product (up to 5 images)"})]}),e.jsx(x,{children:e.jsx(n,{control:a.control,name:"images",render:({field:s})=>e.jsxs(o,{children:[e.jsx(l,{children:e.jsx(Y,{value:s.value||[],onChange:s.onChange,maxFiles:5,maxFileSize:5*1024*1024,disabled:j.isPending,allowFileStorage:!1})}),e.jsx(d,{})]})})})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6 lg:sticky lg:top-6 self-start",children:[e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Category & Listing"}),e.jsx(m,{children:"Categorize your product and set listing type"})]}),e.jsx(x,{className:"space-y-4",children:e.jsx(n,{control:a.control,name:"category",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Category"}),e.jsxs(C,{onValueChange:s.onChange,defaultValue:s.value,disabled:I,"data-testid":"select-product-category",children:[e.jsx(l,{children:e.jsx(w,{children:e.jsx(N,{placeholder:"Select category"})})}),e.jsxs(b,{children:[e.jsx(c,{value:"skip",children:"No Category"}),V.map(r=>e.jsx(c,{value:r._id,children:r.name},r._id))]})]}),e.jsx(d,{})]})})})]}),e.jsxs(p,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Shipping"}),e.jsx(m,{children:"Configure shipping preferences for this product"})]}),e.jsxs(x,{children:[e.jsx(n,{control:a.control,name:"shippingProfile",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Shipping Profile"}),e.jsxs(C,{onValueChange:s.onChange,defaultValue:s.value||"",disabled:q,"data-testid":"select-shipping-profile",children:[e.jsx(l,{children:e.jsx(w,{children:e.jsx(N,{placeholder:"Select shipping profile"})})}),e.jsxs(b,{children:[e.jsx(c,{value:"skip",children:"No Shipping Profile"}),L.map(r=>e.jsx(c,{value:r._id,children:r.name},r._id))]})]}),e.jsx(d,{})]})}),e.jsx(n,{control:a.control,name:"listingType",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Listing Type *"}),e.jsxs(C,{onValueChange:s.onChange,defaultValue:s.value,"data-testid":"select-listing-type",children:[e.jsx(l,{children:e.jsx(w,{children:e.jsx(N,{placeholder:"Select listing type"})})}),e.jsxs(b,{children:[e.jsx(c,{value:"buy_now",children:"Buy Now"}),e.jsx(c,{value:"auction",children:"Auction"}),e.jsx(c,{value:"giveaway",children:"Giveaway"})]})]}),e.jsx(F,{children:"Choose how customers can purchase this product"}),e.jsx(d,{})]})}),e.jsx(n,{control:a.control,name:"featured",render:({field:s})=>e.jsxs(o,{className:"space-y-3",children:[e.jsx(i,{children:"Featured Product"}),e.jsx(l,{children:e.jsxs(O,{onValueChange:r=>s.onChange(r==="true"),value:s.value?"true":"false",className:"flex flex-col space-y-1","data-testid":"radio-group-featured",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{value:"false",id:"featured-false","data-testid":"radio-featured-false"}),e.jsx(i,{htmlFor:"featured-false",className:"text-sm font-normal",children:"No"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{value:"true",id:"featured-true","data-testid":"radio-featured-true"}),e.jsx(i,{htmlFor:"featured-true",className:"text-sm font-normal",children:"Yes"})]})]})}),e.jsx(F,{children:"Mark this product as featured to highlight it"}),e.jsx(d,{})]})})]})]})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row items-stretch sm:items-center justify-end gap-3 sm:gap-4 pt-6 border-t",children:[e.jsxs(y,{type:"button",variant:"outline",onClick:()=>g("/inventory"),"data-testid":"button-cancel",className:"w-full sm:w-auto",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs(y,{type:"submit",disabled:j.isPending,"data-testid":"button-save-product",className:"w-full sm:w-auto",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),j.isPending?"Creating...":"Create Product"]})]})]})})]})}export{Se as default};
